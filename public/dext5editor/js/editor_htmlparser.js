(function(){function q(a){var c={};a=a.split(",");for(var d=0;d<a.length;d++)c[a[d]]=!0;return c}var v=50,x=",span,strong,b,",t=/^<([-A-Za-z0-9_]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,y=/^<\/([-A-Za-z0-9_:@.]+)[^>]*>/,A=/([-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,u=/^<([-A-Za-z0-9_:-]+)((?:\s+[a-zA-Z_0-9:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,B=/([-A-Za-z0-9_:-]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,
C=q("colgroup,col"),D=q("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed");q("area,base,basefont,br,col,frame,img,input,isindex,link,meta,param,embed");var E=q("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul,h1,h2,h3,h4,h5,h6,figure,nav,section,article"),z=!1,l="a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var",
w=q(l),F=q("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),G=q("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),H=q("");"undefined"==typeof DEXT5_EDITOR&&(DEXT5_EDITOR={});DEXT5_EDITOR.HTMLParser=function(a,c,d){function h(a,b,f,c){b=b.toLowerCase();if(E[b]){for("table"!=k.last()&&"tbody"!=k.last()||"td"!=b||h("","tr","","");k.last()&&w[k.last()];)g("",k.last());"p"!=k.last()||"table"!=b&&"hr"!=b&&"center"!=b&&"figure"!=b||g("","p")}F[b]&&
k.last()==b&&g("",b);(c=D[b]||!!c)||k.push(b);if(d.start){var e=[];a=t.test(a)?A:B;f.replace(a,function(a,b,f,c,d){f=f?f:c?c:d?d:G[b]?b:"";c="";""!=a&&(a=a.substring(a.indexOf(b)+b.length),a=a.substring(a.indexOf("=")+1),a=a.replace(/^\s+/,""),c=a.substring(0,1),"'"!=c&&'"'!=c&&(c=""));e.push({name:b,value:f,escaped:f.replace(/(^|[^\\])"/g,'$1\\"'),quotationmark:c})});d.start&&d.start(b,e,c)}}function g(a,b){if(b)for(b=b.toLowerCase(),c=k.length-1;0<=c&&k[c]!=b;c--);else var c=0;if(0<=c){for(var f=
k.length-1;f>=c;f--)d.end&&d.end(k[f]);k.length=c}}var b,f,k=[],l=a;for(k.last=function(){return this[this.length-1]};a;){f=!0;if(k.last()&&H[k.last()])a=a.replace(new RegExp("(.*)</"+k.last()+"[^>]*>"),function(a,b){b=b.replace(/\x3c!--(.*?)--\x3e/g,"$1").replace(/<!\[CDATA\[(.*?)]]\x3e/g,"$1");d.chars&&d.chars(b);return""}),g("",k.last());else{var m=a.indexOf("<");b=a.indexOf(">")+1;var p=a.substring(m,b);if(0==a.indexOf("\x3c!--"))b=a.indexOf("--\x3e"),0<=b&&(d.comment&&("style"==k.last()?d.comment(a.substring(4,
b),!0):d.comment(a.substring(4,b))),a=a.substring(b+3),f=!1);else if(0==a.toLowerCase().indexOf("<?xml"))b=a.indexOf("/>"),0<=b&&(a=a.substring(b+2),f=!1);else if(0!=a.indexOf("<")&&"</"+k.last()+">"==p.replace(/ /ig,""))f=a.substring(0,m),a=a.substring(b),a=f+"</"+k.last()+">"+a,f=!0;else if(0==a.indexOf("</")){if(b=a.match(y))a=a.substring(b[0].length),b[0].replace(y,g),f=!1}else if(0==a.indexOf("<"))if(b=a.match(t))a=a.substring(b[0].length),b[0].replace(t,h),f=!1;else if(b=a.match(u))a=a.substring(b[0].length),
b[0].replace(u,h),f=!1;else{if("1"==DEXTTOP.G_CURREDITOR._config.removeIncorrectAttribute&&(b=a.indexOf("<"),p=a.indexOf(">"),0==b&&0<p)){var e=a.substring(0,p+1),r=m=b=0;0<e.indexOf('\ub9d1\uc740=""')?(b=e.indexOf('\ub9d1\uc740=""'),m=5,r=e.split('\ub9d1\uc740=""').length):0<e.indexOf("\ub9d1\uc740=''")&&(b=e.indexOf("\ub9d1\uc740=''"),m=5,r=e.split("\ub9d1\uc740=''").length);if(2==r&&0<b&&(p=a.substring(p+1),r=e.substring(0,b).lastIndexOf(" "),r<b+m))if(a=e.substring(r,b+m),e=e.replace(a,""),a=
e+p,b=a.match(t))a=a.substring(b[0].length),b[0].replace(t,h),f=!1;else if(b=a.match(u))a=a.substring(b[0].length),b[0].replace(u,h),f=!1}m=/^<([-a-zA-Z._]*@[-a-zA-Z._]*)()>/;if(b=a.match(m))a=a.substring(b[0].length),b[0].replace(m,h),f=!1}f&&(b=a.indexOf("<"),f=0>b?a:a.substring(0,b),a=0>b?"":a.substring(b),d.chars&&(k.last()&&w[k.last()]&&"textarea"!=k.last()&&"script"!=k.last()&&0>k.indexOf("pre")&&0>k.indexOf("xmp")&&(b=!1,m=RegExp("\\S\\n","g"),m.test(f)&&(b=!0),m=RegExp("\\n\\S","g"),m.test(f)&&
(b=!0),m=RegExp("\\S\\n\\S","g"),m.test(f)&&(b=!0),b?f=f.replace(/\n/g," "):(m=RegExp("\\n\\n","g"),m.test(f)&&""==f.trim()?f=f.replace(/\n\n/g,""):f==unescape("%20%20")&&(b=new RegExp(unescape("%20"),"g"),f=f.replace(b,"&nbsp;")))),"1"==DEXTTOP.G_CURREDITOR._config.replaceSpace&&c&&(b=new RegExp(unescape("%20%20"),"g"),f=f.replace(b,"&nbsp; ")),d.chars(f)))}if(a==l)throw"Parse Error: "+a;l=a}g()};DEXT5_EDITOR.HTMLParser.HTMLtoXML=function(a,c){var d="",h=DEXTTOP.G_CURREDITOR._config.skipTagInParser;
if(""!=h&&0==z){l=l.replace(/,/g,",,");l=","+l+",";for(var h=h.split(","),g=h.length,b=0;b<g;b++)l=l.replace(","+h[b]+",","");l=l.replace(/,,/g,",");l=l.replace(/^,/g,"");l=l.replace(/,$/g,"");w=q(l);z=!0}DEXT5_EDITOR.HTMLParser(a,c,{start:function(a,b,c){d+="<"+a;for(a=0;a<b.length;a++)d="href"==b[a].name||"src"==b[a].name?d+(" "+b[a].name+"="+b[a].quotationmark+b[a].value+b[a].quotationmark):""!=b[a].quotationmark?d+(" "+b[a].name+"="+b[a].quotationmark+b[a].value+b[a].quotationmark):d+(" "+b[a].name+
'="'+b[a].escaped+'"');d+=(c?"/":"")+">"},end:function(a){C[a]||(d+="</"+a+">")},chars:function(a){d+=a},comment:function(a,b){d="0"==DEXTTOP.G_CURREDITOR._config.removeComment||b?d+("\x3c!--"+a+"--\x3e"):d+""}});return d};DEXT5_EDITOR.HTMLParser.RemoveOfficeTag=function(a,c){if(""==a||void 0==a)return"";a=DEXT5_EDITOR.HTMLParser.RemoveOfficeTag2(a);a=DEXTTOP.DEXT5.util.replaceOneSpaceToNbsp(a);c&&(a=a.replace(/(<span[^>]*>)\s<\/span>/gi,"$1&nbsp;</span>"),a=a.replace(/>\s+</g,"><"));return a};DEXT5_EDITOR.HTMLParser.RemoveOfficeTag2=
function(a){var c=RegExp("<o:p></o:p>","gi");a=a.replace(c,"");c=RegExp("<o:p>\\s+</o:p>","gi");a=a.replace(c,"");c=RegExp("<o:p>&nbsp;</o:p>","gi");a=a.replace(c,"&nbsp;");c=RegExp("<o:p ([^>]+)></o:p>","gi");a=a.replace(c,"");c=RegExp("<o:p ([^>]+)>\\s+</o:p>","gi");a=a.replace(c,"");c=RegExp("<o:p ([^>]+)>&nbsp;</o:p>","gi");a=a.replace(c,"&nbsp;");c=RegExp("<w:sdt[^>]*>","gi");a=a.replace(c,"");c=RegExp("</w:sdt>","gi");a=a.replace(c,"");"1"==DEXTTOP.G_CURREDITOR._config.removeLangAttribute&&
(c=RegExp('(<[^>]+)(lang=["]?en-us["])([^>]*>)',"gi"),c.test(a)&&(a=a.replace(c,"$1$3")));"1"==DEXTTOP.G_CURREDITOR._config.removeMsoClass&&(c=RegExp('(<[^>]+\\sclass=[\\"]?)(mso\\w+)([\\"]?[^>]*>)',"gi"),c.test(a)&&(a=a.replace(c,"$1$3")));c=RegExp("(<[^>]+)(mso-ascii-font-family\\s*:\\s*(&quot;)?[a-z\u3131-\ud7a3 ]*(&quot;)?;?)([^>]*>)","gi");c.test(a)&&(a=a.replace(c,"$1$5"));c=RegExp("<v:shapetype ([^>]+)>[\\s\\S]*?</v:shapetype>","gi");a=a.replace(c,"");c=RegExp("<v:shape [^>]+>[\\s\\S]*?(<img [^>]+>)*?</v:shape>",
"gi");a=a.replace(c,"$1");c=RegExp("<v:shape ([^>]+)>[\\s\\S]*?</v:shape>","gi");a=a.replace(c,"");return a=a.replace(/<\!\[if ppt\]>/gi,"")};DEXT5_EDITOR.HTMLParser.CheckNeedNestedHTML=function(a,c,d){var h=!1;"undefined"!=typeof c&&""!=c&&(v=c);c=[];var g="p";"undefined"!=typeof d&&""!=d&&(g=d);d=g.split(",");var b=d.length;if(1<b)for(g=0;g<b;g++){var f=a.getElementsByTagName(d[g]);try{c=c.concat(Array.prototype.slice.call(f,0))}catch(k){for(var l=f.length,m=0;m<l;m++)c.push(f[m])}}else c=a.getElementsByTagName(g);
g=0;for(a=c.length;g<a;g++)if(DEXT5_EDITOR.HTMLParser.GetChildrenCount(c[g],!0)>v){h=!0;break}return h};DEXT5_EDITOR.HTMLParser.GetChildrenCount=function(a,c){var d=0;a.childNodes&&(d=DEXT5_EDITOR.HTMLParser.getChildrenCountForNestedHTML(a,c)-a.childNodes.length);return d};DEXT5_EDITOR.HTMLParser.getChildrenCountForNestedHTML=function(a,c){for(var d=0,h=a.childNodes.length,g=0;g<h;g++)1==a.childNodes[g].nodeType&&-1<x.indexOf(","+a.childNodes[g].tagName.toLowerCase()+",")&&(c&&(d+=DEXT5_EDITOR.HTMLParser.getChildrenCountForNestedHTML(a.childNodes[g],
c)),d++);return d};DEXT5_EDITOR.HTMLParser.CleanNestedHtml=function(a,c,d,h,g){function b(a){for(var b="",c=Array(a.childNodes.length),d=0;d<c.length;d++){c[d]=[];c[d].push(a.childNodes[d]);f(a.childNodes[d],c[d]);var g=d,e=c[d],k=[],h=0;a:for(;h<e.length;h++){for(var m=0;m<k.length;m++)if(k[m]==e[h])continue a;k[k.length]=e[h]}c[g]=k;b+=c[d].join("")}return b}function f(a,b){for(var c=a.childNodes,d=0;d<c.length;d++)b.push(c[d]),c[d].hasChildNodes()&&1==c[d].nodeType&&"table"!=c[d].nodeName.toLowerCase()&&
f(c[d],b);for(var c=0,e;c<b.length;c++){d=b[c];if(1==d.nodeType)if("table"==d.nodeName.toLowerCase())d=d.outerHTML;else{e=d.nodeName;if(-1==(" "+m.join(" ").toUpperCase()+" ").search(" "+e.toUpperCase()+" ")){b.splice(c,1);c--;continue}e=d;for(var g="",h=0,l=void 0;h<e.attributes.length;h++)l=e.attributes[h],1==l.specified&&("style"==l.name?(l=k(e),""!=l&&(g+=' style="'+k(e)+'"')):""!=l.value&&(g+=" "+l.name+'="'+l.value+'"'));e=g;d="<"+d.nodeName.toLowerCase()+e+">"}else 3==d.nodeType&&(d=d.nodeValue.replace(/\n/g,
""),d=d.replace(/(\s)\s+/g,"$1"),d=d.replace(/</g,"&lt;"),d=d.replace(/>/g,"&gt;"));b[c]=d}return b}function k(a){for(var b="",c=0,d=l.length,e;c<d;c++)a.currentStyle?e=a.currentStyle[l[c]]:window.getComputedStyle&&(e=document.defaultView.getComputedStyle(a,null).getPropertyValue(l[c])),b+=l[c]+":"+e+";";return b}var l=[],m="p div a abbr acronym applet basefont bdo big br button cite code del dfn em font i iframe img input ins kbd label map object q s samp script select small strike sub sup textarea tt u var".split(" ");
if(""!=a._config.cleanNestedTagOptions.removeTag){for(var p=a._config.cleanNestedTagOptions.removeTag.split(","),e=p.length-1;0<=e;e--){var r=m.indexOf(p[e]);-1<r&&m.splice(r,1)}x=","+a._config.cleanNestedTagOptions.removeTag+","}0<a._config.cleanNestedTagOptions.allowStyle.length&&(l=a._config.cleanNestedTagOptions.allowStyle);"undefined"!=typeof d&&""!=d&&(v=parseInt(d));e="p";"undefined"!=typeof h&&""!=h&&(e=h);h=a._DOC;"undefined"!=typeof g&&""!=g&&(h=g);var n=[];g=e.split(",");d=g.length;if(1<
d)for(e=0;e<d;e++){p=h.getElementsByTagName(g[e]);try{n=n.concat(Array.prototype.slice.call(p,0))}catch(q){for(var r=p.length,t=0;t<r;t++)n.push(p[t])}}else n=h.getElementsByTagName(e);g=!1;e=0;for(d=n.length;e<d;e++)if(DEXT5_EDITOR.HTMLParser.GetChildrenCount(n[e],!0)>v){g=!0;break}if(g)if(h&&h!=a._DOC)try{e=0;d=n.length;for(var u;e<d;e++)DEXT5_EDITOR.HTMLParser.GetChildrenCount(n[e],!0)>v&&(u=b(n[e]),u=DEXT5_EDITOR.HTMLParser.HTMLtoXML(u),n[e].innerHTML=u);return h.innerHTML}catch(w){}else showProcessingBackground(),
setTimeout(function(){a._BODY.contentEditable=!1;try{if("2"==c)DEXTTOP.DEXT5.DextCommands("select_all",a.ID),DEXTTOP.DEXT5.DextCommands("remove_css",a.ID),DEXTTOP.DEXT5.DextCommands("remove_format",a.ID),a._FRAMEWIN.setFocusToBody(),setTimeout(function(){a._FRAMEWIN.doSetCaretPosition(a._BODY.firstChild,0)},20);else for(var d=0,e=n.length,f;d<e;d++)DEXT5_EDITOR.HTMLParser.GetChildrenCount(n[d],!0)>v&&(f=b(n[d]),f=DEXT5_EDITOR.HTMLParser.HTMLtoXML(f),n[d].innerHTML=f)}catch(g){}hideProcessingBackground();
a._BODY.contentEditable=!0},G_Progress_LoadTime)};DEXT5_EDITOR.HTMLParser.makeMap=function(a){return q(a)}})();
