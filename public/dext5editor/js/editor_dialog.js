var G_IMAGE_ALLOW_EXT=["jpg","jpeg","png","gif","bmp"],G_dragDropFileObj=null,LayerFrame=DEXTTOP.DEXTDOC.getElementById("dext_frame_"+DEXTTOP.G_CURREDITOR.ID),LayerWin=LayerFrame.contentWindow,LayerDoc=LayerWin.document;DEXTTOP.DEXT5.util.overrideFn(window);
try{HTMLCanvasElement&&!HTMLCanvasElement.prototype.toBlob&&Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(a,c,b){var d=this;setTimeout(function(){for(var e=atob(d.toDataURL(c,b).split(",")[1]),f=e.length,g=new Uint8Array(f),h=0;h<f;h++)g[h]=e.charCodeAt(h);a(new Blob([g],{type:c||"image/png"}))})}})}catch(e$$4){}
function dext_setting(){var a=document.getElementById("grid_color").style.backgroundColor,c=document.getElementById("grid_color_name").innerHTML,b=document.getElementById("lang").value,d=document.getElementById("grid_spans").value,e=document.getElementsByName("grid_form")[0].checked?"line":"dot",f=document.getElementById("page_title").value,g=document.getElementById("encoding").value,h=document.getElementById("doctype").value,l=document.getElementById("xhtml").checked?document.getElementById("xhtml").value:
"",k=document.getElementById("auto_list").value,m=document.getElementById("check_auto_save").checked,p=document.getElementById("input_auto_save").value,p="none"!=document.getElementById("div_auto_save").style.display?m?""!=p&&"0"!=p?"1,"+document.getElementById("input_auto_save").value:"2":"2":"0",m=LayerWin._dext_editor._config.accessibilityValidationItems;if(""==m||-1<m.indexOf("setting_title"))if(m=LayerWin._dext_editor._config.accessibility,"1"==m)""==f&&alert(LayerWin.dext5_lang.msg.alert_page_title_access1);
else if("2"==m&&""==f){alert(LayerWin.dext5_lang.msg.alert_page_title_access2);document.getElementById("page_title").focus();return}var m=document.getElementById("check_ruler").checked,n=document.getElementById("ruler_px").value;if(""!=n&&"0"!=n)"2"==LayerWin._dext_editor._config.ruler.mode?LayerWin._dext_editor.isInitBodyAutoFit=!0:(n=n.split(","),n=n.sort(function(a,b){return a-b}),n=n.join(","));else if(m){alert(LayerWin.dext5_lang.msg.alert_ruler_position);document.getElementById("ruler_px").focus();
return}var m=m?"1":"0",q="",r="",v="",q="1"==LayerWin._dext_editor._config.personalSettingUseFontFamilyKeyin?""==document.getElementById("personal_font_family").value?document.getElementById("personal_font_family").value:LayerWin.getRealNameThroughDisplayName(document.getElementById("font_family_keyin").value):document.getElementById("personal_font_family").value;"1"==LayerWin._dext_editor._config.personalSettingUseFontSizeKeyin?""==document.getElementById("personal_font_size").value?r=document.getElementById("personal_font_size").value:
(r=document.getElementById("font_size_keyin").value,r=isNaN(r)?r:r+"pt"):r=document.getElementById("personal_font_size").value;var v="1"==LayerWin._dext_editor._config.personalSettingUseLineHeightKeyin?""==document.getElementById("personal_line_height").value?document.getElementById("personal_line_height").value:document.getElementById("line_height_keyin").value:document.getElementById("personal_line_height").value,A=document.getElementById("word_break").value,z=document.getElementById("word_wrap").value,
y=document.getElementById("check_apply_word_break_for_table").checked,B=document.getElementById("personal_paste_to_image").value,C=document.getElementById("personal_paste_to_image_popupMode").value;dext_json={grid_color:a,grid_color_nm:c,grid_spans:d,grid_form:e,page_title:f,encoding:g,lang:b,doctype:h,xhtml:l,auto_save:p,ruler:m,ruler_px:n,auto_list:k,personal_font_family:q,personal_font_size:r,personal_line_height:v,word_break_type:A,word_wrap_type:z,word_break_for_all_table:y,personal_paste_to_image:B,
personal_paste_to_image_popupMode:C};LayerWin.event_dext_setting(dext_json,window.frameElement.parentNode.parentNode)}function dext_horizontal_line(a,c){var b;if(!a){b=document.getElementById("width_1").value;var d=document.getElementById("height").value,e=document.getElementById("align").value,f=document.getElementById("hr_color").style.borderTopColor;b={width:b,height:d,align:e,color:f}}LayerWin.event_dext_horizontal_line(b,a,c,window.frameElement.parentNode.parentNode)}
function loading_image_show(a){var c=document.getElementById("dext_loading"),b="";0==a?(b="none",document.body.style.cursor="default"):document.body.style.cursor="wait";c&&(c.style.display=b);"1"==LayerWin._dext_editor._config.uploadUseHTML5&&a&&c&&c.childNodes&&(c.childNodes[1].nodeValue=" Uploading... ")}function web_url_remove_char(a){a=DEXTTOP.DEXT5.util.trim(a);a=a.replace(/(\r\n|\r|\n)/gm,"");a=a.replace(/&#13;/g,"");a=a.replace(/&#10;/g,"");return a=a.replace(/&#32;/g,"")}
function dext_upload_image(){var a=LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo;if(DEXTTOP.DEXT5.browser.HTML5Supported&&"0"!=LayerWin.DEXTTOP.G_CURREDITOR._config.uploadUseHTML5)if(document.getElementsByName("InputFlag")[0].checked)if(G_dragDropFileObj){a.uploadData={isImageFileUpload:!0,isUploaded:!0,isLastIdx:!1,uploadedFileCnt:0,totalFileCount:0,fileIdx:0,nowFileName:"",errorFile:[]};var c=1==LayerWin.DEXTTOP.G_CURREDITOR._config.insertMultiImage;if(c)for(var b=0;b<G_dragDropFileObj.length;b++)0>
a.validData.errorFileIdx.indexOf(b)&&(a.uploadData.totalFileCount+=1);else a.uploadData.totalFileCount=1;loading_image_show(!0);var d=setInterval(function(){try{if(a.uploadData.isUploaded)if(0<a.uploadData.totalFileCount&&setProgressBar(),a.uploadData.isLastIdx){loading_image_show(!1);clearInterval(d);if(0<a.uploadData.errorFile.length){var b=!0,b="function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError?DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a.uploadData.errorFile[0].message,
response:a.uploadData.errorFile[0].response,arrFileError:a.uploadData.errorFile}):DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a.uploadData.errorFile[0].message,response:a.uploadData.errorFile[0].response,arrFileError:a.uploadData.errorFile});if(0==b){a.uploadData={};return}if("1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&1<a.uploadData.totalFileCount){var f=LayerWin.dext5_lang.msg.multi_file_upload_error.replace("{0}",a.uploadData.errorFile.length);
alert(f)}}else a.isMulti&&LayerWin.hideDialog(window.frameElement.parentNode.parentNode);a.uploadData={}}else a.uploadData.isUploaded=!1,a.uploadData.isLastIdx=a.uploadData.fileIdx==G_dragDropFileObj.length-1,-1<a.validData.errorFileIdx.indexOf(a.uploadData.fileIdx)?a.uploadData.isUploaded=!0:(a.uploadData.nowFileName=G_dragDropFileObj[a.uploadData.fileIdx].name,dext_upload_image2(G_dragDropFileObj[a.uploadData.fileIdx]),c&&1!=a.uploadData.totalFileCount||(a.uploadData.isLastIdx=!0)),a.uploadData.isLastIdx||
a.uploadData.fileIdx++}catch(g){clearInterval(d)}},100)}else alert(LayerWin.dext5_lang.msg.alert_no_file);else G_dragDropFileObj=null,dext_upload_image2(null);else 0<a.validData.errorFileIdx.length?alert(LayerWin.dext5_lang.msg.alert_no_file):dext_upload_image2(null)}
function setProgressBar(){var a=LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo,a=DEXTTOP.DEXT5.util.parseIntOr0(a.uploadData.uploadedFileCnt/a.uploadData.totalFileCount*100),c=document.getElementById("dext_loading");c&&c.childNodes&&(c.childNodes[1].nodeValue=" Uploading... "+a+"%")}
function dext_upload_image2(a){var c=LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo,b=document.dext_upload_form,d;d=""==document.getElementById(file_field_id).value?G_dragDropFileObj&&a?{value:a.name,id:document.getElementById(file_field_id).id}:{value:""}:G_dragDropFileObj&&(c.isMulti||a)?{value:a.name,id:document.getElementById(file_field_id).id}:document.getElementById(file_field_id);var e=document.getElementById("img_web_url"),f=document.getElementById("link_url"),g=LayerWin.getElementsByClass("EdiTor_Popup_contents",
document),h=/^\s\s*$/;if(!h.exec(f.value)&&""!=f.value){var h=new RegExp(/^(http|ftp|https|news)/),l=h.test(f.value);if("http://"==f.value)f.value="";else if(l&&!DEXTTOP.DEXT5.util.checkUrl(f.value)){alert(LayerWin.dext5_lang.msg.alert_url);g[0].className="EdiTor_Popup_contents none";g[1].className="EdiTor_Popup_contents view";LayerWin.lastFocus(f);return}}if(document.getElementsByName("InputFlag")[0].checked)if(f=d.value,0<f.lastIndexOf(".")){e=LayerWin._dext_editor._config.accessibilityValidationItems;
if(""==e||-1<e.indexOf("img_alt"))if(e=LayerWin._dext_editor._config.accessibility,c.isMulti&&(document.getElementById("img_alt").value=a.name),g=document.getElementById("img_alt").value,"1"==e)""==g&&alert(LayerWin.dext5_lang.msg.alert_image_alt_access1);else if("2"==e&&""==g){alert(LayerWin.dext5_lang.msg.alert_image_alt_access2);document.getElementById("img_alt").focus();return}e=f.substring(f.lastIndexOf(".")+1).toLowerCase();if("base64"==LayerWin._dext_editor._config.uploadMethod){var c="1"==
LayerWin._dext_editor._config.uploadUseHTML5?a:d.files[0],k=new FileReader;k.onload=function(){var a=k.result,b=new Image;b.onload=function(){a+="?"+b.width+"^"+b.height;event_dext_image_upload_completed(a)};b.src=a;k=void 0};k.readAsDataURL(c)}else a=LayerWin._dext_editor._config.image_convert_width,g=LayerWin._dext_editor._config.image_convert_height,"1"==LayerWin._dext_editor._config.imageAutoConvert&&(g=a="0"),"0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=
DEXTTOP.DEXT5.util.makeEncryptParamFinal(e),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFolderNameRule),
document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(a),document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(g),document.getElementById("originalfilename")&&
(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin.getUploadOriginalFileName(f,LayerWin._dext_editor._config)))):(document.getElementById("savefileext").value=e,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=
LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=a,document.getElementById("image_convert_height").value=g,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=LayerWin.getUploadOriginalFileName(f,LayerWin._dext_editor._config))),
"1"==LayerWin._dext_editor._config.uploadUseHTML5?(b=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&b.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),b.setItem("document_domain",document.getElementById("document_domain").value),b.setItem("proxy_url",document.getElementById("proxy_url").value),b.setItem("uploadtype",document.getElementById("uploadtype").value),b.setItem("savefilename",document.getElementById("savefilename").value),b.setItem("savefileext",
document.getElementById("savefileext").value),b.setItem("serverdomain",document.getElementById("serverdomain").value),b.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),b.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),b.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),b.setItem("image_convert_format",document.getElementById("image_convert_format").value),b.setItem("image_convert_width",document.getElementById("image_convert_width").value),
b.setItem("image_convert_height",document.getElementById("image_convert_height").value),b.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&b.setItem("originalfilename",document.getElementById("originalfilename").value),addParamHashTable(b),b.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),uploadAjaxOnprogressStart({uploadType:"image",handlerUrl:LayerWin._dext_editor._config.post_url,
fileID:d.id,fileObj:G_dragDropFileObj[c.uploadData.fileIdx],formData:b},event_dext_image_upload_completed)):(b.action=document.getElementById("upload_url").value,b.submit())}else""==f?alert(LayerWin.dext5_lang.msg.alert_no_file):alert(LayerWin.dext5_lang.msg.alert_exec);else f=e.value,h=new RegExp(/^(http|ftp|https|news)/),l=h.test(f),h=/^\s\s*$/,""==f||h.exec(f)||l&&!DEXTTOP.DEXT5.util.checkUrl(f)?(alert(LayerWin.dext5_lang.msg.alert_url),e.focus()):event_dext_image_upload_completed(f)}
function event_dext_image_link(){var a=document.getElementById("img_web_url").value,c=document.getElementById("img_width").value,b=document.getElementById("img_height").value,d=document.getElementById("img_alt").value,e=document.getElementById("img_title").value,f=document.getElementById("img_v_space").value,g=document.getElementById("img_h_space").value,h=document.getElementById("img_align"),h=h.options[h.selectedIndex].value,l="";document.getElementById("img_border")&&(l=document.getElementById("img_border").value);
var k=document.getElementById("link_url").value,m=document.getElementById("link_title").value,p=document.getElementById("link_target").value;LayerWin.event_dext_image_upload("","","","0",a,0,0,d,"",{srcURL:a,width:c,height:b,title:e,alt:d,vspace:f,hspace:g,align:h,border:l,linkurl:k,linktitle:m,linktarget:p},window.frameElement.parentNode.parentNode)}
function event_dext_image_upload_completed(a,c){a&&(a=a.replace(/<.*?script.*\/?>/g,""));var b=!1;document.getElementsByName("InputFlag")[1]&&(b=document.getElementsByName("InputFlag")[1].checked);"base64"!=LayerWin._dext_editor._config.uploadMethod&&a&&(a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""),a=web_url_remove_char(a));if("CCODE_001"==LayerWin._dext_editor._config.custom_code){var d=a,e=document.getElementById("img_alt").value,f=document.getElementById("img_title").value,
g=document.getElementById("img_id").value,h=document.getElementById("img_class").value,l=document.getElementById("img_v_space").value,k=document.getElementById("img_h_space").value,m=document.getElementById("img_align"),m=m.options[m.selectedIndex].value,p="";document.getElementById("img_border")&&(p=document.getElementById("img_border").value);var n=document.getElementById("img_width").value,q=document.getElementById("img_height").value,r=document.getElementById("link_url").value,v=document.getElementById("link_title").value,
A=document.getElementById("link_target").value,z="",y="",B="",C="";document.getElementById("line_style")&&(z=document.getElementById("line_style").style.borderTop,"none"!=z&&(y=document.getElementById("line_kind").value,B=document.getElementById("line_color").style.borderTopColor,C=document.getElementById("line_thickness").value));b={srcURL:a,width:n,height:q,title:f,id:g,className:h,alt:e,vspace:l,hspace:k,align:m,border:p,linkurl:r,linktitle:v,linktarget:A,continueInsert:D,input_url_checked:b,borderStyle:z,
borderKind:y,borderColor:B,borderThickness:C}}else{n=document.getElementById("img_width").value;q=document.getElementById("img_height").value;if(!b){var t=0,u=0,x=document.getElementById("img_width_unit"),E=!1;x&&"%"==x.value&&(E=!0);if(null!=a&&void 0!=a){try{f="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,a):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a),null!=f&&void 0!=
f&&(a=f)}catch(I){}l=[];"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&(l=a.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<l.length&&(a=l[0]));var w=a.split("?");2==w.length?(a=w[0],w=w[1].split("^"),1==w.length?a+="?"+w[0]:2==w.length?(t=w[0],u=w[1]):3==w.length&&(t=w[0],u=w[1],a+="?"+w[2])):(""==n||E||(t=n),""==q||E||(u=q));"1"==LayerWin._dext_editor._config.imageSizeToServer&&(0<t&&(n=t),0<u&&(q=u));if(elemModify&&"img"==elemModify.tagName.toLowerCase()){"1"!=
LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status"))?(elemModify.src=LayerWin._dext_editor._config.webPath.image+"dialog/image_xbox.jpg",b=a.indexOf("HTTP Error"),l=a.indexOf("HTTP Status"),-1<b?elemModify.setAttribute("alt",a.substring(b,errorIdx+16).replace(/"/g,"'")):-1<l&&elemModify.setAttribute("alt",a.substring(l,errorIdx+15).replace(/"/g,"'"))):"[FAIL]"==a.substring(0,6)?(elemModify.src=LayerWin._dext_editor._config.webPath.image+"dialog/image_xbox.jpg",
elemModify.setAttribute("alt",a.substring(6,a.length).replace(/"/g,"'"))):elemModify.src=a;"function"==typeof G_UploadCompleteCallBackFn&&G_UploadCompleteCallBackFn();try{LayerWin.contentChangeEventWrapper()}catch(L){}return}w=!1;document.getElementById("original_size")&&(w=document.getElementById("original_size").checked);w||(w=LayerWin.getWidthForAutoBodyFit(LayerWin._dext_editor,"img"),D=!1,E&&(t=DEXTTOP.DEXT5.util.getEditSpacePx(DEXTTOP.G_CURREDITOR),t=Math.round(t*n/100),"2"==LayerWin._dext_editor._config.image_auto_fit&&
t>w&&(D=!0)),"1"==LayerWin._dext_editor._config.imageAutoConvert?(w=LayerWin.DEXTTOP.DEXT5.util.parseIntOr0(LayerWin._dext_editor._config.image_convert_width),D=LayerWin.DEXTTOP.DEXT5.util.parseIntOr0(LayerWin._dext_editor._config.image_convert_height),f=x=!1,t=LayerWin.DEXTTOP.DEXT5.util.parseIntOr0(t),u=LayerWin.DEXTTOP.DEXT5.util.parseIntOr0(u),0!=w&&0==D?t>=w&&(x=!0):0==w&&0!=D?u>=D&&(f=!0):(g=1*w/t,h=1*D/u,g<h?1>g&&(x=!0):1>h&&(f=!0)),x?(x=w/t,t=w,u=DEXTTOP.DEXT5.util.parseIntOr0(x*u),n=t,q=
u):f&&(x=D/u,u=D,n=t=DEXTTOP.DEXT5.util.parseIntOr0(x*t),q=u)):"1"==LayerWin._dext_editor._config.image_auto_fit&&t>w||D?(x=w/t,t=w,u*=x,E?(w=n,n=t*n/100>=t?100:w):n>t&&(n=t,q=u)):"2"==LayerWin._dext_editor._config.image_auto_fit&&(t>w||u>LayerWin._dext_editor._defaultHeight)&&(n=LayerWin._dext_editor._defaultHeight,q=n/w,D=u/t,D>q?u>n?(q=n,n=Math.round(t*q/u)):(n=t,q=u):D<q?t>w?(n=w,q=Math.round(u*n/t)):(n=t,q=u):(n=t,q=u)))}0==n.length&&0<t&&!E&&(n=parseInt(t),q=parseInt(u),E=u="",w=!1,document.getElementById("original_size")&&
(w=document.getElementById("original_size").checked),!w&&0>LayerWin._dext_editor._config.imgDefaultWidth.indexOf("%")&&(u=LayerWin._dext_editor._config.imgDefaultWidth,E=LayerWin._dext_editor._config.imgDefaultHeight),""!=u?DEXTTOP.DEXT5.util.parseIntOr0(n)>DEXTTOP.DEXT5.util.parseIntOr0(u)&&(n=DEXTTOP.DEXT5.util.parseIntOr0(q,10)*DEXTTOP.DEXT5.util.parseIntOr0(u,10)/DEXTTOP.DEXT5.util.parseIntOr0(n,10),q=isNaN(n)?q:Math.round(n),n=DEXTTOP.DEXT5.util.parseIntOr0(u)):""!=E&&DEXTTOP.DEXT5.util.parseIntOr0(q)>
DEXTTOP.DEXT5.util.parseIntOr0(E)&&(q=DEXTTOP.DEXT5.util.parseIntOr0(n,10)*DEXTTOP.DEXT5.util.parseIntOr0(E,10)/DEXTTOP.DEXT5.util.parseIntOr0(q,10),n=isNaN(q)?n:Math.round(q),q=DEXTTOP.DEXT5.util.parseIntOr0(E)));if("[FAIL]"==a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status")))try{if(e=LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo.uploadData,e.isImageFileUpload&&LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo.isMulti)e.errorFile.push({fileName:e.nowFileName,
message:a,response:c.response});else if(d="function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError?DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a,response:c.response}):DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a,response:c.response}),0==d)return}catch(M){}if("1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status"))){LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo.uploadData.isUploaded=
!0;LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo.isMulti||(b=!0,"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&(b=confirm(LayerWin.dext5_lang.msg.uploadFailed)),b&&(b=a.indexOf("HTTP Error"),l=a.indexOf("HTTP Status"),-1<b?alert(a.substring(b,b+16)):-1<l&&alert(a.substring(l,l+15))));return}if(!b&&"[FAIL]"==a.substring(0,6)&&"base64"!=LayerWin._dext_editor._config.uploadMethod){LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo.uploadData.isUploaded=!0;LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo.isMulti||
(b=!0,"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&(b=confirm(LayerWin.dext5_lang.msg.uploadFailed)),b&&alert(a));return}}var u=document.getElementById("savefilename").value,t=E="",w="0",d=a,e=document.getElementById("img_alt").value,f=document.getElementById("img_title").value,J=h=g="";try{g=document.getElementById("img_id").value,h=document.getElementById("img_class").value,J=document.getElementById("img_figure").checked}catch(N){}var k=document.getElementById("img_margin_left").value,
G=document.getElementById("img_margin_right").value,F=document.getElementById("img_margin_top").value,H=document.getElementById("img_margin_bottom").value,k="-"==k?"":k,G="-"==G?"":G,F="-"==F?"":F,H="-"==H?"":H,m=document.getElementById("img_align"),m=m.options[m.selectedIndex].value,p="";document.getElementById("img_border")&&(p=document.getElementById("img_border").value);var D=!1;document.getElementById("continue_insert")&&(D=document.getElementById("continue_insert").checked);r=document.getElementById("link_url").value;
if(null!=r&&void 0!=r&&""!=DEXTTOP.DEXT5.util.trim(r)){try{v="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertHyperlink?DEXTTOP.G_CURREDITOR._config.event.beforeInsertHyperlink(DEXTTOP.G_CURREDITOR.ID,r):DEXTTOP.DEXTWIN.dext_editor_before_insert_hyperlink_event(DEXTTOP.G_CURREDITOR.ID,r)}catch(O){}null!=v&&void 0!=v&&(r=document.getElementById("link_url").value=v)}v=document.getElementById("link_title").value;A=document.getElementById("link_target").value;C=B=y=z="";document.getElementById("line_style")&&
(z=document.getElementById("line_style").style.borderTopStyle,"none"!=z&&(y=document.getElementById("line_kind").value,B=document.getElementById("line_color").style.borderTopColor,C=document.getElementById("line_thickness").value));var P=!1;document.getElementById("image_spacing")&&(P=document.getElementById("image_spacing").checked);var Q="px",R="px",x=document.getElementById("img_width_unit"),K=document.getElementById("img_height_unit");x&&""!=x.value&&(Q=x.value);K&&""!=K.value&&(R=K.value);b=
{srcURL:a,width:n,height:q,title:f,id:g,className:h,figure:J,alt:e,margin_left:k,margin_right:G,margin_top:F,margin_bottom:H,align:m,border:p,linkurl:r,linktitle:v,linktarget:A,continueInsert:D,input_url_checked:b,img_attr_info_arr:l,input_url_checked:b,borderStyle:z,borderKind:y,borderColor:B,borderThickness:C,imageSpacing:P,widthUnit:Q,heightUnit:R};x=""+("<img style='width:"+n+"px; height:"+q+"px;");0<F.length&&!isNaN(F)&&(x+=" margin-top:"+F+"px;");0<G.length&&!isNaN(G)&&(x+=" margin-right:"+
G+"px;");0<H.length&&!isNaN(H)&&(x+=" margin-bottom:"+H+"px;");0<k.length&&!isNaN(k)&&(x+=" margin-left:"+k+"px;");x=x+" ' "+(" src='"+d+"'");x+=" alt='"+e+"'";0<m.length&&(x+=" align='"+m+"'");0<p.length&&!isNaN(p)&&(x+=" border='"+p+"'");x+=" />"}LayerWin.event_dext_image_upload(u,E,t,w,d,n,q,e,x,b,window.frameElement.parentNode.parentNode)}
function dext_upload_flash(){if(1==document.getElementById("cb_tag_insert").checked){var a=document.getElementById("ta_flash_tag").value,c=document.createElement("div");c.innerHTML=a;c=c.getElementsByTagName("EMBED")[0];if(null==c)alert(LayerWin.dext5_lang.flash.invalid_tag);else{var a=null,b=c.getAttribute("scale")?c.getAttribute("scale"):"",d=c.getAttribute("allowScriptAccess")?c.getAttribute("allowScriptAccess"):"",e=c.getAttribute("quality")?c.getAttribute("quality"):"",f=c.getAttribute("align")?
c.getAttribute("align"):"",g,h,l,k;g=null==c.getAttribute("menu")||void 0==c.getAttribute("menu")?!0:0==c.getAttribute("menu")||"false"==c.getAttribute("menu")?!1:!0;h=null==c.getAttribute("play")||void 0==c.getAttribute("play")?!0:0==c.getAttribute("play")||"false"==c.getAttribute("play")?!1:!0;l=null==c.getAttribute("loop")||void 0==c.getAttribute("loop")?!0:0==c.getAttribute("loop")||"false"==c.getAttribute("loop")?!1:!0;null==c.getAttribute("allowFullScreen")||void 0==c.getAttribute("allowFullScreen")?
k=!0:0==c.getAttribute("allowFullScreen")||"false"==c.getAttribute("allowFullScreen")?_allowFullScreenu=!1:k=!0;var m=c.getAttribute("flashvars")?c.getAttribute("flashvars"):"";"embed"==c.tagName.toLowerCase()&&(a={type:"flash",src:c.src,width:0==LayerWin.parseIntOr0(c.style.width)?LayerWin.parseIntOr0(c.width):LayerWin.parseIntOr0(c.style.width),height:0==LayerWin.parseIntOr0(c.style.height)?LayerWin.parseIntOr0(c.height):LayerWin.parseIntOr0(c.style.height),hspace:LayerWin.parseIntOr0(c.getAttribute("hspace")),
vspace:LayerWin.parseIntOr0(c.getAttribute("vspace")),scale:b,allowScriptAccess:d,quality:e,align:f,menu:g,play:h,loop:l,allowFullScreen:k,flashvars:m},k=LayerWin.getLinkMediaType(a.src),0<k.length&&(a.type=k,a.type2="flash"));LayerWin.event_dext_media_upload("","","","","","",a,window.frameElement.parentNode.parentNode)}}else if(c=document.dext_upload_form,a="",a="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id),b=document.getElementById("web_url"),
document.getElementsByName("InputFlag")[0].checked)if(k=a.value,0<k.lastIndexOf(".")){b=k.substring(k.lastIndexOf(".")+1).toLowerCase();d=!1;e=LayerWin._dext_editor._config.allowFlashFileType;f=e.toString()+LayerWin.dext5_lang.msg.alert_exec_tail;for(g=0;g<e.length;g++)if(b==e[g]){d=!0;break}1==d?("0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(b),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*
Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(""==LayerWin._dext_editor._config.saveFileFolderNameRule?
LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin.getUploadOriginalFileName(k,LayerWin._dext_editor._config)))):(document.getElementById("savefileext").value=b,document.getElementById("savefilename").value=
Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL,document.getElementById("savafoldernamerule").value=""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule,
document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=LayerWin.getUploadOriginalFileName(k,LayerWin._dext_editor._config))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(k=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&k.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),k.setItem("document_domain",
document.getElementById("document_domain").value),k.setItem("proxy_url",document.getElementById("proxy_url").value),k.setItem("uploadtype",document.getElementById("uploadtype").value),k.setItem("savefilename",document.getElementById("savefilename").value),k.setItem("savefileext",document.getElementById("savefileext").value),k.setItem("serverdomain",document.getElementById("serverdomain").value),k.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),k.setItem("savafoldernamerule",
document.getElementById("savafoldernamerule").value),k.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),k.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&k.setItem("originalfilename",document.getElementById("originalfilename").value),k.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(k),uploadAjaxOnprogressStart({uploadType:"flash",
handlerUrl:LayerWin._dext_editor._config.post_url,fileID:a.name,fileObj:G_dragDropFileObj,formData:k},event_dext_flash_upload_completed)):(c.action=document.getElementById("upload_url").value,c.submit())):alert(f)}else""==k?alert(LayerWin.dext5_lang.msg.alert_no_file):alert(LayerWin.dext5_lang.msg.alert_exec);else k=b.value,a=(new RegExp(/^(http|ftp|https|news)/)).test(k),c=/^\s\s*$/,""==k||c.exec(k)||a&&!DEXTTOP.DEXT5.util.checkUrl(k)?(alert(LayerWin.dext5_lang.msg.alert_url),b.focus()):event_dext_flash_upload_completed(k)}
function dext_upload_flash_byFlash(){if(1==document.getElementById("cb_tag_insert").checked){var a=document.getElementById("ta_flash_tag").value;DEXTTOP.event_dext_media_upload("","","","","",a)}else{a=document.dext_upload_form;document.getElementById(file_field_id);var c=document.getElementById("web_url"),c=document.getElementsByName("InputFlag")[0].checked?"dext.swf":c.value;if(0<c.lastIndexOf(".")){for(var b=c.substring(c.lastIndexOf(".")+1).toLowerCase(),d=!1,e=LayerWin._dext_editor._config.allowFlashFileType,
f=e.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,g=0;g<e.length;g++)if(b==e[g]){d=!0;break}1==d?document.getElementsByName("InputFlag")[0].checked?(document.getElementById("savefileext").value=b,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:
LayerWin._dext_editor._config.toSaveFilePathURL,document.getElementById("savafoldernamerule").value=""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,a.action=document.getElementById("upload_url").value,document.getElementById("dext_flash_uploader").dext_upload()):event_dext_flash_upload_completed(c):
alert(f)}else alert(LayerWin.dext5_lang.msg.alert_exec)}}
function event_dext_flash_upload_completed(a,c){a&&(a=a.replace(/<.*?script.*\/?>/g,""),a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""),a=web_url_remove_char(a));var b=[];if(document.getElementsByName("InputFlag")[0].checked){if(null!=a&&void 0!=a){try{var d;d="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,a):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a);
null!=d&&void 0!=d&&(a=d)}catch(e){}b=[];"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&(b=a.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<b.length&&(a=b[0]));d=a.split("?");2==d.length&&-1<d[1].indexOf("^")&&(a=d[0],d=d[1].split("^"),1==d.length?a+="?"+d[0]:3==d.length&&(a+="?"+d[2]))}loading_image_show(!1);if("[FAIL]"==a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status")))try{if(0==("function"==
typeof DEXTTOP.G_CURREDITOR._config.event.onError?DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"flashUpload",message:a,response:c.response}):DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"flashUpload",message:a,response:c.response})))return}catch(f){}if("1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status"))){b=!0;"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&(b=confirm(LayerWin.dext5_lang.msg.uploadFailed));
b&&(b=a.indexOf("HTTP Error"),d=a.indexOf("HTTP Status"),-1<b?alert(a.substring(b,b+16)):-1<d&&alert(a.substring(d,d+15)));return}if("[FAIL]"==a.substring(0,6)){b=!0;"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&(b=confirm(LayerWin.dext5_lang.msg.uploadFailed));b&&alert(a);return}if(elemModify){elemData.src=a;"function"==typeof G_UploadCompleteCallBackFn&&(G_UploadCompleteCallBackFn(),LayerWin.hideDialog(window.frameElement.parentNode.parentNode));return}}d=document.getElementById("savefilename").value;
var g=document.getElementById("flash_width").value,h=document.getElementById("flash_height").value,l=document.getElementById("flash_margin_left").value,k=document.getElementById("flash_margin_right").value,m=document.getElementById("flash_margin_top").value,p=document.getElementById("flash_margin_bottom").value,n=document.getElementById("flash_scale").value,q=document.getElementById("flash_allowScriptAccess").value,r=document.getElementById("flash_quality").value,v=document.getElementById("flash_menu").checked,
A=document.getElementById("flash_play").checked,z=document.getElementById("flash_loop").checked,y=document.getElementById("flash_allowFullScreen").checked,B=document.getElementById("flash_width_unit"),C=document.getElementById("flash_height_unit"),B=0==LayerWin.parseIntOr0(g)?"":g+B.value,C=0==LayerWin.parseIntOr0(h)?"":h+C.value;LayerWin.insertElementsSrc(DEXTTOP.G_CURREDITOR,a);b={type:"flash",src:a,width:B,height:C,margin_left:l,margin_right:k,margin_top:m,margin_bottom:p,scale:n,allowScriptAccess:q,
quality:r,img_attr_info_arr:b,menu:v,play:A,loop:z,allowFullScreen:y};g=""+("<embed style='width:"+g+"px; height:"+h+"px; ");""!=l&&(g+="margin-left:"+l+"; ");""!=k&&(g+="margin-right:"+k+"; ");""!=m&&(g+="margin-top:"+m+"; ");""!=p&&(g+="margin-bottom:"+p+"; ");g=g+"'"+("src='"+a+"'");""!=n&&(g+="scale='"+n+"'");""!=q&&(g+="allowScriptAccess='"+q+"'");""!=r&&(g+="quality='"+r+"'");0==v&&(g+="menu='false'");0==A&&(g+="play='false'");0==z&&(g+="loop='false'");0==y&&(g+="allowFullScreen='false'");g+=
'wmode="transparent"';g+=" pluginspage='http://www.macromedia.com/go/getflashplayer' type='application/x-shockwave-flash' />";LayerWin.event_dext_media_upload(d,"","","",a,g,b,window.frameElement.parentNode.parentNode)}
function dext_upload_media(){var a=document.dext_upload_form,c="",c="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id),b,d=document.getElementById("web_url");if(document.getElementsByName("InputFlag")[0].checked)if(b=c.value,0<b.lastIndexOf(".")){for(var d=b.substring(b.lastIndexOf(".")+1).toLowerCase(),e=!1,f=LayerWin._dext_editor._config.allowMediaFileType,g=f.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,h=f.length,
l=0;l<h;l++)if(d==f[l]){e=!0;break}1==e?("0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(d),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(""==
LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule),
document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config)))):(document.getElementById("savefileext").value=d,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=""==LayerWin._dext_editor._config.toSaveFilePathURL?
LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL,document.getElementById("savafoldernamerule").value=""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=LayerWin.getUploadOriginalFileName(b,
LayerWin._dext_editor._config))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(b=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&b.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),b.setItem("document_domain",document.getElementById("document_domain").value),b.setItem("proxy_url",document.getElementById("proxy_url").value),b.setItem("uploadtype",document.getElementById("uploadtype").value),b.setItem("savefilename",
document.getElementById("savefilename").value),b.setItem("savefileext",document.getElementById("savefileext").value),b.setItem("serverdomain",document.getElementById("serverdomain").value),b.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),b.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),b.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),b.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&
b.setItem("originalfilename",document.getElementById("originalfilename").value),b.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(b),uploadAjaxOnprogressStart({uploadType:"media",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:c.name,fileObj:G_dragDropFileObj,formData:b},event_dext_media_upload_completed)):(a.action=document.getElementById("upload_url").value,a.submit())):alert(g)}else""==b?alert(LayerWin.dext5_lang.msg.alert_no_file):
alert(LayerWin.dext5_lang.msg.alert_exec);else b=d.value,c=new RegExp(/(http|https|mms):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-]*[\w@?^=%&amp;\/~+#-])?/),a=(new RegExp(/^(http|https|mms)/)).test(b),e=/^\s\s*$/,""==b||e.exec(b)||a&&!c.test(b)?(alert(LayerWin.dext5_lang.msg.alert_url),d.focus()):event_dext_media_upload_completed(b)}
function event_dext_flash_flash_upload_completed(a,c,b){LayerWin.event_dext_media_upload(a,"","","0",c,b,{type:"flash",src:c,width:300,height:300,hspace:"",vspace:"",scale:"",allowScriptAccess:"",quality:"",align:"",menu:"",play:"",loop:"",allowFullScreen:""},window.frameElement.parentNode.parentNode)}
function event_dext_flash_media_upload_completed(a,c,b){LayerWin.event_dext_media_upload(a,"","","0",c,b,{type:"media",src:c,width:300,height:300,autoStart:!1,playCount:!1,showTracker:!1,showStatusBar:!1,showControls:!1,showAudioControls:!1,showDisplay:!1,showPositionControls:!1},window.frameElement.parentNode.parentNode)}
function event_dext_media_upload_completed(a,c){null!=a&&void 0!=a&&(a=a.replace(/<.*?script.*\/?>/g,""),a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""),a=web_url_remove_char(a));e=[];if(document.getElementsByName("InputFlag")[0].checked){if(null!=a&&void 0!=a){try{var b;b="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,a):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,
a);null!=b&&void 0!=b&&(a=b)}catch(d){}var e=[];"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&(e=a.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<e.length&&(a=e[0]));b=a.split("?");2==b.length&&-1<b[1].indexOf("^")&&(a=b[0],b=b[1].split("^"),1==b.length?a+="?"+b[0]:3==b.length&&(a+="?"+b[2]))}loading_image_show(!1);if("[FAIL]"==a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status")))try{if(0==
("function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError?DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"mediaUpload",message:a,response:c.response}):DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"mediaUpload",message:a,response:c.response})))return}catch(f){}if("1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status"))){e=!0;"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&
(e=confirm(LayerWin.dext5_lang.msg.uploadFailed));e&&(e=a.indexOf("HTTP Error"),b=a.indexOf("HTTP Status"),-1<e?alert(a.substring(e,e+16)):-1<b&&alert(a.substring(b,b+15)));return}if("[FAIL]"==a.substring(0,6)){e=!0;"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&(e=confirm(LayerWin.dext5_lang.msg.uploadFailed));e&&alert(a);return}if(elemModify){elemData.src=a;"function"==typeof G_UploadCompleteCallBackFn&&(G_UploadCompleteCallBackFn(),LayerWin.hideDialog(window.frameElement.parentNode.parentNode));
return}}b=document.getElementById("savefilename").value;var g=document.getElementById("media_width").value,h=document.getElementById("media_height").value,l=document.getElementById("media_width_unit"),k=document.getElementById("media_height_unit"),l=0==LayerWin.parseIntOr0(g)?"":g+l.value,k=0==LayerWin.parseIntOr0(h)?"":h+k.value;LayerWin.insertElementsSrc(DEXTTOP.G_CURREDITOR,a);e={type:"media",src:a,width:l,height:k,autoStart:document.getElementById("cb_autostart").checked,playCount:document.getElementById("cb_loop").checked,
showTracker:document.getElementById("cb_tracker").checked,showStatusBar:document.getElementById("cb_status").checked,showControls:document.getElementById("cb_controls").checked,showAudioControls:document.getElementById("cb_volumn").checked,showDisplay:document.getElementById("cb_display").checked,showPositionControls:document.getElementById("cb_position").checked,img_attr_info_arr:e};k="";g=""+("<embed style='width:"+g+"px; height:"+h+"px;' ")+" type=application/x-mplayer2 ";g+=" pluginspage='http://www.microsoft.com/windows/windowsmedia/download/' ";
g+=" src='"+a+"'";k=1==document.getElementById("cb_autostart").checked?"1":"0";g+=" AutoStart='"+k+"'";k=1==document.getElementById("cb_loop").checked?"1":"0";g+=" loop='"+k+"'";k=1==document.getElementById("cb_tracker").checked?"1":"0";g+=" ShowTracker='"+k+"'";k=1==document.getElementById("cb_status").checked?"1":"0";g+=" ShowStatusBar='"+k+"'";k=1==document.getElementById("cb_controls").checked?"1":"0";g+=" ShowControls='"+k+"'";k=1==document.getElementById("cb_volumn").checked?"1":"0";g+=" ShowAudioControls='"+
k+"'";k=1==document.getElementById("cb_display").checked?"1":"0";g+=" ShowDisplay='"+k+"'";k=1==document.getElementById("cb_position").checked?"1":"0";g+=" ShowPositionControls='"+k+"'";g+=" />";LayerWin.event_dext_media_upload(b,"","","0",a,g,e,window.frameElement.parentNode.parentNode)}
function dext_detail_table_upload_image(){var a=document.getElementById("tab_value").value,c=LayerWin._dext_editor._config.accessibilityValidationItems;if(""==c||-1<c.indexOf("table_caption")||-1<c.indexOf("table_summary")||-1<c.indexOf("table_scope")){var b=LayerWin._dext_editor._config.accessibility,d=document.getElementById("table_caption").value,e=document.getElementById("table_summary").value,f="N";1==document.getElementById("scope").checked&&(f="Y");var g="N";1==document.getElementById("t_scope").checked&&
(g="Y");var h=document.getElementById("title_cell").value;if("1"==b)"3"!=a&&"4"!=a?((""==c||-1<c.indexOf("table_caption"))&&""==d&&alert(LayerWin.dext5_lang.msg.alert_table_caption_access1),(""==c||-1<c.indexOf("table_summary"))&&""==e&&alert(LayerWin.dext5_lang.msg.alert_table_summary_access1),(""==c||-1<c.indexOf("table_scope"))&&"1"!=h&&"N"==f&&alert(LayerWin.dext5_lang.msg.alert_scope_access1)):"3"==a&&(""==c||-1<c.indexOf("table_scope"))&&"N"==g&&alert(LayerWin.dext5_lang.msg.alert_scope_access1);
else if("2"==b)if("3"!=a&&"4"!=a){if((""==c||-1<c.indexOf("table_caption"))&&""==d){alert(LayerWin.dext5_lang.msg.alert_table_caption_access2);document.getElementById("table_caption").focus();return}if((""==c||-1<c.indexOf("table_summary"))&&""==e){alert(LayerWin.dext5_lang.msg.alert_table_summary_access2);document.getElementById("table_summary").focus();return}if((""==c||-1<c.indexOf("table_scope"))&&"1"!=h&&"N"==f){alert(LayerWin.dext5_lang.msg.alert_scope_access2);document.getElementById("scope").focus();
return}}else if("3"==a&&(""==c||-1<c.indexOf("table_scope"))&&"N"==g){alert(LayerWin.dext5_lang.msg.alert_scope_access2);document.getElementById("t_scope").focus();return}}b=document.dext_upload_form;c="";c="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id);d="";c&&(d=c.value);e=d.lastIndexOf(".");if("3"!=a&&"4"!=a&&0<e){for(var a=d.substring(d.lastIndexOf(".")+1).toLowerCase(),e=!1,f=LayerWin._dext_editor._config.allowImageFileType,
g=f.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,h=f.length,l=0;l<h;l++)if(a==f[l]){e=!0;break}1==e?("0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(a),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),
document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_format),
document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_width),document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_height),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin.getUploadOriginalFileName(d,LayerWin._dext_editor._config)))):(document.getElementById("savefileext").value=
a,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=
LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,document.getElementById("image_convert_height").value=LayerWin._dext_editor._config.image_convert_height,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=LayerWin.getUploadOriginalFileName(d,LayerWin._dext_editor._config))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(a=
new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&a.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),a.setItem("document_domain",document.getElementById("document_domain").value),a.setItem("proxy_url",document.getElementById("proxy_url").value),a.setItem("uploadtype",document.getElementById("uploadtype").value),a.setItem("savefilename",document.getElementById("savefilename").value),a.setItem("savefileext",document.getElementById("savefileext").value),
a.setItem("serverdomain",document.getElementById("serverdomain").value),a.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),a.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),a.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),a.setItem("image_convert_format",document.getElementById("image_convert_format").value),a.setItem("image_convert_width",document.getElementById("image_convert_width").value),a.setItem("image_convert_height",
document.getElementById("image_convert_height").value),a.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&a.setItem("originalfilename",document.getElementById("originalfilename").value),a.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(a),uploadAjaxOnprogressStart({uploadType:"table_bg_image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:c.name,
fileObj:G_dragDropFileObj,formData:a},event_dext_detail_table_completed)):(b.action=document.getElementById("upload_url").value,b.submit())):alert(g)}else""==d||"3"==a||"4"==a?event_dext_detail_table_completed(document.getElementById("image_url_value").value):alert(LayerWin.dext5_lang.msg.alert_exec)}
function event_dext_detail_table_completed(a,c){null!=a&&void 0!=a&&(a=a.replace(/<.*?script.*\/?>/g,""),a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""),a=web_url_remove_char(a));var b=[];if(LayerWin.G_dext5plugIn&&"3,3,0,26"<=LayerWin.DEXTTOP.G_CURREDITOR._config.plugin_version)a=a.replace(/\s/g,"%20"),a=a.replace(/\'/g,"%27"),a=a.replace(/\(/g,"%28"),a=a.replace(/\)/g,"%29");else if(null!=a&&void 0!=a){try{if(0<a.toString().length){var d;d="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?
DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,a):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a);null!=d&&void 0!=d&&(a=d)}}catch(e){}b=[];"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&(b=a.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<b.length&&(a=b[0]));d=a.split("?");2==d.length&&(a=d[0],d=d[1].split("^"),1==d.length?a+="?"+d[0]:3==d.length&&(a+="?"+d[2]))}loading_image_show(!1);if("[FAIL]"==a.substring(0,
6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status")))try{if(0==("function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError?DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a,response:c.response}):DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a,response:c.response})))return}catch(f){}d=document.getElementById("tab_value").value;var g=document.getElementById("width_line").value,
h=document.getElementById("height_line").value,l=document.getElementById("width").value,k="px";document.getElementById("width_type")&&""!=document.getElementById("width_type").value&&(k=document.getElementById("width_type").value);var m=document.getElementById("height").value,p="";1==document.getElementById("table_edge_reduce").checked?p="Y":0==document.getElementById("table_edge_reduce").checked&&(p="N");var n=document.getElementById("range").value,q=document.getElementById("topcell1"),r=document.getElementById("topcell2"),
v=document.getElementById("bottomcell1");document.getElementById("bottomcell2");var A={outsideTop:"",outsideLeft:"",outsideRight:"",outsideBottom:"",insideRow:"",insideCol:""};A.outsideTop=q.style.borderTop;A.outsideLeft=q.style.borderLeft;A.outsideRight=r?r.style.borderRight:q.style.borderRight;A.outsideBottom=v?v.style.borderBottom:q.style.borderBottom;v&&(A.insideRow=v.style.borderTop);r&&(A.insideCol=q.style.borderRight);var q=document.getElementById("cell_gap").value,r=document.getElementById("cell_inside_margin").value,
v=document.getElementById("table_caption").value,z=document.getElementById("table_summary").value,y=document.getElementById("add").value,B=document.getElementById("repeat").value,C=document.getElementById("horizontal").value,t=document.getElementById("vertical").value,u=document.getElementById("background_color").style.backgroundColor,x="N";1==document.getElementById("scope").checked&&(x="Y");var E=document.getElementById("title_cell").value,I=document.getElementById("t_width_line").value,w=document.getElementById("t_height_line").value,
L=document.getElementById("t_width").value,M=document.getElementById("t_height").value,J="N";1==document.getElementById("t_scope").checked&&(J="Y");var N=document.getElementById("templet").value,G=LayerWin.parseIntOr0(document.getElementById("margin_left").value),F=document.getElementById("class_name").value,H=document.getElementById("table_id").value;"none"==document.getElementById("class_name").style.display&&(F=null);var D=!1;document.getElementById("input_cell_include")&&document.getElementById("input_cell_include").checked&&
(D=!0);var O=document.getElementById("custom_templet").value;LayerWin.event_dext_detail_table_insert(d,g,h,l,m,p,n,A,q,r,v,z,a,y,B,C,t,u,x,E,I,w,L,M,J,N,G,window.frameElement.parentNode.parentNode,F,H,D,O,gXmlData,b,k)}
function dext_table_property_upload_image(){var a=LayerWin._dext_editor._config.accessibilityValidationItems;if(""==a||-1<a.indexOf("table_caption")||-1<a.indexOf("table_summary")||-1<a.indexOf("table_scope")){var c=LayerWin._dext_editor._config.accessibility,b=document.getElementById("table_caption").value,d=document.getElementById("table_summary").value,e="N";1==document.getElementById("scope").checked&&(e="Y");var f=document.getElementById("title_cell").value;if("1"==c)(""==a||-1<a.indexOf("table_caption"))&&
""==b&&alert(LayerWin.dext5_lang.msg.alert_table_caption_access1),(""==a||-1<a.indexOf("table_summary"))&&""==d&&alert(LayerWin.dext5_lang.msg.alert_table_summary_access1),(""==a||-1<a.indexOf("table_scope"))&&"1"!=f&&"N"==e&&alert(LayerWin.dext5_lang.msg.alert_scope_access1);else if("2"==c){if((""==a||-1<a.indexOf("table_caption"))&&""==b){alert(LayerWin.dext5_lang.msg.alert_table_caption_access2);document.getElementById("table_caption").focus();return}if((""==a||-1<a.indexOf("table_summary"))&&
""==d){alert(LayerWin.dext5_lang.msg.alert_table_summary_access2);document.getElementById("table_summary").focus();return}if((""==a||-1<a.indexOf("table_scope"))&&"1"!=f&&"N"==e){alert(LayerWin.dext5_lang.msg.alert_scope_access2);document.getElementById("scope").focus();return}}}c=document.dext_upload_form;a="";a="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id);b="";a&&(b=a.value);if(0<b.lastIndexOf(".")){for(var d=b.substring(b.lastIndexOf(".")+
1).toLowerCase(),e=!1,f=LayerWin._dext_editor._config.allowImageFileType,g=f.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,h=f.length,l=0;l<h;l++)if(d==f[l]){e=!0;break}1==e?("0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(d),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=
DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=
DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_width),document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_height),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin.getUploadOriginalFileName(b,
LayerWin._dext_editor._config)))):(document.getElementById("savefileext").value=d,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=
LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,document.getElementById("image_convert_height").value=LayerWin._dext_editor._config.image_convert_height,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config))),
loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(c=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&c.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),c.setItem("document_domain",document.getElementById("document_domain").value),c.setItem("proxy_url",document.getElementById("proxy_url").value),c.setItem("uploadtype",document.getElementById("uploadtype").value),c.setItem("savefilename",document.getElementById("savefilename").value),
c.setItem("savefileext",document.getElementById("savefileext").value),c.setItem("serverdomain",document.getElementById("serverdomain").value),c.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),c.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),c.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),c.setItem("image_convert_format",document.getElementById("image_convert_format").value),c.setItem("image_convert_width",document.getElementById("image_convert_width").value),
c.setItem("image_convert_height",document.getElementById("image_convert_height").value),c.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&c.setItem("originalfilename",document.getElementById("originalfilename").value),c.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(c),uploadAjaxOnprogressStart({uploadType:"p_table_bg_image",handlerUrl:LayerWin._dext_editor._config.post_url,
fileID:a.name,fileObj:G_dragDropFileObj,formData:c},event_dext_table_property_completed)):(c.action=document.getElementById("upload_url").value,c.submit())):alert(g)}else""==b?(event_dext_table_property_completed(document.getElementById("image_url_value").value),null!=DEXTTOP.G_CURREDITOR.dext_dragresize&&DEXTTOP.G_CURREDITOR.dext_dragresize.G_ResizeHandlerActivatedFlag&&(DEXTTOP.G_CURREDITOR.dext_dragresize.G_ResizeHandlerActivatedFlag=!1,DEXTTOP.G_CURREDITOR.dext_dragresize.setResizeHandle(null,
!0))):alert(LayerWin.dext5_lang.msg.alert_exec)}
function event_dext_table_property_completed(a,c){null!=a&&void 0!=a&&(a=a.replace(/<.*?script.*\/?>/g,""),a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""),a=web_url_remove_char(a));var b=[];if(LayerWin.G_dext5plugIn&&"3,3,0,26"<=LayerWin.DEXTTOP.G_CURREDITOR._config.plugin_version)a=a.replace(/\s/g,"%20"),a=a.replace(/\'/g,"%27"),a=a.replace(/\(/g,"%28"),a=a.replace(/\)/g,"%29");else if(_init_image_url!=a&&null!=a&&void 0!=a){try{var d;d="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?
DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,a):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a);null!=d&&void 0!=d&&(a=d)}catch(e){}b=[];"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&(b=a.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<b.length&&(a=b[0]));d=a.split("?");2==d.length&&(a=d[0],d=d[1].split("^"),1==d.length?a+="?"+d[0]:3==d.length&&(a+="?"+d[2]));"[FAIL]"==a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&
(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status"))||LayerWin.insertImageSrc(DEXTTOP.G_CURREDITOR,a)}loading_image_show(!1);if("[FAIL]"==a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status")))try{if(0==("function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError?DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a,response:c.response}):DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,
{type:"imageUpload",message:a,response:c.response})))return}catch(f){}d=document.getElementById("width").value;var g="px";document.getElementById("width_type")&&""!=document.getElementById("width_type").value&&(g=document.getElementById("width_type").value);var h=document.getElementById("height").value,l="";1==document.getElementById("table_edge_reduce").checked?l="Y":0==document.getElementById("table_edge_reduce").checked&&(l="N");var k=document.getElementById("range").value,m=LayerWin.parseIntOr0(document.getElementById("margin_left").value),
p=document.getElementById("topcell1"),n=document.getElementById("topcell2"),q=document.getElementById("bottomcell1");document.getElementById("bottomcell2");var r={outsideTop:"",outsideLeft:"",outsideRight:"",outsideBottom:"",insideRow:"",insideCol:""};r.outsideTop=p.style.borderTop;r.outsideLeft=p.style.borderLeft;r.outsideRight=n?n.style.borderRight:p.style.borderRight;r.outsideBottom=q?q.style.borderBottom:p.style.borderBottom;q&&(r.insideRow=q.style.borderTop);n&&(r.insideCol=p.style.borderRight);
var p=document.getElementById("cell_gap").value,n=document.getElementById("cell_inside_margin").value,q=document.getElementById("table_caption").value,v=document.getElementById("table_summary").value,A=document.getElementById("prev_background_remove").value,z=document.getElementById("add").value,y=document.getElementById("repeat").value,B=document.getElementById("horizontal").value,C=document.getElementById("vertical").value,t=document.getElementById("background_color").style.backgroundColor,u="N";
1==document.getElementById("scope").checked&&(u="Y");var x=document.getElementById("title_cell").value,E=document.getElementById("table_id").value,I=document.getElementById("class_name").value;"none"==document.getElementById("class_name").style.display&&(I=null);var w=!1;document.getElementById("input_cell_include")&&document.getElementById("input_cell_include").checked&&(w=!0);LayerWin.event_dext_table_property(d,h,l,k,r,p,n,q,v,A,a,z,y,B,C,t,u,x,m,window.frameElement.parentNode.parentNode,I,E,w,
b,g,{cellPaddingMode:window.G_CELLPADDINGMODE})}
function dext_cell_property_upload_image(){var a=LayerWin._dext_editor._config.accessibility,c="";if("Y"==document.getElementById("title_cell").value||"N"==document.getElementById("title_cell").value)c=document.getElementById("title_cell").value;var b="";if("row"==document.getElementById("scope").value||"col"==document.getElementById("scope").value)b="row";if("1"==a)"Y"==c&&""==b&&alert(LayerWin.dext5_lang.msg.alert_scope_access1);else if("2"==a&&"Y"==c&&""==b){alert(LayerWin.dext5_lang.msg.alert_scope_access2);
document.getElementById("scope").focus();return}c=document.dext_upload_form;a="";a="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id);b="";a&&(b=a.value);if(0<b.lastIndexOf(".")){for(var d=b.substring(b.lastIndexOf(".")+1).toLowerCase(),e=!1,f=LayerWin._dext_editor._config.allowImageFileType,g=f.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,h=f.length,l=0;l<h;l++)if(d==f[l]){e=!0;break}1==e?("0"!=LayerWin._dext_editor._config.security.encryptParam?
(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(d),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=
DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_width),
document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_height),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config)))):(document.getElementById("savefileext").value=d,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=
LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,
document.getElementById("image_convert_height").value=LayerWin._dext_editor._config.image_convert_height,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(c=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&c.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),
c.setItem("document_domain",document.getElementById("document_domain").value),c.setItem("proxy_url",document.getElementById("proxy_url").value),c.setItem("uploadtype",document.getElementById("uploadtype").value),c.setItem("savefilename",document.getElementById("savefilename").value),c.setItem("savefileext",document.getElementById("savefileext").value),c.setItem("serverdomain",document.getElementById("serverdomain").value),c.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),c.setItem("savafoldernamerule",
document.getElementById("savafoldernamerule").value),c.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),c.setItem("image_convert_format",document.getElementById("image_convert_format").value),c.setItem("image_convert_width",document.getElementById("image_convert_width").value),c.setItem("image_convert_height",document.getElementById("image_convert_height").value),c.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&c.setItem("originalfilename",
document.getElementById("originalfilename").value),c.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(c),uploadAjaxOnprogressStart({uploadType:"cell_bg_image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:a.name,fileObj:G_dragDropFileObj,formData:c},event_dext_cell_property_completed)):(c.action=document.getElementById("upload_url").value,c.submit())):alert(g)}else""==b?event_dext_cell_property_completed(document.getElementById("image_url_value").value):
alert(LayerWin.dext5_lang.msg.alert_exec)}
function event_dext_cell_property_completed(a,c){null!=a&&void 0!=a&&(a=a.replace(/<.*?script.*\/?>/g,""),a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""),a=web_url_remove_char(a));var b=[];if(LayerWin.G_dext5plugIn&&"3,3,0,26"<=LayerWin.DEXTTOP.G_CURREDITOR._config.plugin_version)a=a.replace(/\s/g,"%20"),a=a.replace(/\'/g,"%27"),a=a.replace(/\(/g,"%28"),a=a.replace(/\)/g,"%29");else if(_init_image_url!=a){try{var d;d="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,
a):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a);null!=d&&void 0!=d&&(a=d)}catch(e){}null!=a&&void 0!=a&&(b=[],"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&(b=a.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<b.length&&(a=b[0])),d=a.split("?"),2==d.length&&(a=d[0],d=d[1].split("^"),1==d.length?a+="?"+d[0]:3==d.length&&(a+="?"+d[2])),"[FAIL]"==a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||
-1<a.indexOf("HTTP Status"))||LayerWin.insertImageSrc(DEXTTOP.G_CURREDITOR,a))}loading_image_show(!1);if("[FAIL]"==a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status")))try{if(0==("function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError?DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a,response:c.response}):DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,
{type:"imageUpload",message:a,response:c.response})))return}catch(f){}d=document.getElementById("horizontal_align").value;var g=document.getElementById("vertical_align").value,h=document.getElementById("not_apply_class_name"),h=h?h.checked:!1,l=document.getElementById("not_apply_cell_id").checked,k="",k=document.getElementById("title_cell").value,m="",m=document.getElementById("scope").value,p="",p=document.getElementById("nowrap").value,n=document.getElementById("topcell1"),q=document.getElementById("topcell2"),
r=document.getElementById("bottomcell1");document.getElementById("bottomcell2");var v={outsideTop:"",outsideLeft:"",outsideRight:"",outsideBottom:"",insideRow:"",insideCol:""};v.outsideTop=n.style.borderTop;v.outsideLeft=n.style.borderLeft;v.outsideRight=q?q.style.borderRight:n.style.borderRight;v.outsideBottom=r?r.style.borderBottom:n.style.borderBottom;r&&(v.insideRow=r.style.borderTop);q&&(v.insideCol=n.style.borderRight);var n=document.getElementById("prev_background_remove").value,q=document.getElementById("add").value,
r=document.getElementById("repeat").value,A=document.getElementById("horizontal").value,z=document.getElementById("vertical").value,y=document.getElementById("background_color").style.backgroundColor;document.getElementById("tab_value");var B=document.getElementById("class_name").value,C=document.getElementById("cell_id").value;"notapplicable"==q&&(q=null);"notapplicable"==r&&(r=null);"notapplicable"==d&&(d=null);"notapplicable"==g&&(g=null);if("none"==document.getElementById("class_name").style.display||
"notapplicable"==B||h)B=null;"notapplicable"==k&&(k=null);"notapplicable"==m&&(m=null);"notapplicable"==p&&(p=null);l&&(C=null);var l=h="",t=document.getElementById("cell_width"),u=document.getElementById("cell_height");t&&u&&(t=t.value,u=u.value,""!=t&&G_preWidth!=t&&(h=t),""!=u&&G_preHeight!=u&&(l=u));LayerWin.event_dext_cell_property(d,g,k,m,p,v,n,a,q,r,A,z,y,window.frameElement.parentNode.parentNode,B,C,b,h,l)}
function dext_dog_bg_img_upload_image(){var a=document.dext_upload_form,c="",c="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id),b="";c&&(b=c.value);if(0<b.lastIndexOf(".")){for(var d=b.substring(b.lastIndexOf(".")+1).toLowerCase(),e=!1,f=LayerWin._dext_editor._config.allowImageFileType,g=f.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,h=f.length,l=0;l<h;l++)if(d==f[l]){e=!0;break}1==e?("0"!=LayerWin._dext_editor._config.security.encryptParam?
(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(d),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=
DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_format),document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_width),
document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_height),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config)))):(document.getElementById("savefileext").value=d,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=
LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,
document.getElementById("image_convert_height").value=LayerWin._dext_editor._config.image_convert_height,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(a=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&a.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),
a.setItem("document_domain",document.getElementById("document_domain").value),a.setItem("proxy_url",document.getElementById("proxy_url").value),a.setItem("uploadtype",document.getElementById("uploadtype").value),a.setItem("savefilename",document.getElementById("savefilename").value),a.setItem("savefileext",document.getElementById("savefileext").value),a.setItem("serverdomain",document.getElementById("serverdomain").value),a.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),a.setItem("savafoldernamerule",
document.getElementById("savafoldernamerule").value),a.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),a.setItem("image_convert_format",document.getElementById("image_convert_format").value),a.setItem("image_convert_width",document.getElementById("image_convert_width").value),a.setItem("image_convert_height",document.getElementById("image_convert_height").value),a.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&a.setItem("originalfilename",
document.getElementById("originalfilename").value),a.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(a),uploadAjaxOnprogressStart({uploadType:"doc_bg_image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:c.name,fileObj:G_dragDropFileObj,formData:a},event_dext_dog_bg_img_completed)):(a.action=document.getElementById("upload_url").value,a.submit())):alert(g)}else""==b?event_dext_dog_bg_img_completed(document.getElementById("image_url_value").value):
alert(LayerWin.dext5_lang.msg.alert_exec)}
function dext_upload_video_media(){var a=document.dext_upload_form,c;c=""==document.getElementById(file_field_id).value?G_dragDropFileObj&&G_dragDropFileObj[0]?{value:G_dragDropFileObj[0].name,id:document.getElementById(file_field_id).id}:{value:""}:document.getElementById(file_field_id);var b,d=document.getElementById("web_url");if(document.getElementsByName("InputFlag")[0].checked)if(b=c.value,0<b.lastIndexOf(".")){for(var d=b.substring(b.lastIndexOf(".")+1).toLowerCase(),e=!1,f=LayerWin._dext_editor._config.allowVideoFileType,
g=f.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,h=f.length,l=0;l<h;l++)if(d==f[l]){e=!0;break}1==e?("0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(d),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),
document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule),document.getElementById("savafilenamerule").value=
DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config)))):(document.getElementById("savefileext").value=d,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,
document.getElementById("tosavepathurl").value=""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL,document.getElementById("savafoldernamerule").value=""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("originalfilename")&&
(document.getElementById("originalfilename").value=LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(b=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&b.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),b.setItem("document_domain",document.getElementById("document_domain").value),b.setItem("proxy_url",document.getElementById("proxy_url").value),b.setItem("uploadtype",
document.getElementById("uploadtype").value),b.setItem("savefilename",document.getElementById("savefilename").value),b.setItem("savefileext",document.getElementById("savefileext").value),b.setItem("serverdomain",document.getElementById("serverdomain").value),b.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),b.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),b.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),b.setItem("cd",
document.getElementById("cd").value),document.getElementById("originalfilename")&&b.setItem("originalfilename",document.getElementById("originalfilename").value),b.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(b),uploadAjaxOnprogressStart({uploadType:"video_media",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:c.id,fileObj:G_dragDropFileObj,formData:b},event_dext_video_upload_completed)):(a.action=
document.getElementById("upload_url").value,a.submit())):alert(g)}else""==b?alert(LayerWin.dext5_lang.msg.alert_no_file):alert(LayerWin.dext5_lang.msg.alert_exec);else b=d.value,c=(new RegExp(/^(http|ftp|https|news)/)).test(b),a=/^\s\s*$/,""==b||a.exec(b)||c&&!DEXTTOP.DEXT5.util.checkUrl(b)?(alert(LayerWin.dext5_lang.msg.alert_url),d.focus()):event_dext_video_upload_completed(b)}
function event_dext_video_upload_completed(a,c){null!=a&&void 0!=a&&(a=a.replace(/<.*?script.*\/?>/g,""),a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""),a=web_url_remove_char(a));if(document.getElementsByName("InputFlag")[0].checked){if(null!=a&&void 0!=a){try{var b;b="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,a):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,
a);null!=b&&void 0!=b&&(a=b)}catch(d){}b=a.split("?");2==b.length&&-1<b[1].indexOf("^")&&(a=b[0],b=b[1].split("^"),1==b.length?a+="?"+b[0]:3==b.length&&(a+="?"+b[2]))}loading_image_show(!1);if("[FAIL]"==a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status")))try{if(0==("function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError?DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"mediaUpload",message:a,response:c.response}):
DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"mediaUpload",message:a,response:c.response})))return}catch(e){}if("1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status"))){b=!0;"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&(b=confirm(LayerWin.dext5_lang.msg.uploadFailed));if(b){b=a.indexOf("HTTP Error");var f=a.indexOf("HTTP Status");-1<b?alert(a.substring(b,b+16)):-1<f&&alert(a.substring(f,f+15))}return}if("[FAIL]"==
a.substring(0,6)){b=!0;"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&(b=confirm(LayerWin.dext5_lang.msg.uploadFailed));b&&alert(a);return}if(elemModify){"0"==LayerWin._dext_editor._config.useReplaceImage?null!=elemModify.getAttribute("src")?(elemData.src=a,elemData.source=[]):0<elemModify.getElementsByTagName("source").length&&(elemData.source=[],elemData.source.push({src:a}),elemData.src=""):""!=elemData.src?(elemData.src=a,elemData.source=[]):0<elemData.source.length&&(elemData.source=
[],elemData.source.push({src:a}),elemData.src="");"function"==typeof G_UploadCompleteCallBackFn&&(G_UploadCompleteCallBackFn(),LayerWin.hideDialog(window.frameElement.parentNode.parentNode));return}}b=document.getElementById("savefilename").value;var f=document.getElementById("media_width").value,g=document.getElementById("media_height").value,h=document.getElementById("media_width_unit"),l=document.getElementById("media_height_unit"),h=0==LayerWin.parseIntOr0(f)?"":f+h.value,l=0==LayerWin.parseIntOr0(g)?
"":g+l.value;LayerWin.insertElementsSrc(DEXTTOP.G_CURREDITOR,a);l={type:"video_media",src:a,width:h,height:l,autoPlay:document.getElementById("cb_autostart").checked,loop:document.getElementById("cb_loop").checked,controls:document.getElementById("cb_controls").checked,muted:document.getElementById("cb_muted").checked};f=""+("<video style='width:"+f+"px; height:"+g+"px;'");1==l.autoPlay&&(f+=" autoplay=''");1==l.loop&&(f+=" loop=''");1==l.controls&&(f+=" controls=''");1==l.muted&&(f+=" muted=''");
f=f+">"+("<source src='"+l.src.slice(0,l.src.lastIndexOf("."))+".mp4' type='video/mp4' />");f+="<source src='"+l.src.slice(0,l.src.lastIndexOf("."))+".ogv' type='video/ogg' />";f+="<source src='"+l.src.slice(0,l.src.lastIndexOf("."))+".webm' type='video/webm' />";f+="HTML5 Video\ub97c \uc9c0\uc6d0\ud558\uc9c0 \uc54a\ub294 \ube0c\ub77c\uc6b0\uc800";f+="</video>";LayerWin.event_dext_media_upload(b,"","","0",a,f,l,window.frameElement.parentNode.parentNode)}
function event_dext_cell_border_completed(){var a=document.getElementById("edge_border").style.borderTop,c=document.getElementById("edge_border").style.borderLeft,b=document.getElementById("edge_border").style.borderRight,d=document.getElementById("edge_border").style.borderBottom;LayerWin.event_dext_cell_border(a,c,b,d,window.frameElement.parentNode.parentNode)}
function event_dext_dog_bg_img_completed(a,c){null!=a&&void 0!=a&&(a=a.replace(/<.*?script.*\/?>/g,""),a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""),a=web_url_remove_char(a));var b=[];if(LayerWin.G_dext5plugIn&&"3,3,0,26"<=LayerWin.DEXTTOP.G_CURREDITOR._config.plugin_version)a=a.replace(/\s/g,"%20"),a=a.replace(/\'/g,"%27"),a=a.replace(/\(/g,"%28"),a=a.replace(/\)/g,"%29");else if(_init_image_url!=a){try{var d;d="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?
DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,a):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a);null!=d&&void 0!=d&&(a=d)}catch(e){}null!=a&&void 0!=a&&(b=[],"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&(b=a.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<b.length&&(a=b[0])),d=a.split("?"),2==d.length&&(a=d[0],d=d[1].split("^"),1==d.length?a+="?"+d[0]:3==d.length&&(a+="?"+d[2])),"[FAIL]"==a.substring(0,
6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status"))||LayerWin.insertImageSrc(DEXTTOP.G_CURREDITOR,a))}loading_image_show(!1);if("[FAIL]"==a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status")))try{if(0==("function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError?DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a,response:c.response}):
DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a,response:c.response})))return}catch(f){}d=document.getElementById("prev_background_remove").value;var g=document.getElementById("add").value,h=document.getElementById("repeat").value,l=document.getElementById("background_color").style.backgroundColor;LayerWin.event_dext_dog_bg_img_insert(d,a,g,h,l,window.frameElement.parentNode.parentNode,b)}
function event_dext_find_completed(){var a=document.getElementById("search_contents").value,c=document.getElementsByName("search_option")[0].checked,b=document.getElementsByName("search_option")[1].checked,d=document.getElementsByName("search_option")[2].checked,e;1==document.getElementsByName("search_direction")[0].checked?e=!1:1==document.getElementsByName("search_direction")[1].checked&&(e=!0);LayerWin.event_dext_find(a,c,b,d,e,window.frameElement.parentNode.parentNode)}
function event_dext_replace_completed(){var a=document.getElementById("search_contents").value,c=document.getElementById("replace_contents").value,b=document.getElementsByName("search_option")[0].checked,d=document.getElementsByName("search_option")[1].checked,e=document.getElementsByName("search_option")[2].checked,f;1==document.getElementsByName("search_direction")[0].checked?f=!1:1==document.getElementsByName("search_direction")[1].checked&&(f=!0);LayerWin.event_dext_replace(a,c,b,d,e,f,window.frameElement.parentNode.parentNode)}
function event_dext_all_replace_completed(){var a=document.getElementById("search_contents").value,c=document.getElementById("replace_contents").value,b=document.getElementsByName("search_option")[0].checked,d=document.getElementsByName("search_option")[1].checked,e=document.getElementsByName("search_option")[2].checked,f;1==document.getElementsByName("search_direction")[0].checked?f=!1:1==document.getElementsByName("search_direction")[1].checked&&(f=!0);LayerWin.event_dext_all_replace(a,c,b,d,e,
f,window.frameElement.parentNode.parentNode,!0)}function event_dext_spellcheck_find_completed(a){return LayerWin.event_dext_spellcheck_find(a)}function event_dext_spellcheck_replace_completed(){var a=document.getElementById("wrong_word").value,c=document.getElementById("replace_word").value;LayerWin.event_dext_spellcheck_replace(a,c)}
function event_dext_spellcheck_all_replace_completed(){var a=document.getElementById("wrong_word").value,c=document.getElementById("replace_word").value;LayerWin.event_dext_spellcheck_all_replace(a,c)}
function event_dext_capital_small_letter_completed(){1==document.getElementsByName("capital_small_letter")[0].checked?_capital_small_letter="LOWER":1==document.getElementsByName("capital_small_letter")[1].checked?_capital_small_letter="UPPER":1==document.getElementsByName("capital_small_letter")[2].checked&&(_capital_small_letter="FIRSTUPPER");LayerWin.event_dext_capital_small_letter(_capital_small_letter,window.frameElement.parentNode.parentNode)}
var G_RECENT_EMOTICON={basePlusUrl:function(a,c){return c?0==c.toLowerCase().indexOf("http:")||0==c.toLowerCase().indexOf("https:")?c:""!==a?a+c:c:""},sameUrlIndex:function(a,c,b){return a?(a=DEXTTOP.DEXT5.util.jsonToString(a),c?a.indexOf(c):a.indexOf(b)):-1}};
function event_dext_emoticon_completed(a,c,b,d,e){if(DEXTTOP.DEXT5.browser.LocalStorageSupported&&e&&0<e.length){b=[];for(var f=d="",g=b.length,h=function(a){var b={};DEXTTOP.DEXT5.util.stringTypeIsEmpty(a.s)||(b.s=a.s);DEXTTOP.DEXT5.util.stringTypeIsEmpty(a.p_s)||(b.p_s=a.p_s);DEXTTOP.DEXT5.util.stringTypeIsEmpty(a.b)||(b.b=a.b);DEXTTOP.DEXT5.util.stringTypeIsEmpty(a.p_b)||(b.p_b=a.p_b);DEXTTOP.DEXT5.util.stringTypeIsEmpty(a.a)||(b.a=a.a);return b},l=0;l<e.length;){var k=e[l],m,p=k.s,n=k.p_s,q=k.a;
if(0==g)g=h({s:p,p_s:n,a:q}),b.push(DEXTTOP.DEXT5.util.jsonToString(g));else{m=DEXTTOP.DEXT5.util.stringToJson(b[g-1]);var r=e[l-1],k=r.s,r=r.p_s,v={s:p,p_s:n,a:q},q=function(a,b,c){for(var d=a,e="";a&&b;)if(a=a.substring(0,a.lastIndexOf("/")),""!=a&&0==b.indexOf(a)){"preview"!=c?(m.s=d.substr(a.length),m.b="",v.b=a,v.s=b.substr(a.length)):(m.p_s=d.substr(a.length),m.p_b="",v.p_b=a,v.p_s=b.substr(a.length));isChecked=!0;e=a;break}return e};if(""!=d&&m.b&&p&&0==p.indexOf(d))m.s=k.substr(d.length),
m.b="",v.s=p.substr(d.length),v.b=d;else if(""==d||void 0===m.b)d=q(k,p);if(""!=f&&m.p_b&&n&&0==n.indexOf(f))m.p_s=r.substr(f.length),m.p_b="",v.p_s=n.substr(f.length),v.p_b=f;else if(""==f||void 0===m.p_b)f=q(r,n,"preview");b[g-1]=DEXTTOP.DEXT5.util.jsonToString(h(m));b.push(DEXTTOP.DEXT5.util.jsonToString(h(v)))}g=b.length;l++}DEXTTOP.DEXTWIN.localStorage.setItem("dext_"+DEXTTOP.G_CURREDITOR.ID+"_emotion_list",b.join("|"))}LayerWin.event_dext_emoticon_insert({srcURL:a,width:"",height:"",title:c,
alt:c,margin_left:"",margin_right:"",margin_top:"",margin_bottom:"",align_obj:"",align:"",border:"0",linkurl:"",borderStyle:"",borderKind:"",borderColor:"",borderThickness:""},window.frameElement.parentNode.parentNode)}
function event_dext_insert_row_column_completed(){var a="",c="";1==document.getElementById("row").checked?(a="R",1==document.getElementById("up").checked?c="U":1==document.getElementById("down").checked&&(c="D")):1==document.getElementById("column").checked&&(a="C",1==document.getElementById("right").checked?c="R":1==document.getElementById("left").checked&&(c="L"));var b=document.getElementById("line_count").value;LayerWin.event_dext_insert_row_column(a,c,b,window.frameElement.parentNode.parentNode)}
function event_dext_row_property_completed(){var a=document.getElementById("background_color").style.backgroundColor,c=document.getElementById("row_height").value,b=document.getElementById("row_thead").checked,d=document.getElementById("horizontal_align").value,e=document.getElementById("vertical_align").value;LayerWin.event_dext_row_property(a,c,b,d,e,window.frameElement.parentNode.parentNode)}
function event_dext_column_property_completed(){var a=document.getElementById("background_color").style.backgroundColor,c=document.getElementById("column_width").value,b=document.getElementById("horizontal_align").value,d=document.getElementById("vertical_align").value;LayerWin.event_dext_column_property(a,c,b,d,window.frameElement.parentNode.parentNode)}
function dext_create_iframe(){var a=document.getElementById("input_url").value,a=web_url_remove_char(a),c=(new RegExp(/^(http|ftp|https|news)/)).test(a),b=/^\s\s*$/;if(""==a||b.exec(a)||c&&!DEXTTOP.DEXT5.util.checkUrl(a))alert(LayerWin.dext5_lang.msg.alert_url),setCursorPos(document.getElementById("input_url"),!0,!1);else{c=LayerWin._dext_editor._config.accessibilityValidationItems;if(""==c||-1<c.indexOf("iframe_title"))if(c=LayerWin._dext_editor._config.accessibility,b=document.getElementById("input_title").value,
"1"==c)""==b&&alert(LayerWin.dext5_lang.msg.alert_iframe_input_title_access1);else if("2"==c&&""==b){alert(LayerWin.dext5_lang.msg.alert_iframe_input_title_access2);document.getElementById("input_title").focus();return}var c=document.getElementById("input_width").value,d=document.getElementById("input_width_unit"),b=document.getElementById("input_height_unit"),d=0==LayerWin.parseIntOr0(c)?"":c+d.value,c=document.getElementById("input_height").value,c=0==LayerWin.parseIntOr0(c)?"":c+b.value,a={type:"iframe",
src:a,id:document.getElementById("input_id").value,name:document.getElementById("input_name").value,className:document.getElementById("input_class").value,title:document.getElementById("input_title").value,width:d,height:c,align:document.getElementById("select_align").value,scrolling:document.getElementById("select_scroll").value,frameBorder:document.getElementById("input_border").checked},c=LayerWin.getLinkMediaType(a.src);0<c.length&&(a.type=c,a.type2="iframe");LayerWin.event_dext_create_iframe(a,
window.frameElement.parentNode.parentNode)}}
function dext_create_hyperlink_image(){var a=document.dext_upload_form,c="",c="1"==LayerWin._dext_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id),b;b=c.value;if(""==b)alert(LayerWin.dext5_lang.background_image.msg_file_select),setCursorPos(c,!0,!1);else if(0<b.lastIndexOf(".")){for(var d=b.substring(b.lastIndexOf(".")+1).toLowerCase(),e=!1,f=LayerWin._dext_editor._config.allowImageFileType,g=f.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,
h=f.length,l=0;l<h;l++)if(d==f[l]){e=!0;break}e?("0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(d),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=
DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_format),
document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_width),document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_height),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config)))):(document.getElementById("savefileext").value=
d,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=
LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,document.getElementById("image_convert_height").value=LayerWin._dext_editor._config.image_convert_height,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(a=
new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&a.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),a.setItem("document_domain",document.getElementById("document_domain").value),a.setItem("proxy_url",document.getElementById("proxy_url").value),a.setItem("uploadtype",document.getElementById("uploadtype").value),a.setItem("savefilename",document.getElementById("savefilename").value),a.setItem("savefileext",document.getElementById("savefileext").value),
a.setItem("serverdomain",document.getElementById("serverdomain").value),a.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),a.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),a.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),a.setItem("image_convert_format",document.getElementById("image_convert_format").value),a.setItem("image_convert_width",document.getElementById("image_convert_width").value),a.setItem("image_convert_height",
document.getElementById("image_convert_height").value),a.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&a.setItem("originalfilename",document.getElementById("originalfilename").value),a.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(a),uploadAjaxOnprogressStart({uploadType:"hyperlink_image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:c.name,
fileObj:G_dragDropFileObj,formData:a},dext_create_hyperlink)):(a.action=document.getElementById("upload_url").value,a.submit())):(alert(g),setCursorPos(c,!0,!1))}else alert(g),setCursorPos(c,!0,!1)}
function dext_create_hyperlink(a,c){a&&(a=a.replace(/<.*?script.*\/?>/g,""),a=web_url_remove_char(a));var b="";if("hyperlink"==document.getElementById("select_category").value||0>"bookmark,image".indexOf(document.getElementById("select_category").value)){b=document.getElementById("input_url").value;b=web_url_remove_char(b);if(null!=b&&void 0!=b&&""!=b){var d;try{d="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertHyperlink?DEXTTOP.G_CURREDITOR._config.event.beforeInsertHyperlink(DEXTTOP.G_CURREDITOR.ID,
b):DEXTTOP.DEXTWIN.dext_editor_before_insert_hyperlink_event(DEXTTOP.G_CURREDITOR.ID,b)}catch(e){}null!=d&&void 0!=d&&(b=d)}d=(new RegExp(/^(http|https|ftp|news)/)).test(b);var f=/^\s\s*$/;if(""==b||f.exec(b)||d&&!DEXTTOP.DEXT5.util.checkUrl(b)){alert(LayerWin.dext5_lang.msg.alert_url);document.getElementById("input_url").value=b;setCursorPos(document.getElementById("input_url"),!0,!1);return}}else if("bookmark"==document.getElementById("select_category").value&&""==document.getElementById("select_bookmark").value){alert(LayerWin.dext5_lang.msg.alert_bookmark);
setCursorPos(document.getElementById("select_bookmark"),!0,!1);return}d=LayerWin._dext_editor._config.accessibilityValidationItems;if(""==d||-1<d.indexOf("a_title"))if(d=LayerWin._dext_editor._config.accessibility,f=document.getElementById("input_text").value,"1"==d)""==f&&alert(LayerWin.dext5_lang.msg.alert_hyperlink_input_text_access1);else if("2"==d&&""==f){alert(LayerWin.dext5_lang.msg.alert_hyperlink_input_text_access2);document.getElementById("input_text").focus();return}d=document.getElementById("select_category").value;
0>"bookmark,image".indexOf(document.getElementById("select_category").value)&&(d="hyperlink");b={type:d,url:b,text:document.getElementById("input_text").value,title:document.getElementById("input_title").value,target:document.getElementById("select_target").value,bookname:document.getElementById("select_bookmark").value,id:document.getElementById("input_id").value,className:document.getElementById("input_class").value,attr_info_arr:[]};if(null!=a&&void 0!=a){a=a.replace(/\r\n/g,"");a=a.replace(/\n/g,
"");a=a.replace(/\t/g,"");try{var g;g="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,a):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a);null!=g&&void 0!=g&&(a=g)}catch(h){}if("[FAIL]"==a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status")))try{if(0==("function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError?
DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a,response:c.response}):DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"imageUpload",message:a,response:c.response})))return}catch(l){}"0"!=LayerWin._dext_editor._config.imageCustomPropertyDelimiter&&(b.attr_info_arr=a.split(LayerWin._dext_editor._config.imageCustomPropertyDelimiter),1<b.attr_info_arr.length&&(a=b.attr_info_arr[0]));g=a.split("?");2==g.length&&(a=g[0],g=g[1].split("^"),
1==g.length?a+="?"+g[0]:3==g.length&&(img_real_width=g[0],img_real_height=g[1],a+="?"+g[2]));!a||"[FAIL]"==a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status"))||LayerWin.insertImageSrc(DEXTTOP.G_CURREDITOR,a);if(elemModify){if(b.attr_info_arr&&1<b.attr_info_arr.length)for(g=b.attr_info_arr.length,d=1;d<g;d++)f=b.attr_info_arr[d].split("^"),2==f.length&&elemModify.setAttribute(f[0],f[1]);document.getElementById("input_url").value=
a;set_modify_ok();return}b.url=a}LayerWin.event_dext_create_hyperlink(b,window.frameElement.parentNode.parentNode)}function split_cell_ok(){var a=document.getElementById("input_row"),c=document.getElementById("input_column"),b=document.getElementsByName("radio_split")[0],d=document.getElementsByName("radio_split")[1];b.checked?c.value="0":d.checked&&(a.value="0");LayerWin.event_dext_split_cell(a.value,c.value,window.frameElement.parentNode.parentNode)}
function symbol_ok(){var a=document.getElementById("input_output");LayerWin.event_dext_symbol(a.innerHTML,window.frameElement.parentNode.parentNode)}
function template_ok(){var a=document.getElementById("clicked_template").value,c=document.getElementById("template_print_header").value,b=document.getElementById("template_print_footer").value,a={url:a,print_header:c,print_footer:b};0==DEXTTOP.DEXT5.isEmpty()?1==confirm(LayerWin.dext5_lang.msg.newDocument)&&LayerWin.event_dext_template(a,window.frameElement.parentNode.parentNode):LayerWin.event_dext_template(a,window.frameElement.parentNode.parentNode)}
function dext_insert_link_media(){if(""==document.getElementById("ta_media_tag").value)alert(LayerWin.dext5_lang.insert_link_media.tag_null);else{var a="",c=document.getElementById("ta_media_tag").value,b=document.getElementById("ta_media_caption").value,d=!1;document.getElementById("check_allow_full_screen")&&(d=document.getElementById("check_allow_full_screen").checked);var c=c.replace(/\r\n/g,""),c=c.replace(/\n/g,""),c=c.replace(/\r/g,""),a=c.match(/(<[\s]*embed [^>]+>)/gi),e=c.match(/(<[\s]*iframe [^>]+>)/gi),
c=c.match(/(<[\s]*object [^>]+>)/gi),f=LayerWin._dext_editor._config.xss_remove_tags.toLowerCase();if(c&&-1<f.indexOf("object"))alert(LayerWin.dext5_lang.msg.alert_insert_link_media_xss);else{if(a){if(-1<f.indexOf("embed")){alert(LayerWin.dext5_lang.msg.alert_insert_link_media_xss);return}a=a[0]}else if(e){if(-1<f.indexOf("iframe")){alert(LayerWin.dext5_lang.msg.alert_insert_link_media_xss);return}a=e[0]}else{alert(LayerWin.dext5_lang.insert_link_media.invalid_tag);return}if("1"==LayerWin._dext_editor._config.allowLinkMediaCaption)if("1"==
LayerWin._dext_editor._config.accessibility)""==b&&alert(LayerWin.dext5_lang.msg.alert_insert_link_media_caption_access1);else if("2"==LayerWin._dext_editor._config.accessibility&&""==b){alert(LayerWin.dext5_lang.msg.alert_insert_link_media_caption_access2);document.getElementById("ta_media_caption").focus();return}LayerWin.event_dext_insert_link_media(a,b,d,window.frameElement.parentNode.parentNode)}}}
function dext_modify_link_media(a){if(""==document.getElementById("ta_media_tag").value)alert(LayerWin.dext5_lang.insert_link_media.tag_null);else{var c="",b=document.getElementById("ta_media_tag").value,d=document.getElementById("ta_media_caption").value,e=!1;document.getElementById("check_allow_full_screen")&&(e=document.getElementById("check_allow_full_screen").checked);b=b.replace(/\r\n/g,"");b=b.replace(/\n/g,"");b=b.replace(/\r/g,"");c=b.match(/(<[\s]*embed [^>]+>)/gi);b=b.match(/(<[\s]*iframe [^>]+>)/gi);
if(c)c=c[0];else if(b)c=b[0];else{alert(LayerWin.dext5_lang.insert_link_media.invalid_tag);return}LayerWin.event_dext_modify_link_media(c,d,e,a,window.frameElement.parentNode.parentNode)}}function dext_insert_paste_dialog_html(){var a=document.getElementById("pasteArea").contentWindow.document.body.innerHTML;LayerWin.event_dext_insert_paste_dialog_html(a,window.frameElement.parentNode.parentNode)}
function dext_insert_input_text(){var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertAlign:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertReadonly:!1,insertType:"text",insertSize:"",insertMaxlength:"",insertEventNameArr:[],insertEventFunctionArr:[]};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;
a.insertTitle=document.getElementById("input_title").value;a.insertAlign=document.getElementById("input_textalign").value;a.insertWidth="0"==document.getElementById("input_width").value?"":document.getElementById("input_width").value;a.insertHeight="0"==document.getElementById("input_height").value?"":document.getElementById("input_height").value;a.insertDisabled=document.getElementById("input_disabled").checked;a.insertReadonly=document.getElementById("input_readonly").checked;a.insertSize="0"==
document.getElementById("input_size").value?"":document.getElementById("input_size").value;a.insertMaxlength="0"==document.getElementById("input_maxtext").value?"":document.getElementById("input_maxtext").value;for(var c=document.getElementsByName("input_type"),b=c.length,d=0;d<b;d++)if(1==c[d].checked){a.insertType=c[d].value;break}for(var c=document.getElementById("event_table"),b=c.childNodes.length,d=0;d<b;d++){var e=c.childNodes[d].getElementsByTagName("span");a.insertEventNameArr.push(e[0].innerHTML);
a.insertEventFunctionArr.push(e[1].innerHTML)}LayerWin.event_dext_insert_input_text(a,window.frameElement.parentNode.parentNode)}
function set_modify_field_input_text(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value"));""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=
elemModify.title);""!=elemModify.style.textAlign&&(document.getElementById("input_textalign").value=elemModify.style.textAlign);""!=elemModify.style.width&&(document.getElementById("input_width").value=parseInt(elemModify.style.width,10));""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10));elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);elemModify.readOnly&&(document.getElementById("input_readonly").checked=
!0);elemModify.getAttribute("size")&&""!=elemModify.getAttribute("size")&&(document.getElementById("input_size").value=elemModify.getAttribute("size"));elemModify.getAttribute("maxlength")&&""!=elemModify.getAttribute("maxlength")&&(document.getElementById("input_maxtext").value=elemModify.getAttribute("maxlength"));"text"==elemModify.type?(document.getElementById("input_type_general").checked=!0,document.getElementById("input_type_password").checked=!1):"password"==elemModify.type&&(document.getElementById("input_type_general").checked=
!1,document.getElementById("input_type_password").checked=!0);if(elemModify.getAttribute("dext5customdata")){var a=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata"));if("event"==a.type){var c=a.eventFunction,a=a.eventName.split("\x0B"),c=c.split("\x0B"),b=a.length;for(i=0;i<b;i++){var d=document.getElementById("event_table"),e=document.createElement("tr"),f=document.createElement("td");f.className="type2";var g=document.createElement("a"),h=document.createElement("span");h.appendChild(document.createTextNode(a[i]));
g.appendChild(h);g.title=a[i];h=document.createElement("td");h.className="type2";h.style.width="65%";var l=document.createElement("a"),k=document.createElement("span");k.appendChild(document.createTextNode(c[i]));l.appendChild(k);l.title=c[i];f.appendChild(g);e.appendChild(f);h.appendChild(l);e.appendChild(h);d.appendChild(e)}}}}
function dext_modify_input_text(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();""!=document.getElementById("input_value").value?(elemModify.setAttribute("value",document.getElementById("input_value").value),elemModify.value=document.getElementById("input_value").value):(elemModify.setAttribute("value",""),elemModify.value="");""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id");
""!=document.getElementById("input_class").value?elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title");""!=document.getElementById("input_textalign").value?elemModify.style.textAlign=document.getElementById("input_textalign").value:elemModify.style.textAlign="";""!=document.getElementById("input_width").value&&
"0"!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="";""!=document.getElementById("input_height").value&&"0"!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+"px":elemModify.style.height="";elemModify.disabled=document.getElementById("input_disabled").checked;elemModify.readOnly=document.getElementById("input_readonly").checked;""!=document.getElementById("input_size").value&&
"0"!=document.getElementById("input_size").value?elemModify.size=document.getElementById("input_size").value:elemModify.removeAttribute("size");""!=document.getElementById("input_maxtext").value&&"0"!=document.getElementById("input_maxtext").value?elemModify.maxLength=document.getElementById("input_maxtext").value:elemModify.removeAttribute("maxLength");for(var a=document.getElementsByName("input_type"),c=a.length,b=0;b<c;b++)if(1==a[b].checked){try{elemModify.type=a[b].value}catch(d){b='<input type="'+
a[b].value+'" />',a=LayerWin._iframeDoc.createElement("div"),a.innerHTML=b,newElem=a.firstChild,LayerWin.setCopyAllObjectAtributesForInput(elemModify,newElem,!1),elemModify.parentNode.replaceChild(newElem,elemModify),LayerWin.DEXTTOP.G_SELECTED_ELEMENT=newElem,elemModify=null,elemModify=newElem}break}""!=document.getElementById("input_name").value?DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?elemModify.setAttribute("name",document.getElementById("input_name").value):
(b=elemModify.outerHTML,b=b.replace('name="'+elemModify.name+'"',""),b=b.replace("name='"+elemModify.name+"'",""),b=b.replace("name="+elemModify.name,""),b=b.replace(">",'name="'+document.getElementById("input_name").value+'" />'),elemModify.outerHTML=b):elemModify.removeAttribute("name");var e=document.getElementById("event_table"),f=e.childNodes.length;if(0<f){for(var c=a="",b=0;b<f;b++)0!=b&&(a+="\x0B",c+="\x0B"),a+=e.childNodes[b].getElementsByTagName("span")[0].innerHTML,c+=e.childNodes[b].getElementsByTagName("span")[1].innerHTML;
""!=a&&(b={type:"event"},b.eventName=a,b.eventFunction=c,LayerWin.setDextCustomData(elemModify,b))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;event_dext_close()}
function dext_insert_input_radio_or_checkbox(a){var c={insertType:"",insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertChecked:!1,insertEventNameArr:[],insertEventFunctionArr:[]};c.insertType=a;c.insertName=document.getElementById("input_name").value;c.insertValue=document.getElementById("input_value").value;c.insertId=document.getElementById("input_id").value;c.insertClass=document.getElementById("input_class").value;c.insertTitle=
document.getElementById("input_title").value;c.insertWidth=document.getElementById("input_width").value;c.insertHeight=document.getElementById("input_height").value;c.insertDisabled=document.getElementById("input_disabled").checked;var b=document.getElementsByName("input_status"),d=b.length;for(a=0;a<d;a++)if(1==b[a].checked){c.insertChecked="true"==b[a].value?!0:!1;break}b=document.getElementById("event_table");d=b.childNodes.length;for(a=0;a<d;a++){var e=b.childNodes[a].getElementsByTagName("span");
c.insertEventNameArr.push(e[0].innerHTML);c.insertEventFunctionArr.push(e[1].innerHTML)}LayerWin.event_dext_insert_input_radio_or_checkbox(c,window.frameElement.parentNode.parentNode)}
function set_modify_field_input_radio_or_checkbox(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value"));""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=
elemModify.title);""!=elemModify.style.width&&(document.getElementById("input_width").value=parseInt(elemModify.style.width,10));""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10));elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);elemModify.checked?document.getElementById("input_checked").checked=!0:document.getElementById("input_not_checked").checked=!0;if(elemModify.getAttribute("dext5customdata")){var a=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata"));
if("event"==a.type){var c=a.eventFunction,a=a.eventName.split("\x0B"),c=c.split("\x0B"),b=a.length;for(i=0;i<b;i++){var d=document.getElementById("event_table"),e=document.createElement("tr"),f=document.createElement("td");f.className="type2";var g=document.createElement("a"),h=document.createElement("span");h.innerHTML=a[i];g.appendChild(h);g.title=a[i];h=document.createElement("td");h.className="type2";h.style.width="65%";var l=document.createElement("a"),k=document.createElement("span");k.innerHTML=
c[i];l.appendChild(k);l.title=c[i];f.appendChild(g);e.appendChild(f);h.appendChild(l);e.appendChild(h);d.appendChild(e)}}}}
function dext_modify_input_radio_or_checkbox(a){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();""!=document.getElementById("input_value").value?elemModify.setAttribute("value",document.getElementById("input_value").value):elemModify.removeAttribute("value");""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id");""!=document.getElementById("input_class").value?
elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title");""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="";""!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+
"px":elemModify.style.height="";elemModify.disabled=document.getElementById("input_disabled").checked;var c=document.getElementsByName("input_status"),b=c.length;for(a=0;a<b;a++)if(1==c[a].checked){"true"==c[a].value?(elemModify.checked=!0,elemModify.setAttribute("checked","checked")):(elemModify.checked=!1,elemModify.removeAttribute("checked"));break}""!=document.getElementById("input_name").value?DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?elemModify.setAttribute("name",
document.getElementById("input_name").value):(a=elemModify.outerHTML,a=a.replace('name="'+elemModify.name+'"',""),a=a.replace("name='"+elemModify.name+"'",""),a=a.replace("name="+elemModify.name,""),a=a.replace(">",'name="'+document.getElementById("input_name").value+'" />'),elemModify.outerHTML=a):elemModify.removeAttribute("name");var d=document.getElementById("event_table"),e=d.childNodes.length;if(0<e){b=c="";for(a=0;a<e;a++)0!=a&&(c+="\x0B",b+="\x0B"),c+=d.childNodes[a].getElementsByTagName("span")[0].innerHTML,
b+=d.childNodes[a].getElementsByTagName("span")[1].innerHTML;""!=c&&(a={type:"event"},a.eventName=c,a.eventFunction=b,LayerWin.setDextCustomData(elemModify,a))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;event_dext_close()}
function dext_insert_input_button(){var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertAlign:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertType:"button",insertEventNameArr:[],insertEventFunctionArr:[]};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;a.insertTitle=document.getElementById("input_title").value;
a.insertAlign=document.getElementById("input_textalign").value;a.insertWidth=document.getElementById("input_width").value;a.insertHeight=document.getElementById("input_height").value;a.insertDisabled=document.getElementById("input_disabled").checked;for(var c=document.getElementsByName("input_type"),b=c.length,d=0;d<b;d++)if(1==c[d].checked){a.insertType=c[d].value;break}for(var c=document.getElementById("event_table"),b=c.childNodes.length,d=0;d<b;d++){var e=c.childNodes[d].getElementsByTagName("span");
a.insertEventNameArr.push(e[0].innerHTML);a.insertEventFunctionArr.push(e[1].innerHTML)}LayerWin.event_dext_insert_input_button(a,window.frameElement.parentNode.parentNode)}
function set_modify_field_input_button(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value"));""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=
elemModify.title);""!=elemModify.style.textAlign&&(document.getElementById("input_textalign").value=elemModify.style.textAlign);""!=elemModify.style.width&&(document.getElementById("input_width").value=parseInt(elemModify.style.width,10));""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10));elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);elemModify.readOnly&&(document.getElementById("input_readonly").checked=
!0);"button"==elemModify.type?(document.getElementById("input_general").checked=!0,document.getElementById("input_reset").checked=!1,document.getElementById("input_submit").checked=!1):"reset"==elemModify.type?(document.getElementById("input_general").checked=!1,document.getElementById("input_reset").checked=!0,document.getElementById("input_submit").checked=!1):"submit"==elemModify.type&&(document.getElementById("input_general").checked=!1,document.getElementById("input_reset").checked=!1,document.getElementById("input_submit").checked=
!0);if(elemModify.getAttribute("dext5customdata")){var a=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata"));if("event"==a.type){var c=a.eventFunction,a=a.eventName.split("\x0B"),c=c.split("\x0B"),b=a.length;for(i=0;i<b;i++){var d=document.getElementById("event_table"),e=document.createElement("tr"),f=document.createElement("td");f.className="type2";var g=document.createElement("a"),h=document.createElement("span");h.innerHTML=a[i];g.appendChild(h);g.title=a[i];h=document.createElement("td");
h.className="type2";h.style.width="65%";var l=document.createElement("a"),k=document.createElement("span");k.innerHTML=c[i];l.appendChild(k);l.title=c[i];f.appendChild(g);e.appendChild(f);h.appendChild(l);e.appendChild(h);d.appendChild(e)}}}}
function dext_modify_input_button(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id");""!=document.getElementById("input_class").value?elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:
elemModify.removeAttribute("title");""!=document.getElementById("input_textalign").value?elemModify.style.textAlign=document.getElementById("input_textalign").value:elemModify.style.textAlign="";""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="";""!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+"px":elemModify.style.height="";elemModify.disabled=
document.getElementById("input_disabled").checked;for(var a=document.getElementsByName("input_type"),c=a.length,b=0;b<c;b++)if(1==a[b].checked){try{elemModify.type=a[b].value}catch(d){b='<input type="'+a[b].value+'" />',a=LayerWin._iframeDoc.createElement("div"),a.innerHTML=b,newElem=a.firstChild,LayerWin.setCopyAllObjectAtributesForInput(elemModify,newElem,!1),elemModify.parentNode.replaceChild(newElem,elemModify),LayerWin.DEXTTOP.G_SELECTED_ELEMENT=newElem,elemModify=null,elemModify=newElem}break}""!=
document.getElementById("input_value").value?elemModify.setAttribute("value",document.getElementById("input_value").value):elemModify.removeAttribute("value");""!=document.getElementById("input_name").value?DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?elemModify.setAttribute("name",document.getElementById("input_name").value):(b=elemModify.outerHTML,b=b.replace('name="'+elemModify.name+'"',""),b=b.replace("name='"+elemModify.name+"'",""),b=b.replace("name="+
elemModify.name,""),b=b.replace(">",'name="'+document.getElementById("input_name").value+'" />'),elemModify.outerHTML=b):elemModify.removeAttribute("name");var e=document.getElementById("event_table"),f=e.childNodes.length;if(0<f){for(var c=a="",b=0;b<f;b++)0!=b&&(a+="\x0B",c+="\x0B"),a+=e.childNodes[b].getElementsByTagName("span")[0].innerHTML,c+=e.childNodes[b].getElementsByTagName("span")[1].innerHTML;""!=a&&(b={type:"event"},b.eventName=a,b.eventFunction=c,LayerWin.setDextCustomData(elemModify,
b))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;event_dext_close()}
function setInputSelectPageEvent(){var a=document.getElementById("input_value"),c=document.getElementById("btn_add"),b=document.getElementById("btn_modify"),d=document.getElementById("btn_delete"),e=document.getElementById("btn_up"),f=document.getElementById("btn_down");b.disabled=!0;b.className="non_btn";d.disabled=!0;d.className="non_btn";e.disabled=!0;e.className="non_btn";f.disabled=!0;f.className="non_btn";var g=document.getElementById("option_table");DEXTTOP.DEXT5.util.addEvent(c,"click",btn_select_add_click);
DEXTTOP.DEXT5.util.addEvent(b,"click",btn_select_mod_click);DEXTTOP.DEXT5.util.addEvent(d,"click",btn_select_del_click);DEXTTOP.DEXT5.util.addEvent(e,"click",btn_select_up_click);DEXTTOP.DEXT5.util.addEvent(f,"click",btn_select_down_click);DEXTTOP.DEXT5.util.addEvent(g,"click",function(a){a=a||window.event;var c=a.target?a.target:a.srcElement;a=document.getElementById("input_option");var h=document.getElementById("input_option_value");if(c=Dext5LayerWin.GetParentbyTagName(c,"tr"))_clicked_options=
c,c.style.background="#e5e5e5",a.value=c.getElementsByTagName("span")[0].innerHTML,h.value=c.getElementsByTagName("span")[1].innerHTML;for(a=0;a<g.childNodes.length;a++)g.childNodes[a]!=_clicked_options&&(g.childNodes[a].style.background="white");b.disabled=!1;b.className="in_btn";d.disabled=!1;d.className="in_btn";e.disabled=!1;e.className="in_btn";f.disabled=!1;f.className="in_btn"});var h=document.getElementById("input_multiselect");LayerWin.DEXTTOP.DEXT5.util.addEvent(h,"click",function(){if(0==
h.checked)for(var b=g.getElementsByTagName("input"),c=b.length,d=!1,e=0;e<c;e++)b[e].checked&&(d?b[e].checked=!1:(a.value=g.childNodes[e].getElementsByTagName("span")[1].innerHTML,d=!0))})}
function btn_select_add_click(){var a=document.getElementById("input_option"),c=document.getElementById("input_option_value");document.getElementById("btn_add");if(""!=a.value){var b=document.getElementById("option_table"),d=document.getElementById("input_value"),e=document.createElement("tr"),f=document.createElement("td");f.className="type";var g=document.createElement("input");g.type="checkbox";var h=document.createElement("td");h.className="type2";h.style.width="44%";var l=document.createElement("a"),
k=document.createElement("span");k.innerHTML=a.value;l.appendChild(k);l.title=a.value;k=document.createElement("td");k.className="type2";k.style.width="44%";var m=document.createElement("a"),p=document.createElement("span");p.innerHTML=c.value;m.appendChild(p);m.title=c.value;f.appendChild(g);e.appendChild(f);h.appendChild(l);e.appendChild(h);k.appendChild(m);e.appendChild(k);b.appendChild(e);a.value="";c.value="";LayerWin.DEXTTOP.DEXT5.util.addEvent(g,"click",function(){if(0==document.getElementById("input_multiselect").checked)if(1==
g.checked)for(var a=b.getElementsByTagName("input"),c=a.length,e=0;e<c;e++)a[e]!=g?a[e].checked=!1:d.value=p.innerHTML;else d.value="";else if(1==g.checked)d.value=p.innerHTML;else for(a=b.getElementsByTagName("input"),c=a.length,d.value="",e=0;e<c;e++)if(a[e].checked){d.value=b.childNodes[e].getElementsByTagName("span")[1].innerHTML;break}})}}
function btn_select_mod_click(){if(_clicked_options){var a=document.getElementById("input_option"),c=document.getElementById("input_option_value");_clicked_options.getElementsByTagName("span")[0].innerHTML=a.value;_clicked_options.getElementsByTagName("span")[1].innerHTML=c.value}}
function btn_select_del_click(){document.getElementById("option_table");document.getElementById("btn_add");var a=document.getElementById("btn_modify"),c=document.getElementById("btn_delete"),b=document.getElementById("btn_up"),d=document.getElementById("btn_down");document.getElementById("input_option").value="";document.getElementById("input_option_value").value="";_clicked_options&&_clicked_options.parentNode.removeChild(_clicked_options);a.disabled=!0;a.className="non_btn";c.disabled=!0;c.className=
"non_btn";b.disabled=!0;b.className="non_btn";d.disabled=!0;d.className="non_btn"}function btn_select_up_click(){_clicked_options&&_clicked_options.previousSibling&&_clicked_options.parentNode.insertBefore(_clicked_options,_clicked_options.previousSibling)}function btn_select_down_click(){_clicked_options&&_clicked_options.nextSibling&&_clicked_options.parentNode.insertBefore(_clicked_options.nextSibling,_clicked_options)}
function setInputCommonEventPageEvent(){var a=document.getElementById("btn_event_add"),c=document.getElementById("btn_event_modify"),b=document.getElementById("btn_event_delete");c.disabled=!0;c.className="non_btn";b.disabled=!0;b.className="non_btn";var d=document.getElementById("event_table");DEXTTOP.DEXT5.util.addEvent(a,"click",btn_common_event_add_click);DEXTTOP.DEXT5.util.addEvent(c,"click",btn_common_event_mod_click);DEXTTOP.DEXT5.util.addEvent(b,"click",btn_common_event_del_click);DEXTTOP.DEXT5.util.addEvent(d,
"click",function(a){a=a||window.event;var f=a.target?a.target:a.srcElement;a=document.getElementById("input_event_name");var g=document.getElementById("input_event_function");if(f=Dext5LayerWin.GetParentbyTagName(f,"tr"))_clicked_event=f,f.style.background="#e5e5e5",a.value=f.getElementsByTagName("span")[0].innerHTML,g.value=f.getElementsByTagName("span")[1].innerHTML;for(a=0;a<d.childNodes.length;a++)d.childNodes[a]!=_clicked_event&&(d.childNodes[a].style.background="white");c.disabled=!1;c.className=
"in_btn";b.disabled=!1;b.className="in_btn"})}
function btn_common_event_add_click(){var a=document.getElementById("input_event_name"),c=document.getElementById("input_event_function");document.getElementById("btn_event_add");if(""!=a.value){var b=document.getElementById("event_table"),d=b.childNodes.length;if(0<d)for(var e=0;e<d;e++)if(a.value==b.childNodes[e].getElementsByTagName("span")[0].innerHTML){alert(a.value+" "+LayerWin.dext5_lang.input_common.event_duplicate_msg);return}b=document.getElementById("event_table");d=document.createElement("tr");
e=document.createElement("td");e.className="type2";var f=document.createElement("a"),g=document.createElement("span");g.innerHTML=a.value;f.appendChild(g);f.title=a.value;a=document.createElement("td");a.className="type2";a.style.width="65%";var g=document.createElement("a"),h=document.createElement("span");h.innerHTML=c.value;g.appendChild(h);g.title=c.value;e.appendChild(f);d.appendChild(e);a.appendChild(g);d.appendChild(a);b.appendChild(d);c.value=""}}
function btn_common_event_mod_click(){if(_clicked_event){var a=document.getElementById("input_event_name"),c=document.getElementById("input_event_function"),b=document.getElementById("event_table"),d=b.childNodes.length;if(0<d)for(var e=0;e<d;e++)if("white"==b.childNodes[e].style.background&&a.value==b.childNodes[e].getElementsByTagName("span")[0].innerHTML){alert(a.value+" "+LayerWin.dext5_lang.input_common.event_duplicate_msg);return}_clicked_event.getElementsByTagName("span")[0].innerHTML=a.value;
_clicked_event.getElementsByTagName("span")[1].innerHTML=c.value}}function btn_common_event_del_click(){document.getElementById("event_table");document.getElementById("btn_event_add");var a=document.getElementById("btn_event_modify"),c=document.getElementById("btn_event_delete");document.getElementById("input_event_function").value="";_clicked_event&&_clicked_event.parentNode.removeChild(_clicked_event);a.disabled=!0;a.className="non_btn";c.disabled=!0;c.className="non_btn"}
function dext_insert_input_select(){var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertSize:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertMultiselect:!1,insertOptionsArr:[],insertOptionsValueArr:[],insertOptionsSelected:[],insertEventNameArr:[],insertEventFunctionArr:[]};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;
a.insertTitle=document.getElementById("input_title").value;a.insertSize="0"==document.getElementById("input_size").value?"":document.getElementById("input_size").value;a.insertWidth=document.getElementById("input_width").value;a.insertHeight=document.getElementById("input_height").value;a.insertDisabled=document.getElementById("input_disabled").checked;a.insertMultiselect=document.getElementById("input_multiselect").checked;for(var c=document.getElementById("option_table"),b=c.childNodes.length,d=
0;d<b;d++){var e=c.childNodes[d].getElementsByTagName("span"),f=c.childNodes[d].getElementsByTagName("input")[0];a.insertOptionsArr.push(e[0].innerHTML);a.insertOptionsValueArr.push(e[1].innerHTML);a.insertOptionsSelected.push(f.checked)}c=document.getElementById("event_table");b=c.childNodes.length;for(d=0;d<b;d++)e=c.childNodes[d].getElementsByTagName("span"),a.insertEventNameArr.push(e[0].innerHTML),a.insertEventFunctionArr.push(e[1].innerHTML);LayerWin.event_dext_insert_input_select(a,window.frameElement.parentNode.parentNode)}
function set_modify_field_input_select(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value"));""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=
elemModify.title);""!=elemModify.size&&(document.getElementById("input_size").value=elemModify.size);""!=elemModify.style.width&&(document.getElementById("input_width").value=parseInt(elemModify.style.width,10));""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10));elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);elemModify.multiple&&(document.getElementById("input_multiselect").checked=!0);for(var a=elemModify.getElementsByTagName("option"),
c=a.length,b=0;b<c;b++){var d=a[b].innerHTML,e=a[b].value;document.getElementById("btn_add");var f=document.getElementById("option_table"),g=document.getElementById("input_value"),h=document.createElement("tr"),l=document.createElement("td");l.className="type";var k=document.createElement("input");k.type="checkbox";var m=document.createElement("td");m.className="type2";m.style.width="44%";var p=document.createElement("a"),n=document.createElement("span");n.innerHTML=d;p.appendChild(n);p.title=d;n=
document.createElement("td");n.className="type2";n.style.width="44%";var d=document.createElement("a"),q=document.createElement("span");q.innerHTML=e;d.appendChild(q);d.title=e;l.appendChild(k);h.appendChild(l);m.appendChild(p);h.appendChild(m);n.appendChild(d);h.appendChild(n);f.appendChild(h);LayerWin.DEXTTOP.DEXT5.util.addEvent(k,"click",function(a){a=a.target?a.target:a.srcElement;if(0==document.getElementById("input_multiselect").checked)if(1==a.checked)for(var b=f.getElementsByTagName("input"),
c=b.length,d=0;d<c;d++)b[d]!=a?b[d].checked=!1:(a.checked=!0,g.value=q.innerHTML);else g.value="";else if(1==a.checked)g.value=q.innerHTML;else for(b=f.getElementsByTagName("input"),c=b.length,g.value="",d=0;d<c;d++)if(b[d].checked){g.value=f.childNodes[d].getElementsByTagName("span")[1].innerHTML;break}});a[b].selected&&(k.checked=!0)}if(elemModify.getAttribute("dext5customdata")&&(h=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata")),"event"==h.type))for(b=h.eventFunction,a=h.eventName.split("\x0B"),
c=b.split("\x0B"),e=a.length,b=0;b<e;b++)f=document.getElementById("event_table"),h=document.createElement("tr"),l=document.createElement("td"),l.className="type2",k=document.createElement("a"),m=document.createElement("span"),m.innerHTML=a[b],k.appendChild(m),k.title=a[b],m=document.createElement("td"),m.className="type2",m.style.width="65%",p=document.createElement("a"),n=document.createElement("span"),n.innerHTML=c[b],p.appendChild(n),p.title=c[b],l.appendChild(k),h.appendChild(l),m.appendChild(p),
h.appendChild(m),f.appendChild(h)}
function dext_modify_input_select(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();""!=document.getElementById("input_value").value?elemModify.setAttribute("value",document.getElementById("input_value").value):elemModify.removeAttribute("value");""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id");""!=document.getElementById("input_class").value?elemModify.className=
document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title");""!=document.getElementById("input_size").value&&"0"!=document.getElementById("input_size").value?elemModify.size=document.getElementById("input_size").value:elemModify.removeAttribute("size");""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+
"px":elemModify.style.width="";""!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+"px":elemModify.style.height="";elemModify.disabled=document.getElementById("input_disabled").checked;elemModify.multiple=document.getElementById("input_multiselect").checked;elemModify.innerHTML="";for(var a=document.getElementById("option_table"),c=a.childNodes.length,b=0;b<c;b++){var d=document.createElement("option");d.innerHTML=a.childNodes[b].getElementsByTagName("span")[0].innerHTML;
d.setAttribute("value",a.childNodes[b].getElementsByTagName("span")[1].innerHTML);d.selected=a.childNodes[b].getElementsByTagName("input")[0].checked;elemModify.appendChild(d)}""!=document.getElementById("input_name").value?DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?elemModify.setAttribute("name",document.getElementById("input_name").value):(b=elemModify.outerHTML,b=b.replace('name="'+elemModify.name+'"',""),b=b.replace("name='"+elemModify.name+"'",""),
b=b.replace("name="+elemModify.name,""),b=b.replace(">",' name="'+document.getElementById("input_name").value+'" >'),elemModify.outerHTML=b):elemModify.removeAttribute("name");var d=document.getElementById("event_table"),e=d.childNodes.length;if(0<e){c=a="";for(b=0;b<e;b++)0!=b&&(a+="\x0B",c+="\x0B"),a+=d.childNodes[b].getElementsByTagName("span")[0].innerHTML,c+=d.childNodes[b].getElementsByTagName("span")[1].innerHTML;""!=a&&(b={type:"event"},b.eventName=a,b.eventFunction=c,LayerWin.setDextCustomData(elemModify,
b))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;event_dext_close()}
function dext_insert_input_textarea(){var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertWidth:"",insertHeight:"",insertAlign:"",insertDisabled:!1,insertReadonly:!1,insertRows:"",insertCols:"",insertWrap:"",insertEventNameArr:[],insertEventFunctionArr:[]};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;
a.insertTitle=document.getElementById("input_title").value;a.insertWidth=document.getElementById("input_width").value;a.insertHeight=document.getElementById("input_height").value;a.insertAlign=document.getElementById("input_textalign").value;a.insertDisabled=document.getElementById("input_disabled").checked;a.insertReadonly=document.getElementById("input_readonly").checked;a.insertRows="0"==document.getElementById("input_rows").value?"":document.getElementById("input_rows").value;a.insertCols="0"==
document.getElementById("input_cols").value?"":document.getElementById("input_cols").value;for(var c=document.getElementById("event_table"),b=c.childNodes.length,d=0;d<b;d++){var e=c.childNodes[d].getElementsByTagName("span");a.insertEventNameArr.push(e[0].innerHTML);a.insertEventFunctionArr.push(e[1].innerHTML)}LayerWin.event_dext_insert_input_textarea(a,window.frameElement.parentNode.parentNode)}
function set_modify_field_input_textarea(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);""!=elemModify.value&&(document.getElementById("input_value").value=elemModify.value);""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=elemModify.title);""!=elemModify.style.width&&(document.getElementById("input_width").value=
parseInt(elemModify.style.width,10));""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10));""!=elemModify.style.textAlign&&(document.getElementById("input_textalign").value=elemModify.style.textAlign);elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);elemModify.readOnly&&(document.getElementById("input_readonly").checked=!0);""!=elemModify.rows&&(document.getElementById("input_rows").value=elemModify.rows);""!=elemModify.cols&&
(document.getElementById("input_cols").value=elemModify.cols);if(elemModify.getAttribute("dext5customdata")){var a=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata"));if("event"==a.type){var c=a.eventFunction,a=a.eventName.split("\x0B"),c=c.split("\x0B"),b=a.length;for(i=0;i<b;i++){var d=document.getElementById("event_table"),e=document.createElement("tr"),f=document.createElement("td");f.className="type2";var g=document.createElement("a"),h=document.createElement("span");h.innerHTML=
a[i];g.appendChild(h);g.title=a[i];h=document.createElement("td");h.className="type2";h.style.width="65%";var l=document.createElement("a"),k=document.createElement("span");k.innerHTML=c[i];l.appendChild(k);l.title=c[i];f.appendChild(g);e.appendChild(f);h.appendChild(l);e.appendChild(h);d.appendChild(e)}}}}
function dext_modify_input_textarea(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();""!=document.getElementById("input_value").value?(elemModify.value=document.getElementById("input_value").value,elemModify.innerHTML=document.getElementById("input_value").value):(elemModify.value="",elemModify.innerHTML="");""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id");
""!=document.getElementById("input_class").value?elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title");""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="";""!=document.getElementById("input_height").value?elemModify.style.height=
document.getElementById("input_height").value+"px":elemModify.style.height="";""!=document.getElementById("input_textalign").value?elemModify.style.textAlign=document.getElementById("input_textalign").value:elemModify.style.textAlign="";elemModify.disabled=document.getElementById("input_disabled").checked;elemModify.readOnly=document.getElementById("input_readonly").checked;""!=document.getElementById("input_rows").value&&"0"!=document.getElementById("input_rows").value?elemModify.rows=document.getElementById("input_rows").value:
elemModify.removeAttribute("rows");""!=document.getElementById("input_cols").value&&"0"!=document.getElementById("input_cols").value?elemModify.cols=document.getElementById("input_cols").value:elemModify.removeAttribute("cols");if(""!=document.getElementById("input_name").value)if(DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie)elemModify.setAttribute("name",document.getElementById("input_name").value);else{var a=elemModify.outerHTML,a=a.replace('name="'+elemModify.name+
'"',""),a=a.replace("name='"+elemModify.name+"'",""),a=a.replace("name="+elemModify.name,""),a=a.replace(">",' name="'+document.getElementById("input_name").value+'" >');elemModify.outerHTML=a}else elemModify.removeAttribute("name");var c=document.getElementById("event_table"),b=c.childNodes.length;if(0<b){for(var d=a="",e=0;e<b;e++)0!=e&&(a+="\x0B",d+="\x0B"),a+=c.childNodes[e].getElementsByTagName("span")[0].innerHTML,d+=c.childNodes[e].getElementsByTagName("span")[1].innerHTML;""!=a&&(c={type:"event"},
c.eventName=a,c.eventFunction=d,LayerWin.setDextCustomData(elemModify,c))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=0;event_dext_close()}
function dext_insert_input_hidden(){var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:""};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;a.insertTitle=document.getElementById("input_title").value;LayerWin.event_dext_insert_input_hidden(a,window.frameElement.parentNode.parentNode)}
function set_modify_field_input_hidden(){var a=elemModify.getAttribute("dext5customdata");null!=a&&void 0!=a&&(a=LayerWin.getDextCustomData(a),""!=a.id&&(document.getElementById("input_id").value=a.id),""!=a.name&&(document.getElementById("input_name").value=a.name),""!=a.value&&(document.getElementById("input_value").value=a.value),""!=a.className&&(document.getElementById("input_class").value=a.className),""!=a.title&&(document.getElementById("input_title").value=a.title))}
function dext_modify_input_hidden(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:""};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;a.insertTitle=document.getElementById("input_title").value;
LayerWin.event_dext_insert_input_hidden(a,window.frameElement.parentNode.parentNode)}
function dext_insert_input_image(){var a=document.dext_upload_form,c;c=""==document.getElementById(file_field_id).value?G_dragDropFileObj&&G_dragDropFileObj[0]?{value:G_dragDropFileObj[0].name,id:document.getElementById(file_field_id).id}:{value:""}:document.getElementById(file_field_id);var b=document.getElementById("img_web_url"),b=document.getElementsByName("InputFlag")[0].checked?c.value:b.value;if(0<b.lastIndexOf(".")){for(var d=b.substring(b.lastIndexOf(".")+1).toLowerCase(),e=!1,f=LayerWin._dext_editor._config.allowImageFileType,
g=f.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,h=f.length,l=0;l<h;l++)if(d==f[l]){e=!0;break}1==e?document.getElementsByName("InputFlag")[0].checked?("0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(d),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),
document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.toSavePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule),document.getElementById("image_convert_format").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_format),
document.getElementById("image_convert_width").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_width),document.getElementById("image_convert_height").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.image_convert_height),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config)))):(document.getElementById("savefileext").value=
d,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=LayerWin._dext_editor._config.toSavePathURL,document.getElementById("savafoldernamerule").value=LayerWin._dext_editor._config.saveFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("image_convert_format").value=
LayerWin._dext_editor._config.image_convert_format,document.getElementById("image_convert_width").value=LayerWin._dext_editor._config.image_convert_width,document.getElementById("image_convert_height").value=LayerWin._dext_editor._config.image_convert_height,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(a=
new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&a.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),a.setItem("document_domain",document.getElementById("document_domain").value),a.setItem("proxy_url",document.getElementById("proxy_url").value),a.setItem("uploadtype",document.getElementById("uploadtype").value),a.setItem("savefilename",document.getElementById("savefilename").value),a.setItem("savefileext",document.getElementById("savefileext").value),
a.setItem("serverdomain",document.getElementById("serverdomain").value),a.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),a.setItem("savafoldernamerule",document.getElementById("savafoldernamerule").value),a.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),a.setItem("image_convert_format",document.getElementById("image_convert_format").value),a.setItem("image_convert_width",document.getElementById("image_convert_width").value),a.setItem("image_convert_height",
document.getElementById("image_convert_height").value),a.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&a.setItem("originalfilename",document.getElementById("originalfilename").value),a.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),addParamHashTable(a),uploadAjaxOnprogressStart({uploadType:"image",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:c.id,fileObj:G_dragDropFileObj,
formData:a},event_dext_input_image_upload_completed)):(a.action=document.getElementById("upload_url").value,a.submit())):event_dext_input_image_upload_completed(b):alert(g)}else alert(LayerWin.dext5_lang.msg.alert_exec)}
function event_dext_input_image_upload_completed(a,c){var b=document.getElementById("input_width").value,d=document.getElementById("input_height").value,e=0,f=0;if(null!=a&&void 0!=a){a=a.replace(/<.*?script.*\/?>/g,"");a=a.replace(/\r\n/g,"");a=a.replace(/\n/g,"");a=a.replace(/\t/g,"");if((a=web_url_remove_char(a))&&""!=a)try{var g;g="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,a):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,
a);null!=g&&void 0!=g&&(a=g)}catch(h){}g=a.split("?");2==g.length&&(a=g[0],g=g[1].split("^"),1==g.length?a+="?"+g[0]:2==g.length?(e=g[0],f=g[1]):3==g.length&&(e=g[0],f=g[1],a+="?"+g[2]));if(elemModify&&"input"==elemModify.tagName.toLowerCase()&&"image"==elemModify.type){elemModify.src=a;return}if("1"==LayerWin._dext_editor._config.image_auto_fit&&e>LayerWin._dext_editor._defaultWidth)g=LayerWin._dext_editor._defaultWidth/e,e=LayerWin._dext_editor._defaultWidth,f*=g;else if("2"==LayerWin._dext_editor._config.image_auto_fit&&
(e>LayerWin._dext_editor._defaultWidth||f>LayerWin._dext_editor._defaultHeight)){b=LayerWin._dext_editor._defaultWidth;d=LayerWin._dext_editor._defaultHeight;g=d/b;var l=f/e;l>g?f>d?b=Math.round(e*d/f):(b=e,d=f):l<g?e>b?d=Math.round(f*b/e):(b=e,d=f):(b=e,d=f)}}0==b.length&&0<e&&(b=parseInt(e),d=parseInt(f));loading_image_show(!1);if("[FAIL]"==a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status")))try{if(0==("function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError?
DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"fileUpload",message:a,response:c.response}):DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"fileUpload",message:a,response:c.response})))return}catch(k){}if("1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status")))e=!0,"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&(e=confirm(LayerWin.dext5_lang.msg.uploadFailed)),e&&(e=a.indexOf("HTTP Error"),
f=a.indexOf("HTTP Status"),-1<e?alert(a.substring(e,e+16)):-1<f&&alert(a.substring(f,f+15)));else if("[FAIL]"==a.substring(0,6))e=!0,"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&(e=confirm(LayerWin.dext5_lang.msg.uploadFailed)),e&&alert(a);else{e={insertName:"",insertValue:"",insertSrc:a,insertId:"",insertClass:"",insertTitle:"",insertAlign:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertType:"image",insertEventNameArr:[],insertEventFunctionArr:[]};e.insertName=
document.getElementById("input_name").value;e.insertValue=document.getElementById("input_value").value;e.insertId=document.getElementById("input_id").value;e.insertClass=document.getElementById("input_class").value;e.insertTitle=document.getElementById("input_title").value;e.insertAlign=document.getElementById("input_textalign").value;e.insertWidth=b;e.insertHeight=d;e.insertDisabled=document.getElementById("input_disabled").checked;f=document.getElementById("event_table");b=f.childNodes.length;for(d=
0;d<b;d++)g=f.childNodes[d].getElementsByTagName("span"),e.insertEventNameArr.push(g[0].innerHTML),e.insertEventFunctionArr.push(g[1].innerHTML);LayerWin.event_dext_insert_input_image(e,window.frameElement.parentNode.parentNode)}}
function set_modify_field_input_image(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value"));""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=
elemModify.title);""!=elemModify.style.textAlign&&(document.getElementById("input_textalign").value=elemModify.align);""==elemModify.style.width.replace("px","")?document.getElementById("input_width").value=parseInt(elemModify.width,10):document.getElementById("input_width").value=elemModify.style.width.replace("px","");""==elemModify.style.height.replace("px","")?document.getElementById("input_height").value=parseInt(elemModify.height,10):document.getElementById("input_height").value=elemModify.style.height.replace("px",
"");elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);var a=elemModify.outerHTML.match(RegExp("srcs*=s*(\"|')(([^\"']*))(\"|')","gi")),c="";a&&0<a.length&&(c=a[0].replace("src=",""),c=c.replace(/\'/g,""),c=c.replace(/\"/g,""),c=c.replace(/\&amp;/g,"&"));document.getElementById("img_web_url").value=c;var b=document.getElementById("img_ratio"),d=document.getElementById("input_width"),e=document.getElementById("input_height"),f,g;f=d.value;g=e.value;d.value=Math.round(f);e.value=
Math.round(g);"1"==LayerWin._dext_editor._config.allowImgSize&&(b.style.display="block",b.className="img_link_active_btn",b.setAttribute("ratio-checked","true"));DEXTTOP.DEXT5.util.addEvent(d,"keyup",function(){if("true"==b.getAttribute("ratio-checked")){var a=parseInt(g,10)*parseInt(d.value,10)/parseInt(f,10);e.value=isNaN(a)?e.value:Math.round(a)}});DEXTTOP.DEXT5.util.addEvent(e,"keyup",function(){if("true"==b.getAttribute("ratio-checked")){var a=parseInt(f,10)*parseInt(e.value,10)/parseInt(g,10);
d.value=isNaN(a)?d.value:Math.round(a)}});if(elemModify.getAttribute("dext5customdata")&&(a=LayerWin.getDextCustomData(elemModify.getAttribute("dext5customdata")),"event"==a.type)){var c=a.eventFunction,a=a.eventName.split("\x0B"),c=c.split("\x0B"),h=a.length;for(i=0;i<h;i++){var l=document.getElementById("event_table"),k=document.createElement("tr"),m=document.createElement("td");m.className="type2";var p=document.createElement("a"),n=document.createElement("span");n.innerHTML=a[i];p.appendChild(n);
p.title=a[i];n=document.createElement("td");n.className="type2";n.style.width="65%";var q=document.createElement("a"),r=document.createElement("span");r.innerHTML=c[i];q.appendChild(r);q.title=c[i];m.appendChild(p);k.appendChild(m);n.appendChild(q);k.appendChild(n);l.appendChild(k)}}"1"==Dext5LayerWin._dext_editor._config.uploadUseHTML5&&(a=document.getElementById("radio_image_url"),document.getElementById("radio_image").removeAttribute("checked"),a.setAttribute("checked","checked"),InputFlag_change(a))}
function dext_modify_input_image(){0<LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount&&LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();var a=document.getElementById(file_field_id);a.value&&""!=a.value&&dext_insert_input_image();a=document.getElementById(file_field_id);a.value&&""!=a.value||"1"==Dext5LayerWin._dext_editor._config.uploadUseHTML5&&G_dragDropFileObj?dext_insert_input_image():(a=document.getElementById("img_web_url"),elemModify.src=a.value);""!=document.getElementById("input_value").value?
elemModify.setAttribute("value",document.getElementById("input_value").value):elemModify.removeAttribute("value");""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id");""!=document.getElementById("input_class").value?elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:
elemModify.removeAttribute("title");""!=document.getElementById("input_textalign").value?elemModify.align=document.getElementById("input_textalign").value:elemModify.removeAttribute("align");""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="";""!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+"px":elemModify.style.height="";elemModify.disabled=
document.getElementById("input_disabled").checked;""!=document.getElementById("input_name").value?DEXTTOP.DEXT5.browser.ie&&8<=DEXTTOP.DEXT5.browser.ieVersion||!DEXTTOP.DEXT5.browser.ie?elemModify.setAttribute("name",document.getElementById("input_name").value):(a=elemModify.outerHTML,a=a.replace('name="'+elemModify.name+'"',""),a=a.replace("name='"+elemModify.name+"'",""),a=a.replace("name="+elemModify.name,""),a=a.replace(">",'name="'+document.getElementById("input_name").value+'" />'),elemModify.outerHTML=
a):elemModify.removeAttribute("name");var c=document.getElementById("event_table"),b=c.childNodes.length;if(0<b){for(var d=a="",e=0;e<b;e++)0!=e&&(a+="\x0B",d+="\x0B"),a+=c.childNodes[e].getElementsByTagName("span")[0].innerHTML,d+=c.childNodes[e].getElementsByTagName("span")[1].innerHTML;""!=a&&(c={type:"event"},c.eventName=a,c.eventFunction=d,LayerWin.setDextCustomData(elemModify,c))}else elemModify.removeAttribute("dext5customdata");LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.putUndo();LayerWin.DEXTTOP.G_CURREDITOR.UndoManager.charCount=
0;event_dext_close()}function event_dext_horizontal_line_cancel(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_image_upload_cancel(){"1"==LayerWin._dext_editor._config.uploadUseHTML5&&"function"==typeof uploadAjaxOnprogressCancel&&uploadAjaxOnprogressCancel();LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode);if("undefined"!=typeof elemModify)try{LayerWin.contentChangeEventWrapper()}catch(a){}}
function event_dext_bg_image_upload_cancel(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_flash_upload_cancel(){clearWindow(window);LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_media_upload_cancel(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_table_cancel(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}
function event_dext_doc_cancel(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_emoticon_cancel(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_about_close(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_close(a){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}
function event_dext_insert_datetime_close(){LayerWin.event_dext_upload_cancel(window.frameElement.parentNode.parentNode)}function event_dext_insert_datetime(a){LayerWin.command_insert_datetime(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,a)}function clearWindow(a){a.document.open("text/html","replace");isCustomDomain()&&(a.document.domain=LayerWin.document.domain);a.document.write("<html><head></head><body></body></html>");a.document.close()}
function isCustomDomain(){if(!DEXTTOP.DEXT5.browser.ie)return!1;var a=LayerWin.document.domain,c=window.location.hostname;return a!=c&&a!="["+c+"]"}
function setCursorPos(a,c,b){null!=a&&void 0!=a&&null==navigator.userAgent.match(/iPhone|iPad/)&&setTimeout(function(){var d=0;a.value&&(d=a.value.length);try{if(0!=d&&0!=c)if("setSelectionRange"in a)b?a.setSelectionRange(0,d):a.setSelectionRange(d,d);else if("createTextRange"in a){var e=a.createTextRange();b||e.moveStart("character",d);e.select()}a.focus()}catch(f){}},0)}
function event_tab(a,c){9==("which"in a?a.which:a.keyCode)&&"last"==(a.target?a.target:a.srcElement).getAttribute("last_cursor_obj")&&(setCursorPos(c,!0,!1),DEXTTOP.DEXT5.util.cancelEvent(a))}
function edgeClick(a,c){LayerWin._dext_editor.applyEdgeMode="user";edgeSelectClick(4,"user");var b=document.getElementById("topcell1"),d=document.getElementById("topcell2"),e=document.getElementById("bottomcell1"),f=document.getElementById("bottomcell2");document.getElementById("edge_top");document.getElementById("edge_horizon");document.getElementById("edge_bottom");document.getElementById("edge_left");document.getElementById("edge_vertical");document.getElementById("edge_right");var g=document.getElementById("edge_"+
a).src.split("/");if(g[g.length-1]=="editor_line_"+a+"_d_img.gif")document.getElementById("edge_"+a).src="../images/editor/dialog/editor_line_"+a+"_img.gif",g="",g=""==document.getElementById("line_kind").value?g+(document.getElementById("line_thickness").value+"px"):g+document.getElementById("line_kind").value,g+=" "+document.getElementById("line_style").style.borderTopStyle,g+=" "+document.getElementById("line_color").style.borderTopColor,"top"==a?(b&&(b.style.borderTop=g,cellRemoveClass(b,"dext_cell_border_t")),
d&&(d.style.borderTop=g,cellRemoveClass(d,"dext_cell_border_t"))):"horizon"==a?(e&&(b.style.borderBottom=g,e.style.borderTop=g,cellRemoveClass(b,"dext_cell_border_b"),cellRemoveClass(e,"dext_cell_border_t")),f&&(d.style.borderBottom=g,f.style.borderTop=g,cellRemoveClass(d,"dext_cell_border_b"),cellRemoveClass(f,"dext_cell_border_t"))):"bottom"==a?e?(e.style.borderBottom=g,cellRemoveClass(e,"dext_cell_border_b"),f&&(f.style.borderBottom=g,cellRemoveClass(f,"dext_cell_border_b"))):(b&&(b.style.borderBottom=
g,cellRemoveClass(b,"dext_cell_border_b")),d&&(d.style.borderBottom=g,cellRemoveClass(d,"dext_cell_border_b"))):"left"==a?(b&&(b.style.borderLeft=g,cellRemoveClass(b,"dext_cell_border_l")),e&&(e.style.borderLeft=g,cellRemoveClass(e,"dext_cell_border_l"))):"vertical"==a?(d&&(b.style.borderRight=g,d.style.borderLeft=g,cellRemoveClass(b,"dext_cell_border_r"),cellRemoveClass(d,"dext_cell_border_l")),f&&(e.style.borderRight=g,f.style.borderLeft=g,cellRemoveClass(e,"dext_cell_border_r"),cellRemoveClass(f,
"dext_cell_border_l"))):"right"==a&&(d?(d.style.borderRight=g,cellRemoveClass(d,"dext_cell_border_r"),f&&(f.style.borderRight=g,cellRemoveClass(f,"dext_cell_border_r"))):(b&&(b.style.borderRight=g,cellRemoveClass(b,"dext_cell_border_r")),e&&(e.style.borderRight=g,cellRemoveClass(e,"dext_cell_border_r"))));else if(g[g.length-1]=="editor_line_"+a+"_img.gif"){document.getElementById("edge_"+a).src="../images/editor/dialog/editor_line_"+a+"_d_img.gif";var h=g="";c||(g="1px solid rgb(0, 0, 0)",h="1px");
"top"==a?(b&&(b.style.borderTop=g,b.style.borderTopWidth=h,c&&cellAddClass(b,"dext_cell_border_t")),d&&(d.style.borderTop=g,d.style.borderTopWidth=h,c&&cellAddClass(d,"dext_cell_border_t"))):"horizon"==a?(e&&(b.style.borderBottom=g,e.style.borderTop=g,b.style.borderBottomWidth=h,e.style.borderTopWidth=h,c&&(cellAddClass(b,"dext_cell_border_b"),cellAddClass(e,"dext_cell_border_t"))),f&&(d.style.borderBottom=g,f.style.borderTop=g,d.style.borderBottomWidth=h,f.style.borderTopWidth=h,c&&(cellAddClass(d,
"dext_cell_border_b"),cellAddClass(f,"dext_cell_border_t")))):"bottom"==a?e?(e.style.borderBottom=g,e.style.borderBottomWidth=h,c&&cellAddClass(e,"dext_cell_border_b"),f&&(f.style.borderBottom=g,f.style.borderBottomWidth=h,c&&cellAddClass(f,"dext_cell_border_b"))):(b&&(b.style.borderBottom=g,b.style.borderBottomWidth=h,c&&cellAddClass(b,"dext_cell_border_b")),d&&(d.style.borderBottom=g,d.style.borderBottomWidth=h,c&&cellAddClass(d,"dext_cell_border_b"))):"left"==a?(b&&(b.style.borderLeft=g,b.style.borderLeftWidth=
h,c&&cellAddClass(b,"dext_cell_border_l")),e&&(e.style.borderLeft=g,e.style.borderLeftWidth=h,c&&cellAddClass(e,"dext_cell_border_l"))):"vertical"==a?(d&&(b.style.borderRight=g,d.style.borderLeft=g,b.style.borderRightWidth=h,d.style.borderLeftWidth=h,c&&(cellAddClass(b,"dext_cell_border_r"),cellAddClass(d,"dext_cell_border_l"))),f&&(e.style.borderRight=g,f.style.borderLeft=g,e.style.borderRightWidth=h,f.style.borderLeftWidth=h,c&&(cellAddClass(e,"dext_cell_border_r"),cellAddClass(f,"dext_cell_border_l")))):
"right"==a&&(d?(d.style.borderRight=g,d.style.borderRightWidth=h,c&&cellAddClass(d,"dext_cell_border_r"),f&&(f.style.borderRight=g,f.style.borderRightWidth=h,c&&cellAddClass(f,"dext_cell_border_r"))):(b&&(b.style.borderRight=g,b.style.borderRightWidth=h,c&&cellAddClass(b,"dext_cell_border_r")),e&&(e.style.borderRight=g,e.style.borderRightWidth=h,c&&cellAddClass(e,"dext_cell_border_r"))))}}
function cellRemoveClass(a,c){var b=a.className+" ",d=new RegExp(c+" ","g");d.test(b)&&(b=LayerWin.DEXTTOP.DEXT5.util.trim(b.replace(d," ")),b=b.replace(/\s{2,}/g," "),a.className=b);""==a.className&&a.removeAttribute("class")}function cellAddClass(a,c){0==(new RegExp(c+" ","g")).test(a.className+" ")&&(a.className+=" "+c)}
function edgeNoneTotalClick(a,c){if("user"!=a){var b="";if(""==document.getElementById("line_kind").value){if(""==document.getElementById("line_thickness").value)return;b+=document.getElementById("line_thickness").value+"px"}else b+=document.getElementById("line_kind").value;var b=b+(" "+document.getElementById("line_style").style.borderTopStyle),b=b+(" "+document.getElementById("line_color").style.borderTopColor),d=document.getElementById("topcell1"),e=document.getElementById("topcell2"),f=document.getElementById("bottomcell1"),
g=document.getElementById("bottomcell2"),h=document.getElementById("edge_top"),l=document.getElementById("edge_horizon"),k=document.getElementById("edge_bottom"),m=document.getElementById("edge_left"),p=document.getElementById("edge_vertical"),n=document.getElementById("edge_right");"total"==a?(h&&(h.src="../images/editor/dialog/editor_line_top_img.gif"),l&&(l.src="../images/editor/dialog/editor_line_horizon_img.gif"),k&&(k.src="../images/editor/dialog/editor_line_bottom_img.gif"),m&&(m.src="../images/editor/dialog/editor_line_left_img.gif"),
p&&(p.src="../images/editor/dialog/editor_line_vertical_img.gif"),n&&(n.src="../images/editor/dialog/editor_line_right_img.gif"),d&&(d.style.borderTop=b,d.style.borderBottom=b,d.style.borderRight=b,d.style.borderLeft=b,cellRemoveClass(d,"dext_cell_border_l"),cellRemoveClass(d,"dext_cell_border_r"),cellRemoveClass(d,"dext_cell_border_t"),cellRemoveClass(d,"dext_cell_border_b")),e&&(e.style.borderTop=b,e.style.borderLeft=b,e.style.borderRight=b,e.style.borderBottom=b,cellRemoveClass(e,"dext_cell_border_l"),
cellRemoveClass(e,"dext_cell_border_r"),cellRemoveClass(e,"dext_cell_border_t"),cellRemoveClass(e,"dext_cell_border_b")),f&&(f.style.borderTop=b,f.style.borderBottom=b,f.style.borderRight=b,f.style.borderLeft=b,cellRemoveClass(f,"dext_cell_border_l"),cellRemoveClass(f,"dext_cell_border_r"),cellRemoveClass(f,"dext_cell_border_t"),cellRemoveClass(f,"dext_cell_border_b")),g&&(g.style.borderTop=b,g.style.borderLeft=b,g.style.borderRight=b,g.style.borderBottom=b,cellRemoveClass(g,"dext_cell_border_l"),
cellRemoveClass(g,"dext_cell_border_r"),cellRemoveClass(g,"dext_cell_border_t"),cellRemoveClass(g,"dext_cell_border_b"))):"inside"==a?(h&&(h.src="../images/editor/dialog/editor_line_top_img.gif",edgeClick("top",c)),k&&(k.src="../images/editor/dialog/editor_line_bottom_img.gif",edgeClick("bottom",c)),m&&(m.src="../images/editor/dialog/editor_line_left_img.gif",edgeClick("left",c)),n&&(n.src="../images/editor/dialog/editor_line_right_img.gif",edgeClick("right",c)),edgeSelectClick(2,"inside"),l&&(l.src=
"../images/editor/dialog/editor_line_horizon_img.gif"),p&&(p.src="../images/editor/dialog/editor_line_vertical_img.gif"),d&&e&&(d.style.borderRight=b,e.style.borderLeft=b,cellRemoveClass(d,"dext_cell_border_r"),cellRemoveClass(e,"dext_cell_border_l")),f&&g&&(f.style.borderRight=b,g.style.borderLeft=b,cellRemoveClass(f,"dext_cell_border_r"),cellRemoveClass(g,"dext_cell_border_l")),d&&f&&(d.style.borderBottom=b,f.style.borderTop=b,cellRemoveClass(d,"dext_cell_border_b"),cellRemoveClass(f,"dext_cell_border_t")),
e&&g&&(e.style.borderBottom=b,g.style.borderTop=b,cellRemoveClass(e,"dext_cell_border_b"),cellRemoveClass(g,"dext_cell_border_t"))):"outside"==a?(l&&(l.src="../images/editor/dialog/editor_line_horizon_img.gif",edgeClick("horizon",c)),p&&(p.src="../images/editor/dialog/editor_line_vertical_img.gif",edgeClick("vertical",c)),edgeSelectClick(1,"outside"),h&&(h.src="../images/editor/dialog/editor_line_top_img.gif"),k&&(k.src="../images/editor/dialog/editor_line_bottom_img.gif"),m&&(m.src="../images/editor/dialog/editor_line_left_img.gif"),
n&&(n.src="../images/editor/dialog/editor_line_right_img.gif"),d&&e?(d.style.borderTop=b,d.style.borderLeft=b,e.style.borderTop=b,e.style.borderRight=b,cellRemoveClass(d,"dext_cell_border_t"),cellRemoveClass(d,"dext_cell_border_l"),cellRemoveClass(e,"dext_cell_border_t"),cellRemoveClass(e,"dext_cell_border_r")):d&&(d.style.borderTop=b,d.style.borderLeft=b,d.style.borderRight=b,cellRemoveClass(d,"dext_cell_border_t"),cellRemoveClass(d,"dext_cell_border_l"),cellRemoveClass(d,"dext_cell_border_r")),
f&&g?(f.style.borderLeft=b,f.style.borderBottom=b,g.style.borderRight=b,g.style.borderBottom=b,cellRemoveClass(f,"dext_cell_border_l"),cellRemoveClass(f,"dext_cell_border_b"),cellRemoveClass(g,"dext_cell_border_r"),cellRemoveClass(g,"dext_cell_border_b")):f?(f.style.borderLeft=b,f.style.borderRight=b,f.style.borderBottom=b,cellRemoveClass(f,"dext_cell_border_l"),cellRemoveClass(f,"dext_cell_border_r"),cellRemoveClass(f,"dext_cell_border_b")):(d&&(d.style.borderBottom=b,cellRemoveClass(d,"dext_cell_border_b")),
e&&(e.style.borderBottom=b,cellRemoveClass(e,"dext_cell_border_b")))):"none"==a&&(h&&(h.src="../images/editor/dialog/editor_line_top_d_img.gif"),l&&(l.src="../images/editor/dialog/editor_line_horizon_d_img.gif"),k&&(k.src="../images/editor/dialog/editor_line_bottom_d_img.gif"),m&&(m.src="../images/editor/dialog/editor_line_left_d_img.gif"),p&&(p.src="../images/editor/dialog/editor_line_vertical_d_img.gif"),n&&(n.src="../images/editor/dialog/editor_line_right_d_img.gif"),d&&(d.className="dext_cell_border_t dext_cell_border_l dext_cell_border_r dext_cell_border_b"),
e&&(e.className="dext_cell_border_t dext_cell_border_l dext_cell_border_r dext_cell_border_b"),f&&(f.className="dext_cell_border_t dext_cell_border_l dext_cell_border_r dext_cell_border_b"),g&&(g.className="dext_cell_border_t dext_cell_border_l dext_cell_border_r dext_cell_border_b"))}}function fnLineStyleToggle(){var a=document.getElementById("line_style_list");a.style.display="none"==a.style.display?"block":"none"}
function lineStyleChange(){var a=document.getElementById("line_style"),c=document.getElementById("line_thickness");if("hidden"==a.style.borderTopStyle||"none"==a.style.borderTopStyle)c.value="0";else if("solid"!=a.style.borderTopStyle&&"dotted"!=a.style.borderTopStyle&&"dashed"!=a.style.borderTopStyle&&"hidden"!=a.style.borderTopStyle&&"none"!=a.style.borderTopStyle){if(isNaN(parseInt(c.value,10))||3>parseInt(c.value,10))c.value="3"}else if(isNaN(parseInt(c.value,10))||0>=parseInt(c.value,10))c.value=
"1";edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}function lineKindChange(){var a=document.getElementById("line_kind"),c=document.getElementById("line_thickness"),b=document.getElementById("line_thickness_updn_btn");""!=a.value?(c.disabled=!0,b.style.display="none","medium"==a.value?c.value="3":"thin"==a.value?c.value="1":"thick"==a.value&&(c.value="5")):(c.disabled=!1,b.style.display="block");edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}
function imgLineKindChange(){var a=document.getElementById("line_kind"),c=document.getElementById("line_thickness"),b=document.getElementById("line_thickness_updn_btn");""!=a.value?(c.disabled=!0,c.value="",b.style.display="none"):(c.disabled=!1,b.style.display="block")}function lineThicknessChange(){var a=document.getElementById("line_thickness");10<a.value&&(a.value=10);edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}
function cellGapChange(){var a=document.getElementById("cell_gap");10<a.value&&(a.value=10);edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}function insideMarginChange(){var a=document.getElementById("cell_inside_margin");10<a.value&&(a.value=10);edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}function tableEdgeReduceChange(){edgeNoneTotalClick(LayerWin._dext_editor.applyEdgeMode)}
function getColorHex(a){return-1<a.indexOf("#")?a:LayerWin.DEXTTOP.DEXT5.util.rgb2hex(a)?LayerWin.DEXTTOP.DEXT5.util.rgb2hex(a):"#000000"}
function setLineStyleEvt(){var a=document.getElementById("ul_line_style");LayerWin.DEXTTOP.DEXT5.util.addEvent(a,"click",function(a){var b=document.getElementById("line_style");a=LayerWin.getClickCell(a,"li").getElementsByTagName("SPAN")[0];b.style.border="";"solid"==a.style.borderTopStyle||"dotted"==a.style.borderTopStyle||"dashed"==a.style.borderTopStyle||"double"==a.style.borderTopStyle||"hidden"==a.style.borderTopStyle||"none"==a.style.borderTopStyle?b.style.borderTop=a.style.borderTop:b.style.border=
a.style.border;fnLineStyleToggle();setCursorPos(document.getElementById("line_style_btn"),!1,!1);lineStyleChange()})}
function setCellBorderModifyValue(a){var c=LayerWin.DEXTTOP.G_SELECTED_ELEMENT;if(a){a=LayerWin.GetTableSelectionCells(c);for(var c=a.length,b=!0,d=0;d<c-1;d++){if(a[d].style.borderTopStyle!=a[d+1].style.borderTopStyle||a[d].style.borderTopWidth!=a[d+1].style.borderTopWidth||a[d].style.borderTopColor!=a[d+1].style.borderTopColor){b=!1;break}if(a[d].style.borderRightStyle!=a[d+1].style.borderRightStyle||a[d].style.borderRightWidth!=a[d+1].style.borderRightWidth||a[d].style.borderRightColor!=a[d+1].style.borderRightColor){b=
!1;break}if(a[d].style.borderBottomStyle!=a[d+1].style.borderBottomStyle||a[d].style.borderBottomWidth!=a[d+1].style.borderBottomWidth||a[d].style.borderBottomColor!=a[d+1].style.borderBottomColor){b=!1;break}if(a[d].style.borderLeftStyle!=a[d+1].style.borderLeftStyle||a[d].style.borderLeftWidth!=a[d+1].style.borderLeftWidth||a[d].style.borderLeftColor!=a[d+1].style.borderLeftColor){b=!1;break}}b?setModifyValue(a[0].style,!0):setModifyValue(null)}else setModifyValue(c.style,!0)}
function setTableBorderModifyValue(a){if("separate"==a.style.borderCollapse)setModifyValue(a.style,!0);else{var c=!0,b=!0,d=!0,e=!0,f,g,h,l;a=LayerWin.getTableBorderCells(a);var k=a.arrTop.length;if(1==k)f=a.arrTop[0].style.borderTop;else for(var m=0;m<k;m++)0!=m&&(a.arrTop[m-1].style.borderTop!=a.arrTop[m].style.borderTop&&(c=!1),m==k-1&&c&&(f=a.arrTop[m].style.borderTop));k=a.arrLeft.length;if(1==k)h=a.arrLeft[0].style.borderLeft;else for(m=0;m<k;m++)0!=m&&(a.arrLeft[m-1].style.borderLeft!=a.arrLeft[m].style.borderLeft&&
(e=!1),m==k-1&&e&&(h=a.arrLeft[m].style.borderLeft));k=a.arrRight.length;if(1==k)l=a.arrRight[0].style.borderRight;else for(m=0;m<k;m++)0!=m&&(a.arrRight[m-1].style.borderRight!=a.arrRight[m].style.borderRight&&(d=!1),m==k-1&&d&&(l=a.arrRight[m].style.borderRight));k=a.arrBottom.length;if(1==k)g=a.arrBottom[0].style.borderBottom;else for(m=0;m<k;m++)0!=m&&(a.arrBottom[m-1].style.borderBottom!=a.arrBottom[m].style.borderBottom&&(b=!1),m==k-1&&b&&(g=a.arrBottom[m].style.borderBottom));a=document.createElement("td");
a.style.borderTop=f?f:"1px solid #000000";a.style.borderBottom=g?g:"1px solid #000000";a.style.borderLeft=h?h:"1px solid #000000";a.style.borderRight=l?l:"1px solid #000000";f=!1;a.style.borderTop==a.style.borderRight&&a.style.borderRight==a.style.borderBottom&&a.style.borderBottom==a.style.borderLeft&&c&&b&&d&&e&&(f=!0);setModifyValue(a.style,f)}}
function setModifyValue(a,c){if(a){var b=c,d,e,f,g;d=a.borderTopWidth;e=a.borderBottomWidth;f=a.borderRightWidth;g=a.borderLeftWidth;d==e&&e==f&&f==g?-1<d.indexOf("px")?document.getElementById("line_thickness").value=parseInt(d,10):document.getElementById("line_kind").value=d:(document.getElementById("line_thickness").value="1",document.getElementById("line_kind").value="");d+=" ";e+=" ";f+=" ";g+=" ";a.borderTopStyle==a.borderRightStyle&&a.borderRightStyle==a.borderLeftStyle&&a.borderLeftStyle==
a.borderBottomStyle?("solid"==a.borderStyle||"dotted"==a.borderStyle||"dashed"==a.borderStyle||"double"==a.borderStyle||"hidden"==a.borderStyle||"none"==a.borderStyle?document.getElementById("line_style").style.borderTopStyle=a.borderStyle:document.getElementById("line_style").style.borderStyle=a.borderStyle,"solid"!=a.borderTopStyle&&"dotted"!=a.borderTopStyle&&"dashed"!=a.borderTopStyle&&"hidden"!=a.borderTopStyle&&"none"!=a.borderTopStyle?(document.getElementById("line_style").style.borderWidth=
"3px","double"==a.borderTopStyle?document.getElementById("line_style").style.borderColor="#5d5d5d":document.getElementById("line_style").style.borderColor="#e1e1e1"):(document.getElementById("line_style").style.borderTopWidth="1px",document.getElementById("line_style").style.borderTopColor="#5d5d5d")):(document.getElementById("line_style").style.borderTopStyle="none",b=!1);d+=a.borderTopStyle+" ";e+=a.borderBottomStyle+" ";f+=a.borderRightStyle+" ";g+=a.borderLeftStyle+" ";var h=getColorHex(a.borderTopColor),
l=getColorHex(a.borderBottomColor),k=getColorHex(a.borderRightColor),m=getColorHex(a.borderLeftColor);h==l&&l==k&&k==m&&(document.getElementById("line_color").style.borderTopColor=h);d+=h;e+=l;f+=k;g+=m;document.getElementById("edge_border").style.borderTop=d;document.getElementById("edge_border").style.borderBottom=e;document.getElementById("edge_border").style.borderRight=f;document.getElementById("edge_border").style.borderLeft=g;b||edgeNoneTotalClick("none")}else document.getElementById("line_style").style.borderTopStyle=
"none",edgeNoneTotalClick("none")}function setLayout(a){a=a.replace("te","");a={num:a};0==LayerWin.DEXTTOP.DEXT5.isEmpty()?1==confirm(LayerWin.dext5_lang.msg.newDocument)&&LayerWin.event_dext_layout(a,window.frameElement.parentNode.parentNode):LayerWin.event_dext_layout(a,window.frameElement.parentNode.parentNode)}
function event_dext_file_upload_completed(a,c){loading_image_show(!1);if(a&&""!=a){a=a.replace(/<.*?script.*\/?>/g,"");a=a.replace(/\r\n/g,"");a=a.replace(/\n/g,"");a=a.replace(/\t/g,"");a=web_url_remove_char(a);try{var b;b="function"==typeof DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl?DEXTTOP.G_CURREDITOR._config.event.beforeInsertUrl(DEXTTOP.G_CURREDITOR.ID,a):DEXTTOP.DEXTWIN.dext_editor_before_insert_url_event(DEXTTOP.G_CURREDITOR.ID,a);null!=b&&void 0!=b&&(a=b)}catch(d){}}if("[FAIL]"==
a.substring(0,6)||"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status")))try{if(0==("function"==typeof DEXTTOP.G_CURREDITOR._config.event.onError?DEXTTOP.G_CURREDITOR._config.event.onError(DEXTTOP.G_CURREDITOR.ID,{type:"fileUpload",message:a,response:c.response}):DEXTTOP.DEXTWIN.dext_editor_on_error_event(DEXTTOP.G_CURREDITOR.ID,{type:"fileUpload",message:a,response:c.response})))return}catch(e){}if("1"!=LayerWin._dext_editor._config.uploadUseHTML5&&
(-1<a.indexOf("HTTP Error")||-1<a.indexOf("HTTP Status"))){if(b=!0,"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&(b=confirm(LayerWin.dext5_lang.msg.uploadFailed)),b){b=a.indexOf("HTTP Error");var f=a.indexOf("HTTP Status");-1<b?alert(a.substring(b,b+16)):-1<f&&alert(a.substring(f,f+15))}}else if("[FAIL]"==a.substring(0,6))b=!0,"1"!=LayerWin.DEXTTOP.G_CURREDITOR._config.disableErrorConfirmMessage&&(b=confirm(LayerWin.dext5_lang.msg.uploadFailed)),b&&alert(a);else{b=document.getElementById("file_title").value;
var g=document.getElementById("file_text").value;"0"!=LayerWin._dext_editor._config.security.encryptParam&&(g=DEXTTOP.DEXT5.util.makeDecryptReponseMessageFinal(g));var f=document.getElementById("input_id").value,h=document.getElementById("input_class").value;if(""==g)var l=document.getElementById(file_field_id).value,g=getFileName(l);l=a;if(null!=a&void 0!=a){var k=a.split("?");2==k.length&&(l=k[0],k=k[1].split("^"),1==k.length?l+="?"+k[0]:3==k.length&&(l+="?"+k[2]));""==g&&(g=l.split("/"),g=g[g.length-
1])}k=l.substring(l.lastIndexOf(".")+1).toLowerCase();k=k.toLowerCase();LayerWin.insertElementsSrc(DEXTTOP.G_CURREDITOR,l);var m=!1;document.getElementById("continue_insert")&&(m=document.getElementById("continue_insert").checked);b={text:g,url:l,target:"_blank",title:b,type:"hyperlink",type2:"insert_file",file_ext:k,id:f,className:h,continueInsert:m};elemModify&&"a"==elemModify.tagName.toLowerCase()?(elemModify.innerHTML=b.text,elemModify.title=b.title,elemModify.id=b.id,elemModify.className=b.className,
elemModify.href=b.url,"1"==LayerWin._dext_editor._config.attachFileImage&&LayerWin.attachFileImage(elemModify,b),LayerWin._dext_editor.UndoManager.putUndo(),event_dext_close()):LayerWin.event_dext_insert_file(b,window.frameElement.parentNode.parentNode)}}
function dext_upload_file(){var a=document.dext_upload_form,c;c=""==document.getElementById(file_field_id).value?G_dragDropFileObj&&G_dragDropFileObj[0]?{value:G_dragDropFileObj[0].name,id:document.getElementById(file_field_id).id}:{value:""}:document.getElementById(file_field_id);var b=c.value;if(0<b.lastIndexOf(".")){for(var d=b.substring(b.lastIndexOf(".")+1).toLowerCase(),e=!1,f=LayerWin._dext_editor._config.allowInsertFileType,g=f.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,h=f.length,
l=0;l<h;l++)if(d==f[l]){e=!0;break}f=document.getElementById("file_text_view").value;1==e?("0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(d),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*Math.random()).toString()),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),document.getElementById("tosavepathurl").value=
DEXTTOP.DEXT5.util.makeEncryptParamFinal(""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule),document.getElementById("savafilenamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule),
document.getElementById("savafiletext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(f),document.getElementById("file_text").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(f),document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config)))):(document.getElementById("savefileext").value=d,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),
document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL,document.getElementById("savafoldernamerule").value=""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule,document.getElementById("savafilenamerule").value=
LayerWin._dext_editor._config.saveFileNameRule,document.getElementById("savafiletext").value=f,document.getElementById("file_text").value=f,document.getElementById("originalfilename")&&(document.getElementById("originalfilename").value=LayerWin.getUploadOriginalFileName(b,LayerWin._dext_editor._config))),loading_image_show(!0),"1"==LayerWin._dext_editor._config.uploadUseHTML5?(a=new DEXTTOP.DEXT5.util.hashTable,"0"!=LayerWin._dext_editor._config.security.encryptParam&&a.setItem("pe",LayerWin._dext_editor._config.security.encryptParam),
a.setItem("document_domain",document.getElementById("document_domain").value),a.setItem("proxy_url",document.getElementById("proxy_url").value),a.setItem("uploadtype",document.getElementById("uploadtype").value),a.setItem("savefilename",document.getElementById("savefilename").value),a.setItem("savefileext",document.getElementById("savefileext").value),a.setItem("serverdomain",document.getElementById("serverdomain").value),a.setItem("tosavepathurl",document.getElementById("tosavepathurl").value),a.setItem("savafoldernamerule",
document.getElementById("savafoldernamerule").value),a.setItem("savafilenamerule",document.getElementById("savafilenamerule").value),a.setItem("savafiletext",document.getElementById("savafiletext").value),a.setItem("cd",document.getElementById("cd").value),document.getElementById("originalfilename").value&&a.setItem("originalfilename",document.getElementById("originalfilename").value),a.setItem(LayerWin._dext_editor._config.userFieldID,document.getElementById(LayerWin._dext_editor._config.userFieldID).value),
addParamHashTable(a),uploadAjaxOnprogressStart({uploadType:"insert_file",handlerUrl:LayerWin._dext_editor._config.post_url,fileID:c.id,fileObj:G_dragDropFileObj,formData:a},event_dext_file_upload_completed)):(a.action=document.getElementById("upload_url").value,a.submit())):alert(g)}else""!=b?alert(LayerWin.dext5_lang.msg.alert_exec):alert(LayerWin.dext5_lang.msg.alert_no_file)}function getFileName(a){var c="";if(a&&0<a.length)return c=a,a=a.split("\\"),0<a.length&&(c=a[a.length-1]),c}
function htmlSpecialChars(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;")}
function dext_upload_open_file(){var a=document.dext_upload_form,c=document.getElementById(file_field_id),b=c.value;if(0<b.lastIndexOf(".")){for(var b=b.substring(b.lastIndexOf(".")+1).toLowerCase(),d=!1,e=["htm","html","txt"],f=e.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,g=e.length,h=0;h<g;h++)if(b==e[h]){d=!0;break}if(1==d){if(0!=DEXTTOP.DEXT5.isEmpty()||0!=confirm(LayerWin.dext5_lang.msg.newDocument))"1"==LayerWin._dext_editor._config.openDocument.useHtml5FileOpen?(loading_image_show(!0),
handleFileSelect(c.files)):(c=DEXTTOP.DEXT5.util.makeGuid().toLowerCase(),"0"!=LayerWin._dext_editor._config.security.encryptParam?(document.getElementById("savefileext").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(b),document.getElementById("savefilename").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(Math.floor(99999*Math.random()).toString()),document.getElementById("savefileguid").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(c),document.getElementById("serverdomain").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.serverDomain),
document.getElementById("tosavepathurl").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:LayerWin._dext_editor._config.toSaveFilePathURL),document.getElementById("savafoldernamerule").value=DEXTTOP.DEXT5.util.makeEncryptParamFinal(""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule),document.getElementById("savafilenamerule").value=
DEXTTOP.DEXT5.util.makeEncryptParamFinal(LayerWin._dext_editor._config.saveFileNameRule)):(document.getElementById("savefileext").value=b,document.getElementById("savefilename").value=Math.floor(99999*Math.random()).toString(),document.getElementById("savefileguid").value=c,document.getElementById("serverdomain").value=LayerWin._dext_editor._config.serverDomain,document.getElementById("tosavepathurl").value=""==LayerWin._dext_editor._config.toSaveFilePathURL?LayerWin._dext_editor._config.toSavePathURL:
LayerWin._dext_editor._config.toSaveFilePathURL,document.getElementById("savafoldernamerule").value=""==LayerWin._dext_editor._config.saveFileFolderNameRule?LayerWin._dext_editor._config.saveFolderNameRule:LayerWin._dext_editor._config.saveFileFolderNameRule,document.getElementById("savafilenamerule").value=LayerWin._dext_editor._config.saveFileNameRule),loading_image_show(!0),a.action=document.getElementById("upload_url").value,a.submit())}else alert(f)}else alert(LayerWin.dext5_lang.msg.alert_exec)}
function event_dext_open_file_upload_completed(a){var c=document.getElementById(file_field_id).value;a={fileExt:c.substring(c.lastIndexOf(".")+1).toLowerCase(),data:a};LayerWin.event_dext_insert_open_file(a,window.frameElement.parentNode.parentNode)}function dext_blockquote(){var a={tagvalue:document.getElementById("tempblockquote").value};LayerWin.event_dext_insert_blockquote(a,window.frameElement.parentNode.parentNode)}
function dext_blockquoteCancel(){LayerWin.event_dext_cancel_blockquote(window.frameElement.parentNode.parentNode)}
function dext_setAccessibility(a,c){var b=document.getElementById("input_title").value,d=document.getElementById("input_alt").value,e=document.getElementById("chk_skip").checked,f=document.getElementById("input_id").value,g;c.parentNode.cells[1].getElementsByTagName("span")[2]&&(g=c.parentNode.cells[1].getElementsByTagName("span")[2].innerHTML);var h=!1;""==document.getElementById("id_tr").style.display&&(h=!0);LayerWin.event_dext_setAccessibility({title:b,alt:d,skip:e,id:f,idSamMode:h,sameOrgId:g},
a,c)}
function fileOnchange(a,c){var b=LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo;b.validData={isFile:!1,isDragDropFile:!1,isLastIdx:!1,fileIdx:0,fileTotalCnt:0,valiedCnt:0,errorFileIdx:[],sizeErrorFile:[],base64CntErrorFile:[],extensionErrorFile:[],detectErrorFile:[]};if(DEXTTOP.DEXT5.browser.HTML5Supported&&"0"!=LayerWin.DEXTTOP.G_CURREDITOR._config.uploadUseHTML5){if(!(event&event.target&&"Filedata"==event.target.id)||a&&a.files&&0<a.files.length){var d=a&&a.files&&0<a.files.length,e=G_dragDropFileObj&&0<
G_dragDropFileObj.length,f=1==LayerWin.DEXTTOP.G_CURREDITOR._config.insertMultiImage,g=1;"image"==c&&(g=d?a.files.length:e?G_dragDropFileObj.length:0);b.isMulti="image"==c&&f&&1<g;if(d||e){b.validData.isFile=d;b.validData.isDragDropFile=e;b.validData.fileTotalCnt=g;var h=d?a.files:e?G_dragDropFileObj:null;c&&d&&"1"==LayerWin._dext_editor._config.uploadUseHTML5&&(G_dragDropFileObj=a.files);var l=document.getElementById("img_title"),k=document.getElementById("img_alt"),m=document.getElementById("img_id"),
p=document.getElementById("img_class"),e=document.getElementById("img_width"),n=document.getElementById("img_height"),q=document.getElementById("continue_insert"),r=document.getElementById("image_spacing"),v=document.getElementById("continue_insert_menu"),A=document.getElementById("original_size"),z=document.getElementById("maintain_value");"image"==c&&(l&&(l.disabled=!1,l.value=""),k&&(k.disabled=!1,k.value=""),m&&(m.disabled=!1,m.value=""),p&&(p.disabled=!1,p.value=""),e&&(e.value=""),n&&(n.value=
""),A&&(A.checked=!1),q&&(q.parentElement.style.display=""),z&&(z.parentElement.style.display=""));var y="",B=function(){b.validData.valiedCnt+=1;if(0==b.validData.errorFileIdx.length||0<b.validData.errorFileIdx.length&&b.validData.fileIdx!=b.validData.errorFileIdx[b.validData.errorFileIdx.length-1])y=-1<y.indexOf(",")?y+(", "+h[b.validData.fileIdx].name):","+h[b.validData.fileIdx].name;if(f&&b.validData.fileTotalCnt!=b.validData.valiedCnt)b.validData.fileIdx+=1,b.validData.isLastIdx=b.validData.fileIdx==
g-1,fileValidation(h[b.validData.fileIdx],c,B);else{loading_image_show(!1);var e=b.validData.valiedCnt-b.validData.errorFileIdx.length;0<e&&document.getElementById("drop_zone")&&(1<e?document.getElementById("drop_zone").innerHTML=LayerWin.dext5_lang.msg.multi_file_cnt.replace("{0}",e.toString()):document.getElementById("drop_zone").innerHTML=y.substring(1),document.getElementById("drop_zone").className="DEXT_fiVe_ED_Popup_DropZoneNoneBackground");b.isMulti=1<e;"image"==c&&b.isMulti?(l.disabled=!0,
k.disabled=!0,m.disabled=!0,p.disabled=!0,q.parentElement.style.display="none",v.style.display="",z.parentElement.style.display="none",r.checked=!1,q.checked=!1):null!=k&&(k.value=LayerWin.getFileName(y.substring(1),!0));b.validData.fileTotalCnt==b.validData.errorFileIdx.length&&(G_dragDropFileObj=null,d&&(a.value=null));0<b.validData.errorFileIdx.length&&(e=makeErrorContent(),alert(e))}};h&&(loading_image_show(!0),fileValidation(h[b.validData.fileIdx],c,B))}}}else fileValidation(null,c,null)}
function makeErrorContent(){var a=LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo.validData,c="",b=LayerWin.dext5_lang.msg.multi_file_validation_error;if(0<a.sizeErrorFile.length)if(1==a.sizeErrorFile.length)c+=a.sizeErrorFile[0].filename+" : "+a.sizeErrorFile[0].content+"\n";else var d=b.replace("{0}",a.sizeErrorFile[0].filename),d=d.replace("{1}",(a.sizeErrorFile.length-1).toString()),c=c+(d+a.sizeErrorFile[0].content+"\n");0<a.base64CntErrorFile.length&&(1==a.base64CntErrorFile.length?c+=a.base64CntErrorFile[0].filename+
" : "+a.base64CntErrorFile[0].content+"\n":(d=b.replace("{0}",a.base64CntErrorFile[0].filename),d=d.replace("{1}",(a.base64CntErrorFile.length-1).toString()),c+=d+a.base64CntErrorFile[0].content+"\n"));0<a.extensionErrorFile.length&&(1==a.extensionErrorFile.length?c+=a.extensionErrorFile[0].filename+" : "+a.extensionErrorFile[0].content+"\n":(d=b.replace("{0}",a.extensionErrorFile[0].filename),d=d.replace("{1}",(a.extensionErrorFile.length-1).toString()),c+=d+a.extensionErrorFile[0].content+"\n"));
0<a.detectErrorFile.length&&(1==a.detectErrorFile.length?c+=a.detectErrorFile[0].filename+" : "+a.detectErrorFile[0].content+"\n":(d=b.replace("{0}",a.detectErrorFile[0].filename),d=d.replace("{1}",(a.detectErrorFile.length-1).toString()),c+=d+a.detectErrorFile[0].content+"\n"));return c}
function fileValidation(a,c,b){var d=LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo.validData,e=LayerWin.DEXTTOP.G_CURREDITOR.imageFileInfo.isMulti;if(c&&a&&DEXTTOP.DEXT5.browser.HTML5Supported){var f=!1,g=LayerWin.dext5_lang.msg.max_file_size,h=a.size;("image"==c||"m_image"==c||"cell_bg_image"==c||"doc_bg_image"==c||"hyperlink_image"==c||"input_image"==c||"table_bg_image"==c||"p_table_bg_image"==c)&&0!=LayerWin._dext_editor._config.maxImageFileSize&&h>LayerWin._dext_editor._config.maxImageFileSize?
(g=g.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(LayerWin._dext_editor._config.maxImageFileSize).toString),f=!0):"media"==c&&0!=LayerWin._dext_editor._config.maxMediaFileSize&&h>LayerWin._dext_editor._config.maxMediaFileSize?(g=g.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(LayerWin._dext_editor._config.maxMediaFileSize).toString),f=!0):"flash"==c&&0!=LayerWin._dext_editor._config.maxFlashFileSize&&h>LayerWin._dext_editor._config.maxFlashFileSize?(g=g.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(LayerWin._dext_editor._config.maxFlashFileSize).toString),
f=!0):"insert_file"==c&&0!=LayerWin._dext_editor._config.maxInsertFileSize&&h>LayerWin._dext_editor._config.maxInsertFileSize?(g=g.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(LayerWin._dext_editor._config.maxInsertFileSize).toString),f=!0):"video_media"==c&&0!=LayerWin._dext_editor._config.maxVideoFileSize&&h>LayerWin._dext_editor._config.maxVideoFileSize&&(g=g.replace("{0}",DEXTTOP.DEXT5.util.bytesToSize(LayerWin._dext_editor._config.maxVideoFileSize).toString),f=!0);if(f)return d.errorFileIdx.push(d.fileIdx),
errorData={filename:a.name,content:g},d.sizeErrorFile.push(errorData),e||("1"==LayerWin._dext_editor._config.uploadUseHTML5?1==DEXTTOP.DEXT5.browser.mobile?document.getElementById("drop_zone").innerHTML=LayerWin.dext5_lang.upload.drop_zone_content2:document.getElementById("drop_zone").innerHTML=LayerWin.dext5_lang.upload.drop_zone_content:document.getElementById("image_url").value=""),b()}fileDataObj=a&&"image"==c?a:document.getElementById(LayerWin._dext_editor._config.fileFieldID);f="";fileDataObj&&
(fileDataObj&&(fileDataObj.name||fileDataObj.value)?"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&"insert_file"!=c||void 0==c||(f=fileDataObj.value?getFileName(fileDataObj.value):fileDataObj.name,document.getElementById("file_text").value=f,document.getElementById("file_text_view")&&(document.getElementById("file_text_view").value=f),document.getElementById("input_text")&&(document.getElementById("input_text").value=f)):"1"!=LayerWin._dext_editor._config.uploadUseHTML5&&"insert_file"==c&&(DEXTTOP.DEXT5.browser.chrome||
DEXTTOP.DEXT5.browser.opera)?document.getElementById("file_text").value="":"1"==LayerWin._dext_editor._config.uploadUseHTML5&&d.isDragDropFile&&(f=a.name,document.getElementById("file_text").value=f,document.getElementById("input_text")&&(document.getElementById("input_text").value=f)));if("image"==c||"m_image"==c){""==f&&(f=getFileName(fileDataObj.value));for(var g=f.substring(f.lastIndexOf(".")+1).toLowerCase(),h=!1,l=LayerWin._dext_editor._config.allowImageFileType,k=l.toString()+LayerWin.dext5_lang.msg.alert_exec_tail,
m=l.length,p=0;p<m;p++)if(g==l[p]){h=!0;break}if(!h){if(DEXTTOP.DEXT5.browser.HTML5Supported)return d.errorFileIdx.push(d.fileIdx),errorData={filename:f,content:k},d.extensionErrorFile.push(errorData),b();alert(k);d.errorFileIdx.push(0);fileDataObj=null;return}}var n=!1;-1<DEXTTOP.G_CURREDITOR._config.runtimes.indexOf("html5")&&"1"==DEXTTOP.G_CURREDITOR._config.security.fileExtensionDetector&&(f=a.name.split(".").pop(),g=function(){return function(a,b,c){0==c&&(d.errorFileIdx.push(d.fileIdx),errorData=
{filename:a.name,content:LayerWin.dext5_lang.msg.message_file_ext_detect},d.detectErrorFile.push(errorData),n=!0,e||(document.getElementById("img_alt")&&(document.getElementById("img_alt").value=""),document.getElementById("file_text")&&(document.getElementById("file_text").value=""),document.getElementById("file_text_view")&&(document.getElementById("file_text_view").value=""),document.getElementById("input_text")&&(document.getElementById("input_text").value=""),"1"==LayerWin._dext_editor._config.uploadUseHTML5?
1==DEXTTOP.DEXT5.browser.mobile?document.getElementById("drop_zone").innerHTML=LayerWin.dext5_lang.upload.drop_zone_content2:document.getElementById("drop_zone").innerHTML=LayerWin.dext5_lang.upload.drop_zone_content:document.getElementById("image_url").value=""))}}(),D5FileDetector(a,f,g));if(("image"==c||"m_image"==c)&&"base64"==LayerWin._dext_editor._config.uploadMethod&&null==elemModify&&a&&"-1"!=LayerWin._dext_editor._config.maxImageBase64fileCount&&(LayerWin.getBase64ImageCount()>=parseInt(LayerWin._dext_editor._config.maxImageBase64fileCount,
10)||d&&LayerWin.getBase64ImageCount()+d.fileIdx+1>parseInt(LayerWin._dext_editor._config.maxImageBase64fileCount,10)))return g=LayerWin.dext5_lang.msg.max_base64file_count,g=g.replace("{0}",LayerWin._dext_editor._config.maxImageBase64fileCount),d.errorFileIdx.push(d.fileIdx),errorData={filename:a.name,content:g},d.base64CntErrorFile.push(errorData),e||("1"==LayerWin._dext_editor._config.uploadUseHTML5?1==DEXTTOP.DEXT5.browser.mobile?document.getElementById("drop_zone").innerHTML=LayerWin.dext5_lang.upload.drop_zone_content2:
document.getElementById("drop_zone").innerHTML=LayerWin.dext5_lang.upload.drop_zone_content:document.getElementById("image_url").value=""),b();document.getElementById("image_url")&&fileDataObj&&(f=fileDataObj.value.split("\\"),document.getElementById("image_url").value=f[f.length-1]);try{if(("image"==c||"m_image"==c)&&a&&!e){var q=(window.URL||window.webkitURL||window).createObjectURL(a),r=new Image;r.onload=function(){if(n)document.getElementById("img_width")&&(document.getElementById("img_width").value=
""),document.getElementById("img_height")&&(document.getElementById("img_height").value="");else{try{(window.URL||window.webkitURL||window).revokeObjectURL(this.src)}catch(a){}var b=document.getElementById("img_width_unit"),c=document.getElementById("img_height_unit"),d=!1;b&&"%"==b.value&&(d=!0);if(d){c.value="%";document.getElementById("img_height").disabled=!0;b=r.width;d=r.height;document.getElementById("original_image_width").value=b;document.getElementById("original_image_height").value=d;var c=
LayerWin._dext_editor._config.imgDefaultWidth,d=DEXTTOP.DEXT5.util.parseIntOr0(c),e=DEXTTOP.DEXT5.util.getEditSpacePx(DEXTTOP.G_CURREDITOR),b=Math.round(b/e*1E4)/100;-1<c.indexOf("%")&&0!=d&&d<b&&(b=d);document.getElementById("img_width").value=b}else if(c.value="px",b=r.width,d=r.height,document.getElementById("original_image_width").value=b,document.getElementById("original_image_height").value=d,e=c="",0>LayerWin._dext_editor._config.imgDefaultWidth.indexOf("%")&&(c=LayerWin._dext_editor._config.imgDefaultWidth,
e=LayerWin._dext_editor._config.imgDefaultHeight),""!=c?DEXTTOP.DEXT5.util.parseIntOr0(b)>DEXTTOP.DEXT5.util.parseIntOr0(c)&&(b=DEXTTOP.DEXT5.util.parseIntOr0(d,10)*DEXTTOP.DEXT5.util.parseIntOr0(c,10)/DEXTTOP.DEXT5.util.parseIntOr0(b,10),d=isNaN(b)?d:Math.round(b),b=DEXTTOP.DEXT5.util.parseIntOr0(c)):""!=e&&DEXTTOP.DEXT5.util.parseIntOr0(d)>DEXTTOP.DEXT5.util.parseIntOr0(e)&&(c=DEXTTOP.DEXT5.util.parseIntOr0(b,10)*DEXTTOP.DEXT5.util.parseIntOr0(e,10)/DEXTTOP.DEXT5.util.parseIntOr0(d,10),b=isNaN(c)?
b:Math.round(c),d=DEXTTOP.DEXT5.util.parseIntOr0(e)),document.getElementById("img_width").value=b,document.getElementById("img_height").value=d,c=document.getElementById("img_ratio"))"true"!=c.getAttribute("ratio-checked")&&c.click(),DEXTTOP.DEXT5.browser.mobile?(c.style.display="none",document.getElementById("img_ratio_view").style.display=""):c.style.display="",addEventImgWidthHeight(b,d);(b=document.getElementById("original_size"))&&(b.checked||"1"==LayerWin._dext_editor._config.keepImageOriginalSizeAutoCheck)&&
(b.checked=!0,document.getElementById("img_width").disabled=!0,document.getElementById("img_height").disabled=!0,document.getElementById("img_width_unit").disabled=!0,document.getElementById("img_height_unit").disabled=!0);r=null;r=void 0}};r.src=q}}catch(v){}setTimeout(function(){b&&b()},50)}
function set_page_table_lock_property(){DEXTTOP.DEXT5.util.addEvent(document.getElementById("ok_btn"),"click",function(){applyTableLockProperty()});var a=LayerWin.GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table",!0);if(a){var c=LayerWin.checkLockAttr(a,!0),b=document.getElementsByName("table_lock");c?(b[0].checked=!0,b[1].checked=!1):(b[0].checked=!1,b[1].checked=!0);a.getAttribute("lock_mode")&&(d=a.getAttribute("lock_mode"));c=document.getElementsByName("lock_mode");"1"==d?(c[0].checked=!0,
c[1].checked=!1):(c[0].checked=!1,c[1].checked=!0);var d=DEXTTOP.G_CURREDITOR._config.defaultTableLockMode;a.getAttribute("lock_mode")&&(d=a.getAttribute("lock_mode"));c=document.getElementsByName("lock_mode");"1"==d?(c[0].checked=!0,c[1].checked=!1):(c[0].checked=!1,c[1].checked=!0);d=DEXTTOP.G_CURREDITOR._config.defaultShowLockIconUserMode;a.getAttribute("show_icon")&&(d=a.getAttribute("show_icon"));a=document.getElementsByName("lock_icon_option");"0"==d?(a[1].checked=!0,a[0].checked=!1):(a[1].checked=
!1,a[0].checked=!0)}}
function applyTableLockProperty(){var a=LayerWin.GetParentbyTagName(DEXTTOP.G_SELECTED_ELEMENT,"table",!0);a&&(document.getElementsByName("table_lock")[0].checked?(LayerWin.setClassName(a,"DEXT_five_table_lock"),a.setAttribute(DEXTTOP.G_CURREDITOR._config.adminTableLock.defaultLockName,""),document.getElementsByName("lock_mode")[0].checked?a.setAttribute("lock_mode","1"):a.setAttribute("lock_mode","2"),document.getElementsByName("lock_icon_option")[0].checked?a.setAttribute("show_icon","1"):a.setAttribute("show_icon",
"0")):(LayerWin.removeLockAttr(a),LayerWin.removeClassName(a,"DEXT_five_table_lock"),a.removeAttribute("lock_mode"),a.removeAttribute("show_icon")),a=LayerWin.getFirstRange().range.startContainer,3==a.nodeType&&(a=a.parentNode),a&&1==a.nodeType&&LayerWin.setMenuIconRealable(a));event_dext_close()}
function setBorderListValue(a,c){switch(a){case "none":c.style.borderTopStyle="none";break;case "solid":c.style.borderTop="1px solid rgb(93, 93, 93)";break;case "dotted":c.style.borderTop="1px dotted rgb(93, 93, 93)";break;case "dashed":c.style.borderTop="1px dashed rgb(93, 93, 93)";break;case "double":c.style.border="3px double rgb(93, 93, 93)";break;case "groove":c.style.border="3px groove rgb(225, 225, 225)";break;case "ridge":c.style.border="3px ridge rgb(225, 225, 225)";break;case "inset":c.style.border=
"3px inset rgb(225, 225, 225)";break;case "outset":c.style.border="3px outset rgb(225, 225, 225)"}}
function paste_to_image_loaded_event(){var a=LayerWin._dext_editor._config.style.skinName;document.getElementById("dext_dialog_box").className="DEXT_fiVe_ED_Popup_Type06 DEXT_fiVe_PUi_"+a;if("0"==LayerWin._dext_editor._config.pasteToImagePopupMode){for(var c=document.querySelectorAll(".con_right"),b=c.length,a=0;a<b;a++)if(c[a].className=c[a].className.replace("con_right","con_left"),c[a].style.width="500px",0==a){c[a].parentNode.style.height="270px";var d=c[a].querySelector("dd");d.style.width="496px";
d.style.height="170px";d=c[a].querySelector("canvas");d.width="496";d.height="170"}a=document.querySelectorAll("fieldset");a[0].style.display="none";a[1].style.display="none";document.querySelector("#setting_img_format").style.marginTop="55px";c=a[2].querySelectorAll("li");b=["22%","22%","30%","20%"];d=c.length;for(a=0;a<d;a++)c[a].style.display="inline-block",c[a].style.width=b[a]}for(var c=d=!1,b="",e=document.getElementById("formatList"),a=0;a<DEXTTOP.G_CURREDITOR._config.pasteToImageType.length;a++)0==
a&&(b=DEXTTOP.G_CURREDITOR._config.pasteToImageType[a].toLowerCase()),"png"==DEXTTOP.G_CURREDITOR._config.pasteToImageType[a].toLowerCase()?(e.innerHTML+='<li class="Li" style="width:100%;"><input id="image_type_png" name="image_type" type="radio" value="png" /><label for="image_type_png">PNG</label></li>',d=!0):"jpg"==DEXTTOP.G_CURREDITOR._config.pasteToImageType[a].toLowerCase()&&(e.innerHTML+='<li class="Li"><input id="image_type_jpg" name="image_type" type="radio" value="jpg"/><label for="image_type_jpg" style="vertical-align:middle;">JPG</label></li><li class="Li" style = "position:relative;"><label for="image_quality" id="label_quality"></label><div class="no_a" style="position:absolute; right:0; top:0"><input class="con_input" id="image_quality" style="width: 30px; vertical-align:middle;" type="text" /><ul style="vertical-align:middle;"><li id="quality_spinUp"><a style="cursor: pointer; margin:0; padding:0; border:none;" href="javascript:void(0);"><img src="../images/editor/dialog/btn/editor_ta_btn.gif" width="15" height="10" style="margin:0; padding:0;" /></a></li><li id="quality_spinDown"><a style="cursor: pointer;  margin:0; padding:0; border:none;" href="javascript:void(0);"><img src="../images/editor/dialog/btn/editor_ba_btn.gif" width="15" height="10" style="margin:0; padding:0;" /></a></li></ul></div></li>',
c=!0);"Windows"==DEXTTOP.DEXT5.UserAgent.os.name&&c&&d?"png"==b?(imageType="png",document.getElementById("image_type_png").checked=!0):(imageType="jpeg",document.getElementById("image_type_jpg").checked=!0):"Windows"!=DEXTTOP.DEXT5.UserAgent.os.name||!c&&d?(imageType="png",document.getElementById("image_type_png").checked=!0,c&&(document.getElementById("image_type_jpg").parentNode.style.display="none",document.getElementById("label_quality").parentNode.style.display="none")):c&&!d&&(imageType="jpeg",
document.getElementById("image_type_jpg").checked=!0);var d=document.getElementById("html_btn"),f=document.getElementById("image_width"),g=document.getElementById("image_height"),h=document.getElementById("image_quality");document.getElementById("span_title").innerHTML=LayerWin.dext5_lang.paste_to_image.title;document.getElementById("span_save_client").innerHTML=LayerWin.dext5_lang.paste_to_image.save_client;document.getElementById("legent_format").innerHTML=LayerWin.dext5_lang.paste_to_image.format;
c&&(document.getElementById("label_quality").innerHTML=LayerWin.dext5_lang.paste_to_image.quality);document.getElementById("rotate").innerHTML=LayerWin.dext5_lang.paste_to_image.rotate;document.getElementById("size").innerHTML=LayerWin.dext5_lang.paste_to_image.size;document.getElementById("label_width").innerHTML=LayerWin.dext5_lang.paste_to_image.width;document.getElementById("label_height").innerHTML=LayerWin.dext5_lang.paste_to_image.height;document.getElementById("lock_size_rate").innerHTML=
LayerWin.dext5_lang.paste_to_image.lock_size_rate;document.getElementById("span_origin_size").innerHTML=LayerWin.dext5_lang.paste_to_image.origin_size;document.getElementById("dt_preview").innerHTML=LayerWin.dext5_lang.paste_to_image.preview;document.getElementById("label_lock_size_rate").innerHTML=LayerWin.dext5_lang.paste_to_image.lock_size_rate;document.getElementById("label_lock_origin_size").innerHTML=LayerWin.dext5_lang.paste_to_image.lock_origin_size;""!=LayerWin._dext_editor._config.buttonText001?
document.getElementById("span_insert_image").innerHTML=LayerWin._dext_editor._config.buttonText001:document.getElementById("span_insert_image").innerHTML=LayerWin.dext5_lang.paste_to_image.insert_image;document.getElementById("span_insert_html").innerHTML=LayerWin.dext5_lang.paste_to_image.insert_html;DEXTTOP.DEXT5.util.addEvent(h,"keydown",LayerWin.onlyNumber);DEXTTOP.DEXT5.util.addEvent(h,"blur",function(){100<DEXTTOP.DEXT5.util.parseIntOr0(h.value)?h.value="100":0==DEXTTOP.DEXT5.util.parseIntOr0(h.value)&&
(h.value="1")});DEXTTOP.DEXT5.util.addEvent(f,"keydown",LayerWin.onlyNumber);DEXTTOP.DEXT5.util.addEvent(g,"keydown",LayerWin.onlyNumber);DEXTTOP.DEXT5.util.addEvent(f,"keyup",function(){if(1==document.getElementById("lock_size_rate").checked){var a=parseInt(r,10)*parseInt(f.value,10)/parseInt(q,10);g.value=isNaN(a)?g.value:Math.round(a)}});DEXTTOP.DEXT5.util.addEvent(g,"keyup",function(){if(1==document.getElementById("lock_size_rate").checked){var a=parseInt(q,10)*parseInt(g.value,10)/parseInt(r,
10);f.value=isNaN(a)?f.value:Math.round(a)}});DEXTTOP.DEXT5.util.addEvent(document.getElementById("span_origin_size").parentNode,"click",function(){f.value=q;g.value=r});DEXTTOP.DEXT5.util.addEvent(document.getElementById("lock_origin_size"),"click",function(){document.getElementById("lock_origin_size").checked?(f.value=parseInt(document.getElementById("original_img_width").value,10),g.value=parseInt(document.getElementById("original_img_height").value,10),f.disabled=!0,g.disabled=!0):(f.disabled=
!1,g.disabled=!1)});DEXTTOP.DEXT5.util.addEvent(document.getElementById("quality_spinUp"),"click",function(){0==h.disabled&&LayerWin.click_plus_func(document.getElementById("image_quality"),100,10)});DEXTTOP.DEXT5.util.addEvent(document.getElementById("quality_spinDown"),"click",function(){0==h.disabled&&LayerWin.click_minus_func(document.getElementById("image_quality"),1,10)});var l=document.getElementById("canvas_preview"),k=l.getContext("2d"),m=DEXTTOP.G_CURREDITOR.clipImageBeforePopup,p,n,q,r,
v=0,A=0,z=1,y={type:"",width:0,height:0,checkOriginSize:!1};0==DEXTTOP.G_CURREDITOR.bTextorHtmlData&&(document.getElementById("html_btn").style.display="none",d=document.getElementById("image_btn"));DEXTTOP.DEXT5.util.addEvent(document.getElementById("image_btn"),"click",function(){for(var a=0,b=document.getElementsByName("image_rotate"),c=b.length,d=0;d<c;d++)if(b[d].checked){a=DEXTTOP.DEXT5.util.parseIntOr0(b[d].value);break}b=1;"jpeg"==imageType&&0==h.disabled&&(b=1*DEXTTOP.DEXT5.util.parseIntOr0(h.value)/
100);var e=function(a){a&&(DEXTTOP.G_CURREDITOR.clipImageBlob=a);y.type="image";y.width=DEXTTOP.DEXT5.util.parseIntOr0(f.value);y.height=DEXTTOP.DEXT5.util.parseIntOr0(g.value);y.checkOriginSize=document.getElementById("lock_origin_size").checked;a=DEXTTOP.DEXT5.util.parseIntOr0(document.getElementById("original_img_width").value);var b=DEXTTOP.DEXT5.util.parseIntOr0(document.getElementById("original_img_height").value);y.checkOriginSize&&(y.width=a,y.height=b);LayerWin.command_pasteToImage(DEXTTOP.G_CURREDITOR.ID,
DEXTTOP.G_CURREDITOR,y);m=void 0;event_dext_close()};0!=a||1!=b||"png"!=imageType?(l.style.display="none",90==a||270==a?(c=m.height,d=m.width):(c=m.width,d=m.height),l.width=c,l.height=d,k.save(),"png"!=imageType&&(k.fillStyle="white",k.fillRect(0,0,l.width,l.height)),k.translate(l.width/2,l.height/2),k.rotate(a*Math.PI/180),"png"==imageType&&k.clearRect(0,0,l.width,l.height),k.drawImage(m,-m.width/2,-m.height/2,m.width,m.height),k.restore(),l.toBlob(function(a){e(a)},"image/"+imageType,b)):e()});
DEXTTOP.DEXT5.util.addEvent(document.getElementById("html_btn"),"click",function(){y.type="html";LayerWin.command_pasteToImage(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR,y);m=void 0;event_dext_close();DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode&&LayerWin.DEXT5_EDITOR.prototype.dialog.show(DEXTTOP.G_CURREDITOR._config.webPath.page,DEXTTOP.G_CURREDITOR._config.pages.paste_table)});for(var B=document.getElementsByName("image_rotate"),C=B.length,a=0;a<C;a++)e=function(a){return function(b){b=DEXTTOP.DEXT5.util.parseIntOr0(B[a].value);
k.save();k.clearRect(0,0,l.width,l.height);k.translate(l.width/2,l.height/2);k.rotate(b*Math.PI/180);k.drawImage(m,-p/2,-n/2,p,n);k.restore();var c;90==b||270==b?(b=m.height,c=m.width,q=m.height,r=m.width):(b=m.width,c=m.height,q=m.width,r=m.height);f.value=b;g.value=c}}(a),DEXTTOP.DEXT5.util.addEvent(B[a],"click",e);for(var t=document.getElementsByName("image_type"),C=t.length,a=0;a<C;a++)e=function(a){return function(b){b=t[a].value;"jpg"==b?(imageType="jpeg",h.disabled=!1):(imageType=b,h.disabled=
!0)}}(a),DEXTTOP.DEXT5.util.addEvent(t[a],"click",e);c&&(h.value="100");"jpg"==b?(setCursorPos(document.getElementById("image_type_jpg"),!1,!1),LayerWin.setFocusFirstAndLast(document,document.getElementById("image_type_jpg"),d)):(setCursorPos(document.getElementById("image_type_png"),!1,!1),LayerWin.setFocusFirstAndLast(document,document.getElementById("image_type_png"),d));(function(){DEXTTOP.G_CURREDITOR=LayerWin._dext_editor;q=m.width;r=m.height;document.getElementById("original_img_width").value=
m.width;document.getElementById("original_img_height").value=m.height;var a="",b="";0>LayerWin._dext_editor._config.imgDefaultWidth.indexOf("%")&&(a=LayerWin._dext_editor._config.imgDefaultWidth,b=LayerWin._dext_editor._config.imgDefaultHeight);""!=a?DEXTTOP.DEXT5.util.parseIntOr0(q)>DEXTTOP.DEXT5.util.parseIntOr0(a)&&(b=DEXTTOP.DEXT5.util.parseIntOr0(r,10)*DEXTTOP.DEXT5.util.parseIntOr0(a,10)/DEXTTOP.DEXT5.util.parseIntOr0(q,10),r=isNaN(b)?r:Math.round(b),q=DEXTTOP.DEXT5.util.parseIntOr0(a)):""!=
b&&DEXTTOP.DEXT5.util.parseIntOr0(r)>DEXTTOP.DEXT5.util.parseIntOr0(b)&&(a=DEXTTOP.DEXT5.util.parseIntOr0(q,10)*DEXTTOP.DEXT5.util.parseIntOr0(b,10)/DEXTTOP.DEXT5.util.parseIntOr0(r,10),q=isNaN(a)?q:Math.round(a),r=DEXTTOP.DEXT5.util.parseIntOr0(b));f.value=q;g.value=r;z=Math.min(l.width/q,l.height/r);1>z?(p=Math.round(q*z),n=Math.round(r*z)):(p=q,n=r,z=1);p<l.width&&(v=(l.width-p)/2);n<l.height&&(A=(l.height-n)/2);k.drawImage(m,v,A,p,n)})()}
function dext_create_conversion(){var a={text:document.getElementById("targetContent").value};LayerWin.event_dext_create_conversion(a,window.frameElement.parentNode.parentNode)}function dext_calculator(){var a=document.getElementById("valueText");LayerWin.event_dext_calculator(a.value,window.frameElement.parentNode.parentNode)}
function dext_insert_placeholder(){var a={notice:""};a.notice=document.getElementById("input_notice").value;LayerWin.event_dext_insert_placeholder(a,window.frameElement.parentNode.parentNode)}function dext_load_auto_save_open(a,c,b){return LayerWin.event_dext_load_auto_save_open(a,c,b)}function dext_load_auto_save(){LayerWin.event_dext_load_auto_save(g_currHtml,window.frameElement.parentNode.parentNode)}
function dext_load_auto_save_del(a,c,b,d){a="dext_"+a;""!=c&&(a+="_"+c);LayerWin.event_dext_load_auto_save_del(a,b,window.frameElement.parentNode.parentNode,d)}
function dext_load_auto_save_setDateList(){var a=dext_load_auto_save_open(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR._config.setAutoSave.unique_key,DEXTTOP.G_CURREDITOR._config.setAutoSave.maxCount);if(null!=a&&void 0!=a&&0<a.length)for(var c=document.getElementById("ul_date"),b=a.length-1;0<=b;b--){var d=document.createElement("li");d.style.cursor="pointer";var e=document.createElement("span");e.className="icon";var f=document.createElement("img");f.src="../images/bg/editor_popup_close_bg.gif";
f.width="10";f.height="10";f.style.cursor="pointer";e.appendChild(f);var g=document.createElement("span");g.className="text";var f=a[b].date.split(" "),h=f[0].split("/");g.innerHTML=h[2]+"/"+h[0]+"/"+h[1]+" "+f[1];f=document.createElement("a");f.appendChild(g);f.href="javascript:void(0)";f.style.textDecoration="none";g=document.createElement("a");g.appendChild(e);g.href="javascript:void(0)";g.style.textDecoration="none";d.appendChild(f);d.appendChild(g);c.appendChild(d);e=function(b){return function(c){dext_load_auto_save_click_date(b,
a);DEXTTOP.DEXT5.util.stopEvent(c)}}(b);DEXTTOP.DEXT5.util.addEvent(d,"click",e);DEXTTOP.DEXT5.util.addEvent(f,"focus",e);d=function(a){return function(a){13==("which"in a?a.which:a.keyCode)&&(DEXTTOP.DEXT5.util.cancelEvent(a),dext_load_auto_save())}}(f);DEXTTOP.DEXT5.util.addEvent(f,"keydown",d);"cssFloat"in f.style?f.style.cssFloat="left":f.style.styleFloat="left";"cssFloat"in g.style?g.style.cssFloat="left":g.style.styleFloat="left";d=function(b){return function(c){dext_load_auto_save_click_date(b,
a);dext_load_auto_save_click_del(DEXTTOP.G_CURREDITOR.ID,DEXTTOP.G_CURREDITOR._config.setAutoSave.unique_key,b,DEXTTOP.G_CURREDITOR._config.setAutoSave.maxCount);DEXTTOP.DEXT5.util.stopEvent(c)}}(b);DEXTTOP.DEXT5.util.addEvent(g,"click",d);setCursorPos(document.getElementById("ul_date").getElementsByTagName("a")[0],!1,!1);LayerWin.setFocusFirstAndLast(document,document.getElementById("ul_date").getElementsByTagName("a")[0])}else dext_load_auto_save_setHtml("<html><head></head><body></body></html>")}
function dext_load_auto_save_click_date(a,c){for(var b=document.getElementById("ul_date"),d=b.getElementsByTagName("li").length-1,e=d;0<=e;e--){var f=d-e;e==a?b.getElementsByTagName("li")[f].style.backgroundColor="#dff1ff":b.getElementsByTagName("li")[f].style.backgroundColor="#ffffff";b.getElementsByTagName("li")[f].getElementsByTagName("img")[0].src="../images/bg/editor_popup_close_bg.gif"}0<b.getElementsByTagName("li").length&&dext_load_auto_save_setHtml(c[a].html)}
function dext_load_auto_save_setHtml(a){var c=document.getElementById("content_frame").contentWindow.document;g_currHtml=a;"1"==DEXTTOP.G_CURREDITOR._config.enforceDoctype&&(g_currHtml=g_currHtml.replace(/<!doctype *([^>?+])*>/gi,""));a=LayerWin.getRemoveHeadScript(g_currHtml);g_currHtml=a.html;c.open("text/html","replace");LayerWin.isCustomDomain(LayerWin.document)&&(c.domain=LayerWin.document.domain);c.write(g_currHtml);c.close();LayerWin.setHeadScriptSrc(c,a.scriptsAry);a=Math.max(c.body.scrollWidth,
c.body.offsetWidth,c.documentElement.clientWidth,c.documentElement.scrollWidth,c.documentElement.offsetWidth);var b=Math.max(c.body.scrollHeight,c.body.offsetHeight,c.documentElement.clientHeight,c.documentElement.scrollHeight,c.documentElement.offsetHeight),d=document.getElementById("content_frame").parentNode,e=LayerWin.getClientRect(d),d=e.right-e.left,e=e.bottom-e.top,f=!0;DEXTTOP.DEXT5.browser.ie&&7>=DEXTTOP.DEXT5.browser.ieVersion&&(f=!1);a>d?(c.body.style.width=DEXTTOP.G_CURREDITOR._config.style.width,
f&&(c.body.style.overflowX="scroll")):f&&(c.body.style.overflowX="hidden");b>e?f&&(c.body.style.overflowY="scroll"):f&&(c.body.style.overflowY="hidden");DEXTTOP.DEXT5.util.addEvent(c,"contextmenu",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)})}
function dext_load_auto_save_click_del(a,c,b,d){var e=document.getElementById("ul_date");if(confirm(LayerWin.dext5_lang.loadAutoSave.delMsg)){for(dext_load_auto_save_del(a,c,b,d);e.hasChildNodes();)e.removeChild(e.firstChild);dext_load_auto_save_setDateList()}}
function dext_paragraph_attribute(){var a=document.getElementById("p_margin_left"),c=document.getElementById("p_margin_right"),b=document.getElementById("p_margin_top"),d=document.getElementById("p_margin_bottom"),e=document.getElementById("p_letter_spacing"),f=document.getElementById("p_word_spacing"),g=document.getElementById("p_text_indent"),h=document.getElementById("p_font_size"),l=document.getElementById("font_family_select"),k=document.getElementById("p_font_size_type"),m,p,n,q,r;"[object Array]"===
Object.prototype.toString.call(DEXTTOP.G_CURREDITOR._config.paragraphAttributeType)?(p_text_indent_type=document.getElementById("p_text_indent_type"),p_margin_left_type=document.getElementById("p_margin_left_type"),p_margin_right_type=document.getElementById("p_margin_right_type"),p_margin_top_type=document.getElementById("p_margin_top_type"),p_margin_bottom_type=document.getElementById("p_margin_bottom_type"),m=p_text_indent_type[p_text_indent_type.options.selectedIndex].value,p=p_margin_left_type[p_margin_left_type.options.selectedIndex].value,
n=p_margin_right_type[p_margin_right_type.options.selectedIndex].value,q=p_margin_top_type[p_margin_top_type.options.selectedIndex].value,r=p_margin_bottom_type[p_margin_bottom_type.options.selectedIndex].value):r=q=n=p=m=DEXTTOP.G_CURREDITOR._config.paragraphAttributeType;LayerWin.event_dext_paragraph_attribute({marginLeft:a.value,marginRight:c.value,marginTop:b.value,marginBottom:d.value,letterSpacing:e.value,wordSpacing:f.value,textIndent:g.value,fontSize:h.value,fontFamily:l.value,fontType:k.value,
textIndentType:m,marginLeftType:p,marginRightType:n,marginTopType:q,marginBottomType:r},window.frameElement.parentNode.parentNode)}function dext_paste_table(){for(var a="",c=document.getElementsByName("radio_select"),b=c.length,d=0;d<b;d++)if(1==c[d].checked){a=c[d].value;break}LayerWin.event_dext_paste_table({type:a},window.frameElement.parentNode.parentNode)}
function set_paste_table_button(){for(var a=DEXTTOP.G_CURREDITOR.pasteTableParam.tableNode,c=0,b=0,c=a.rows.length,d=0;d<c;d++){var e=a.rows[d].cells.length;b<e&&(b=e)}for(var a=DEXTTOP.G_CURREDITOR.pasteTableParam.currTableNode,f=0,g=0,f=a.rows.length,d=0;d<f;d++)e=a.rows[d].cells.length,g<e&&(g=e);f==c&&(document.getElementById("radio_3").removeAttribute("disabled"),document.getElementById("radio_4").removeAttribute("disabled"));g==b&&(document.getElementById("radio_5").removeAttribute("disabled"),
document.getElementById("radio_6").removeAttribute("disabled"))}DEXTTOP.DEXT5.util.addEvent(window,"dragover",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)});DEXTTOP.DEXT5.util.addEvent(document,"dragover",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)});DEXTTOP.DEXT5.util.addEvent(window,"drop",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)});DEXTTOP.DEXT5.util.addEvent(document,"drop",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)});
"undefined"==typeof useContextmenu&&DEXTTOP.DEXT5.util.addEvent(document,"contextmenu",function(a){DEXTTOP.DEXT5.util.cancelEvent(a)});function dext5plugin_action(a){LayerWin.event_dext5plugin_action(a,window.frameElement.parentNode.parentNode)}function setInputBoxWidth(a,c){c=DEXTTOP.DEXT5.util.parseIntOr0(c);a.style.width=DEXTTOP.DEXT5.browser.mobile?DEXTTOP.DEXT5.browser.safari?c-10+"px":c+"px":c+"px"}
function dext_spellcheck_set_popup(a,c){if(0==a.length)return!1;try{for(var b=LayerWin.rangy.createRange(document.getElementById("copycontent").contentDocument),d=0;d<a.length;d++)if(b.findText(a[d].word)){b.deleteContents();var e=document.createElement("span");e.setAttribute("id","cnt"+d);e.setAttribute("class","cnt");e.setAttribute("onmouseover","parent.wrong_word_over(this)");e.setAttribute("onmouseout","parent.wrong_word_out(this)");var f=document.createElement("span");f.setAttribute("class",
"cnt_modify");f.setAttribute("title",Dext5LayerWin.dext5_lang.plugins.spellcheck.apply);f.setAttribute("onclick","parent.above_word_click(this)");f.innerHTML=a[d].suggestions[0];e.appendChild(f);var g=document.createElement("span");g.setAttribute("class","wordspan");g.innerText=a[d].word;var h=document.createElement("sup"),l=document.createTextNode(d+1+")");h.appendChild(l);e.appendChild(h);e.appendChild(g);b.insertNode(e);b.selectNode(e);c?b.collapse(!1):b.collapse(!0);var k=document.createElement("dl");
k.setAttribute("id","list"+d);k.setAttribute("value",d);-1!=LayerWin.G_DEPlugin.spellcheck.chkWordArr[d].word.indexOf("'")?k.innerHTML='<dt onclick="wrong_word_click(this)" title="'+Dext5LayerWin.dext5_lang.plugins.spellcheck.undo+'"><a href="javascript:void(0);" data-value="'+LayerWin.G_DEPlugin.spellcheck.chkWordArr[d].word+'">'+(d+1)+") "+LayerWin.G_DEPlugin.spellcheck.chkWordArr[d].word+"</a></dt>":k.innerHTML="<dt onclick='wrong_word_click(this)' title='"+Dext5LayerWin.dext5_lang.plugins.spellcheck.undo+
"'><a href='javascript: void (0);' data-value='"+LayerWin.G_DEPlugin.spellcheck.chkWordArr[d].word+"'>"+(d+1)+") "+LayerWin.G_DEPlugin.spellcheck.chkWordArr[d].word+"</a></dt>";document.getElementById("wordlist").appendChild(k);for(var m=0;m<LayerWin.G_DEPlugin.spellcheck.chkWordArr[d].suggestions.length;m++){var p=document.createElement("dd");p.setAttribute("onclick","replace_word_click(this)");p.setAttribute("title",Dext5LayerWin.dext5_lang.plugins.spellcheck.apply);p.innerHTML="<a href='javascript: void (0);' value='"+
LayerWin.G_DEPlugin.spellcheck.chkWordArr[d].suggestions[m]+"'>"+LayerWin.G_DEPlugin.spellcheck.chkWordArr[d].suggestions[m]+"</a></dt>";document.getElementById("list"+d).appendChild(p)}k.getElementsByTagName("dd")[0].setAttribute("class","recommend")}else{var n=a[d].word,n=n.replace(/ /gi,"\u00a0");if(b.findText(n)){b.deleteContents();e=document.createElement("span");e.setAttribute("id","cnt"+d);e.setAttribute("class","cnt");e.setAttribute("onmouseover","parent.wrong_word_over(this)");e.setAttribute("onmouseout",
"parent.wrong_word_out(this)");f=document.createElement("span");f.setAttribute("class","cnt_modify");f.setAttribute("title",Dext5LayerWin.dext5_lang.plugins.spellcheck.apply);f.setAttribute("onclick","parent.above_word_click(this)");f.innerHTML=a[d].suggestions[0];e.appendChild(f);g=document.createElement("span");g.setAttribute("class","wordspan");g.innerText=a[d].word;h=document.createElement("sup");l=document.createTextNode(d+1+")");h.appendChild(l);e.appendChild(h);e.appendChild(g);b.insertNode(e);
b.selectNode(e);c?b.collapse(!1):b.collapse(!0);k=document.createElement("dl");k.setAttribute("id","list"+d);k.setAttribute("value",d);-1!=LayerWin.G_DEPlugin.spellcheck.chkWordArr[d].word.indexOf("'")?k.innerHTML='<dt onclick="wrong_word_click(this)" title="'+Dext5LayerWin.dext5_lang.plugins.spellcheck.undo+'"><a href="javascript:void(0);" data-value="'+LayerWin.G_DEPlugin.spellcheck.chkWordArr[d].word+'">'+(d+1)+") "+LayerWin.G_DEPlugin.spellcheck.chkWordArr[d].word+"</a></dt>":k.innerHTML="<dt onclick='wrong_word_click(this)' title='"+
Dext5LayerWin.dext5_lang.plugins.spellcheck.undo+"'><a href='javascript: void (0);' data-value='"+LayerWin.G_DEPlugin.spellcheck.chkWordArr[d].word+"'>"+(d+1)+") "+LayerWin.G_DEPlugin.spellcheck.chkWordArr[d].word+"</a></dt>";document.getElementById("wordlist").appendChild(k);for(m=0;m<LayerWin.G_DEPlugin.spellcheck.chkWordArr[d].suggestions.length;m++)p=document.createElement("dd"),p.setAttribute("onclick","replace_word_click(this)"),p.setAttribute("title",Dext5LayerWin.dext5_lang.plugins.spellcheck.apply),
p.innerHTML="<a href='javascript: void (0);' value='"+LayerWin.G_DEPlugin.spellcheck.chkWordArr[d].suggestions[m]+"'>"+LayerWin.G_DEPlugin.spellcheck.chkWordArr[d].suggestions[m]+"</a></dt>",document.getElementById("list"+d).appendChild(p);k.getElementsByTagName("dd")[0].setAttribute("class","recommend")}else LayerWin.G_DEPlugin.spellcheck.chkWordArr.splice(d,1),d--}Dext5LayerWin.hideProcessingBackground()}catch(q){}}
function imgSizeUnitChange(a,c){var b=document.getElementById("img_height_unit"),d=document.getElementById("img_width_unit"),e=document.getElementById("img_width"),f=document.getElementById("img_height"),g=document.getElementById("img_ratio"),h=DEXTTOP.G_CURREDITOR._config.imgDefaultWidth,l=DEXTTOP.DEXT5.util.parseIntOr0(h),k=DEXTTOP.DEXT5.util.getEditSpacePx(DEXTTOP.G_CURREDITOR);if("%"==a){var m=Math.round(document.getElementById("original_image_width").value/k*1E4)/100;0==m&&(m="")}if(d.value!=
b.value)if(d.value=a,b.value=a,"%"==a)-1<h.indexOf("%")&&l<m&&""!=m&&0!=l?e.value=l:e.value=m,f.value="",f.disabled=!0;else{var h=DEXTTOP.G_CURREDITOR._config.imgDefaultWidth,k=DEXTTOP.G_CURREDITOR._config.imgDefaultHeight,p=document.getElementById("original_image_width").value,n=document.getElementById("original_image_height").value;""!=h&&0>h.indexOf("%")?DEXTTOP.DEXT5.util.parseIntOr0(p)>DEXTTOP.DEXT5.util.parseIntOr0(h)&&(k=DEXTTOP.DEXT5.util.parseIntOr0(n,10)*DEXTTOP.DEXT5.util.parseIntOr0(h,
10)/DEXTTOP.DEXT5.util.parseIntOr0(p,10),n=isNaN(k)?n:Math.round(k),p=DEXTTOP.DEXT5.util.parseIntOr0(h)):""!=k&&DEXTTOP.DEXT5.util.parseIntOr0(n)>DEXTTOP.DEXT5.util.parseIntOr0(k)&&(n=DEXTTOP.DEXT5.util.parseIntOr0(p,10)*DEXTTOP.DEXT5.util.parseIntOr0(k,10)/DEXTTOP.DEXT5.util.parseIntOr0(n,10),p=isNaN(n)?p:Math.round(n),n=DEXTTOP.DEXT5.util.parseIntOr0(k));e.value=p;f.value=n;f.disabled=!1}"true"==g.getAttribute("ratio-checked")?(d.value=a,b.value=a,"%"==a?"w"==c&&(-1<h.indexOf("%")&&l<m&&""!=m&&
0!=l?e.value=l:e.value=m,f.value="",f.setAttribute("disabled","true")):(e.removeAttribute("disabled"),f.removeAttribute("disabled"))):d.value==b.value?g.removeAttribute("disabled"):(g.className="img_link_btn",g.setAttribute("ratio-checked",!1),g.setAttribute("disabled","true"),e.removeAttribute("disabled"),f.removeAttribute("disabled"))}
function checkSameBorderWidthInCells(a,c){var b=["borderLeftWidth","borderTopWidth","borderRightWidth","borderBottomWidth"],d=b.length,e={isSame:!0,borderWidth:""};try{if(c){a=[];for(var f=["td","th"],g=f.length,h=0;h<g;h++){var l=c.getElementsByTagName(f[h]);try{a=a.concat(Array.prototype.slice.call(l,0))}catch(k){for(var m=l.length,p=0;p<m;p++)a.push(l[p])}}}var n=a.length;if(500>=n){for(var q=a[0].style.borderLeftWidth,h=0;h<n;h++){for(var r=a[h],p=0;p<d;p++)if(q!=r.style[b[p]]){e.isSame=!1;break}if(0==
e.isSame)break}1==e.isSame&&(e.borderWidth=q)}else e={isSame:!1,borderWidth:""}}catch(v){e={isSame:!1,borderWidth:""}}return e}function changeStyleForiOS(a,c){if(DEXTTOP.DEXT5.browser.iOS)for(data in a.style.webkitAppearance="none",c){a.style[data]=c[data];break}}function addParamHashTable(a){for(var c=DEXTTOP.G_CURREDITOR._FRAMEWIN.G_FormData,b=c.length,d=0;d<b;d++){var e=c[d].form_value,e=encodeURIComponent(c[d].form_value);a.setItem(c[d].form_name,e)}}
function addParamForm(a){try{for(var c=DEXTTOP.G_CURREDITOR._FRAMEWIN.G_FormData,b=c.length-1;0<=b;b--){var d=c[b].form_value,d=encodeURIComponent(c[b].form_value),e=document.createElement("input");e.setAttribute("type","hidden");e.setAttribute("id","addFormData"+[b]);e.setAttribute("name",c[b].form_name);e.setAttribute("value",d);a.insertBefore(e,a.firstChild)}}catch(f){}}
function postMessageEvent(a,c){if(window.postMessage){var b=function(a){try{var e=a.data.replace("*","?");_web_url=DEXTTOP.DEXT5.util.trim(e);switch(c){case "image":event_dext_image_upload_completed(e);break;case "cell_property":event_dext_cell_property_completed(_web_url);break;case "doc_bg_img":event_dext_dog_bg_img_completed(_web_url);break;case "flash":event_dext_flash_upload_completed(_web_url);break;case "hyperlink":dext_create_hyperlink(_web_url);break;case "insert_file":event_dext_file_upload_completed(_web_url);
break;case "media":event_dext_media_upload_completed(_web_url);break;case "video":event_dext_video_upload_completed(_web_url);break;case "table":event_dext_detail_table_completed(_web_url);break;case "table_property":event_dext_table_property_completed(_web_url);break;case "input_image":event_dext_input_image_upload_completed(_web_url)}}catch(f){}DEXTTOP.DEXT5.util.removeEvent(window,"message",b)};DEXTTOP.DEXT5.util.addEvent(window,"message",b)}DEXTTOP.DEXT5.util.addEvent(a,"load",function(){a.contentWindow.postMessage("check",
"*")},!0)}
function aboutShowInfo(){try{document.getElementById("dext_license_company").innerHTML=": "+LayerWin._dext_editor.____.l[1],document.getElementById("dext_license_system").innerHTML=": "+LayerWin._dext_editor.____.l[2],document.getElementById("dext_license_product").innerHTML=": "+LayerWin._dext_editor.____.l[7],"S"==LayerWin._dext_editor.____.l[3]?document.getElementById("dext_license_edition").innerHTML=": Standard Edition":document.getElementById("dext_license_edition").innerHTML=": Professional Edition",0==
LayerWin._dext_editor.____.l[6]?document.getElementById("dext_license_user").innerHTML=": Unlimited.":document.getElementById("dext_license_user").innerHTML=": "+LayerWin._dext_editor.____.l[6],document.getElementById("dext_license_ver").innerHTML=": "+DEXTTOP.DEXT5.ReleaseVer}catch(a){}}
function page_dialog_loaded_event(a){try{var c=document.location.href;try{c=c.substring(c.indexOf("/pages/editor_")+14),c=c.substring(0,c.indexOf(".html?"))}catch(b){}"function"===typeof DEXTTOP.G_CURREDITOR._config.event.dialogLoaded?DEXTTOP.G_CURREDITOR._config.event.dialogLoaded(c,document):"function"===typeof DEXTTOP.DEXTWIN.dext_editor_dialog_loaded_event&&DEXTTOP.DEXTWIN.dext_editor_dialog_loaded_event(c,document)}catch(d){}}
function row_property_set_page(){var a=LayerWin.GetTDTHCell(DEXTTOP.G_SELECTED_ELEMENT);if(null!=a&&void 0!=a){var c=LayerWin.GetParentbyTagName(a,"table"),b=LayerWin.GetParentbyTagName(a,"tr");if(null!=c&&null!=b){for(var d=null,e="",f="",g="",h="",l=!0,k=!0,m=!0,p=!0,n=b.cells.length,q=0;q<n;q++)d=b.cells[q],0!=q&&(l&&e!=d.style.backgroundColor&&(l=!1),k&&f!=d.style.height&&(k=!1),m&&g!=d.style.textAlign&&(m=!1),p&&h!=d.style.verticalAlign&&(p=!1)),e=d.style.backgroundColor,f=d.style.height,g=d.style.textAlign,
h=d.style.verticalAlign;l&&(document.getElementById("background_color").style.backgroundColor=e);f=LayerWin.parseIntOr0(f);k&&0<f&&(document.getElementById("row_height").value=f);m&&""!=g&&(document.getElementById("horizontal_align").value=g);p&&""!=h&&(document.getElementById("vertical_align").value=h);if(DEXTTOP.DEXT5.browser.ie&&9>=DEXTTOP.DEXT5.browser.ieVersion)a=document.getElementsByClassName("contents")[0],b=document.getElementById("div_thead"),a.removeChild(b);else{(d="THEAD"==b.parentNode.tagName?
!0:!1)?document.getElementById("row_thead").checked=!0:document.getElementById("row_thead").checked=!1;e=!1;f=[];for(g=0;g<c.rows.length;g++)for(h=c.rows[g],l=0;l<h.cells.length;l++)k=h.cells[l],1<k.rowSpan&&f.push({tr:h,td:k});for(g=0;g<f.length;g++)if(c=f[g],1==a.rowSpan)if(d){if(b.rowIndex>c.tr.rowIndex&&b.rowIndex<=c.tr.rowIndex+c.td.rowSpan-1){e=!0;break}}else{if(c.tr.rowIndex+c.td.rowSpan-1>b.rowIndex&&c.tr.rowIndex<=b.rowIndex){e=!0;break}}else if(d){if(b.rowIndex>c.tr.rowIndex&&b.rowIndex<=
c.tr.rowIndex+c.td.rowSpan-1){e=!0;break}}else if(b.rowIndex+a.rowSpan<c.tr.rowIndex+c.td.rowSpan&&b.rowIndex+a.rowSpan-1>=c.tr.rowIndex){e=!0;break}e&&(document.getElementById("row_thead").disabled=!0)}}}};
